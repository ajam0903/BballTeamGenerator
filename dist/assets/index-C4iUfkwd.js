(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function Zw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Y0={exports:{}},eu={},X0={exports:{}},ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wa=Symbol.for("react.element"),eE=Symbol.for("react.portal"),tE=Symbol.for("react.fragment"),nE=Symbol.for("react.strict_mode"),rE=Symbol.for("react.profiler"),sE=Symbol.for("react.provider"),iE=Symbol.for("react.context"),oE=Symbol.for("react.forward_ref"),aE=Symbol.for("react.suspense"),lE=Symbol.for("react.memo"),cE=Symbol.for("react.lazy"),up=Symbol.iterator;function uE(t){return t===null||typeof t!="object"?null:(t=up&&t[up]||t["@@iterator"],typeof t=="function"?t:null)}var J0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Z0=Object.assign,ey={};function _o(t,e,n){this.props=t,this.context=e,this.refs=ey,this.updater=n||J0}_o.prototype.isReactComponent={};_o.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};_o.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ty(){}ty.prototype=_o.prototype;function qh(t,e,n){this.props=t,this.context=e,this.refs=ey,this.updater=n||J0}var Gh=qh.prototype=new ty;Gh.constructor=qh;Z0(Gh,_o.prototype);Gh.isPureReactComponent=!0;var dp=Array.isArray,ny=Object.prototype.hasOwnProperty,Kh={current:null},ry={key:!0,ref:!0,__self:!0,__source:!0};function sy(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)ny.call(e,r)&&!ry.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Wa,type:t,key:i,ref:o,props:s,_owner:Kh.current}}function dE(t,e){return{$$typeof:Wa,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Qh(t){return typeof t=="object"&&t!==null&&t.$$typeof===Wa}function hE(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var hp=/\/+/g;function $u(t,e){return typeof t=="object"&&t!==null&&t.key!=null?hE(""+t.key):e.toString(36)}function Ul(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Wa:case eE:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+$u(o,0):r,dp(s)?(n="",t!=null&&(n=t.replace(hp,"$&/")+"/"),Ul(s,e,n,"",function(d){return d})):s!=null&&(Qh(s)&&(s=dE(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(hp,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",dp(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+$u(i,l);o+=Ul(i,e,n,u,s)}else if(u=uE(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+$u(i,l++),o+=Ul(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function gl(t,e,n){if(t==null)return t;var r=[],s=0;return Ul(t,r,"","",function(i){return e.call(n,i,s++)}),r}function fE(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var hn={current:null},Bl={transition:null},mE={ReactCurrentDispatcher:hn,ReactCurrentBatchConfig:Bl,ReactCurrentOwner:Kh};function iy(){throw Error("act(...) is not supported in production builds of React.")}ze.Children={map:gl,forEach:function(t,e,n){gl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return gl(t,function(){e++}),e},toArray:function(t){return gl(t,function(e){return e})||[]},only:function(t){if(!Qh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ze.Component=_o;ze.Fragment=tE;ze.Profiler=rE;ze.PureComponent=qh;ze.StrictMode=nE;ze.Suspense=aE;ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mE;ze.act=iy;ze.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Z0({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Kh.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)ny.call(e,u)&&!ry.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Wa,type:t.type,key:s,ref:i,props:r,_owner:o}};ze.createContext=function(t){return t={$$typeof:iE,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:sE,_context:t},t.Consumer=t};ze.createElement=sy;ze.createFactory=function(t){var e=sy.bind(null,t);return e.type=t,e};ze.createRef=function(){return{current:null}};ze.forwardRef=function(t){return{$$typeof:oE,render:t}};ze.isValidElement=Qh;ze.lazy=function(t){return{$$typeof:cE,_payload:{_status:-1,_result:t},_init:fE}};ze.memo=function(t,e){return{$$typeof:lE,type:t,compare:e===void 0?null:e}};ze.startTransition=function(t){var e=Bl.transition;Bl.transition={};try{t()}finally{Bl.transition=e}};ze.unstable_act=iy;ze.useCallback=function(t,e){return hn.current.useCallback(t,e)};ze.useContext=function(t){return hn.current.useContext(t)};ze.useDebugValue=function(){};ze.useDeferredValue=function(t){return hn.current.useDeferredValue(t)};ze.useEffect=function(t,e){return hn.current.useEffect(t,e)};ze.useId=function(){return hn.current.useId()};ze.useImperativeHandle=function(t,e,n){return hn.current.useImperativeHandle(t,e,n)};ze.useInsertionEffect=function(t,e){return hn.current.useInsertionEffect(t,e)};ze.useLayoutEffect=function(t,e){return hn.current.useLayoutEffect(t,e)};ze.useMemo=function(t,e){return hn.current.useMemo(t,e)};ze.useReducer=function(t,e,n){return hn.current.useReducer(t,e,n)};ze.useRef=function(t){return hn.current.useRef(t)};ze.useState=function(t){return hn.current.useState(t)};ze.useSyncExternalStore=function(t,e,n){return hn.current.useSyncExternalStore(t,e,n)};ze.useTransition=function(){return hn.current.useTransition()};ze.version="18.3.1";X0.exports=ze;var U=X0.exports;const to=Zw(U);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pE=U,gE=Symbol.for("react.element"),yE=Symbol.for("react.fragment"),vE=Object.prototype.hasOwnProperty,_E=pE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xE={key:!0,ref:!0,__self:!0,__source:!0};function oy(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)vE.call(e,r)&&!xE.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:gE,type:t,key:i,ref:o,props:s,_owner:_E.current}}eu.Fragment=yE;eu.jsx=oy;eu.jsxs=oy;Y0.exports=eu;var c=Y0.exports,Nd={},ay={exports:{}},Pn={},ly={exports:{}},cy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,ne){var $=W.length;W.push(ne);e:for(;0<$;){var Y=$-1>>>1,J=W[Y];if(0<s(J,ne))W[Y]=ne,W[$]=J,$=Y;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var ne=W[0],$=W.pop();if($!==ne){W[0]=$;e:for(var Y=0,J=W.length,oe=J>>>1;Y<oe;){var K=2*(Y+1)-1,Ue=W[K],D=K+1,de=W[D];if(0>s(Ue,$))D<J&&0>s(de,Ue)?(W[Y]=de,W[D]=$,Y=D):(W[Y]=Ue,W[K]=$,Y=K);else if(D<J&&0>s(de,$))W[Y]=de,W[D]=$,Y=D;else break e}}return ne}function s(W,ne){var $=W.sortIndex-ne.sortIndex;return $!==0?$:W.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],d=[],m=1,g=null,y=3,N=!1,R=!1,j=!1,k=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(W){for(var ne=n(d);ne!==null;){if(ne.callback===null)r(d);else if(ne.startTime<=W)r(d),ne.sortIndex=ne.expirationTime,e(u,ne);else break;ne=n(d)}}function P(W){if(j=!1,b(W),!R)if(n(u)!==null)R=!0,q(L);else{var ne=n(d);ne!==null&&X(P,ne.startTime-W)}}function L(W,ne){R=!1,j&&(j=!1,E(p),p=-1),N=!0;var $=y;try{for(b(ne),g=n(u);g!==null&&(!(g.expirationTime>ne)||W&&!S());){var Y=g.callback;if(typeof Y=="function"){g.callback=null,y=g.priorityLevel;var J=Y(g.expirationTime<=ne);ne=t.unstable_now(),typeof J=="function"?g.callback=J:g===n(u)&&r(u),b(ne)}else r(u);g=n(u)}if(g!==null)var oe=!0;else{var K=n(d);K!==null&&X(P,K.startTime-ne),oe=!1}return oe}finally{g=null,y=$,N=!1}}var V=!1,T=null,p=-1,w=5,_=-1;function S(){return!(t.unstable_now()-_<w)}function C(){if(T!==null){var W=t.unstable_now();_=W;var ne=!0;try{ne=T(!0,W)}finally{ne?I():(V=!1,T=null)}}else V=!1}var I;if(typeof v=="function")I=function(){v(C)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,Be=ce.port2;ce.port1.onmessage=C,I=function(){Be.postMessage(null)}}else I=function(){k(C,0)};function q(W){T=W,V||(V=!0,I())}function X(W,ne){p=k(function(){W(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){R||N||(R=!0,q(L))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(W){switch(y){case 1:case 2:case 3:var ne=3;break;default:ne=y}var $=y;y=ne;try{return W()}finally{y=$}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,ne){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var $=y;y=W;try{return ne()}finally{y=$}},t.unstable_scheduleCallback=function(W,ne,$){var Y=t.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?Y+$:Y):$=Y,W){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=$+J,W={id:m++,callback:ne,priorityLevel:W,startTime:$,expirationTime:J,sortIndex:-1},$>Y?(W.sortIndex=$,e(d,W),n(u)===null&&W===n(d)&&(j?(E(p),p=-1):j=!0,X(P,$-Y))):(W.sortIndex=J,e(u,W),R||N||(R=!0,q(L))),W},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(W){var ne=y;return function(){var $=y;y=ne;try{return W.apply(this,arguments)}finally{y=$}}}})(cy);ly.exports=cy;var wE=ly.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EE=U,kn=wE;function re(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var uy=new Set,ya={};function fi(t,e){no(t,e),no(t+"Capture",e)}function no(t,e){for(ya[t]=e,t=0;t<e.length;t++)uy.add(e[t])}var Or=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cd=Object.prototype.hasOwnProperty,TE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fp={},mp={};function IE(t){return Cd.call(mp,t)?!0:Cd.call(fp,t)?!1:TE.test(t)?mp[t]=!0:(fp[t]=!0,!1)}function bE(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function SE(t,e,n,r){if(e===null||typeof e>"u"||bE(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function fn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Kt[t]=new fn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Kt[e]=new fn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Kt[t]=new fn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Kt[t]=new fn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Kt[t]=new fn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Kt[t]=new fn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Kt[t]=new fn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Kt[t]=new fn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Kt[t]=new fn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Yh=/[\-:]([a-z])/g;function Xh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Yh,Xh);Kt[e]=new fn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Yh,Xh);Kt[e]=new fn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Yh,Xh);Kt[e]=new fn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Kt[t]=new fn(t,1,!1,t.toLowerCase(),null,!1,!1)});Kt.xlinkHref=new fn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Kt[t]=new fn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Jh(t,e,n,r){var s=Kt.hasOwnProperty(e)?Kt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(SE(e,n,s,r)&&(n=null),r||s===null?IE(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var qr=EE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yl=Symbol.for("react.element"),Ri=Symbol.for("react.portal"),ji=Symbol.for("react.fragment"),Zh=Symbol.for("react.strict_mode"),Ad=Symbol.for("react.profiler"),dy=Symbol.for("react.provider"),hy=Symbol.for("react.context"),ef=Symbol.for("react.forward_ref"),kd=Symbol.for("react.suspense"),Pd=Symbol.for("react.suspense_list"),tf=Symbol.for("react.memo"),ss=Symbol.for("react.lazy"),fy=Symbol.for("react.offscreen"),pp=Symbol.iterator;function Fo(t){return t===null||typeof t!="object"?null:(t=pp&&t[pp]||t["@@iterator"],typeof t=="function"?t:null)}var Tt=Object.assign,zu;function Go(t){if(zu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);zu=e&&e[1]||""}return`
`+zu+t}var Wu=!1;function Hu(t,e){if(!t||Wu)return"";Wu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{Wu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Go(t):""}function NE(t){switch(t.tag){case 5:return Go(t.type);case 16:return Go("Lazy");case 13:return Go("Suspense");case 19:return Go("SuspenseList");case 0:case 2:case 15:return t=Hu(t.type,!1),t;case 11:return t=Hu(t.type.render,!1),t;case 1:return t=Hu(t.type,!0),t;default:return""}}function Rd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ji:return"Fragment";case Ri:return"Portal";case Ad:return"Profiler";case Zh:return"StrictMode";case kd:return"Suspense";case Pd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case hy:return(t.displayName||"Context")+".Consumer";case dy:return(t._context.displayName||"Context")+".Provider";case ef:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case tf:return e=t.displayName||null,e!==null?e:Rd(t.type)||"Memo";case ss:e=t._payload,t=t._init;try{return Rd(t(e))}catch{}}return null}function CE(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Rd(e);case 8:return e===Zh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ns(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function my(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function AE(t){var e=my(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function vl(t){t._valueTracker||(t._valueTracker=AE(t))}function py(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=my(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function uc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function jd(t,e){var n=e.checked;return Tt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function gp(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ns(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function gy(t,e){e=e.checked,e!=null&&Jh(t,"checked",e,!1)}function Dd(t,e){gy(t,e);var n=Ns(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vd(t,e.type,n):e.hasOwnProperty("defaultValue")&&Vd(t,e.type,Ns(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function yp(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Vd(t,e,n){(e!=="number"||uc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ko=Array.isArray;function Wi(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ns(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Md(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(re(91));return Tt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function vp(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(re(92));if(Ko(n)){if(1<n.length)throw Error(re(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ns(n)}}function yy(t,e){var n=Ns(e.value),r=Ns(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function _p(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function vy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ld(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?vy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var _l,_y=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(_l=_l||document.createElement("div"),_l.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_l.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function va(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ta={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kE=["Webkit","ms","Moz","O"];Object.keys(ta).forEach(function(t){kE.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ta[e]=ta[t]})});function xy(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ta.hasOwnProperty(t)&&ta[t]?(""+e).trim():e+"px"}function wy(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=xy(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var PE=Tt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Od(t,e){if(e){if(PE[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(re(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(re(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(re(61))}if(e.style!=null&&typeof e.style!="object")throw Error(re(62))}}function Fd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ud=null;function nf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Bd=null,Hi=null,qi=null;function xp(t){if(t=Ga(t)){if(typeof Bd!="function")throw Error(re(280));var e=t.stateNode;e&&(e=iu(e),Bd(t.stateNode,t.type,e))}}function Ey(t){Hi?qi?qi.push(t):qi=[t]:Hi=t}function Ty(){if(Hi){var t=Hi,e=qi;if(qi=Hi=null,xp(t),e)for(t=0;t<e.length;t++)xp(e[t])}}function Iy(t,e){return t(e)}function by(){}var qu=!1;function Sy(t,e,n){if(qu)return t(e,n);qu=!0;try{return Iy(t,e,n)}finally{qu=!1,(Hi!==null||qi!==null)&&(by(),Ty())}}function _a(t,e){var n=t.stateNode;if(n===null)return null;var r=iu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(re(231,e,typeof n));return n}var $d=!1;if(Or)try{var Uo={};Object.defineProperty(Uo,"passive",{get:function(){$d=!0}}),window.addEventListener("test",Uo,Uo),window.removeEventListener("test",Uo,Uo)}catch{$d=!1}function RE(t,e,n,r,s,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(m){this.onError(m)}}var na=!1,dc=null,hc=!1,zd=null,jE={onError:function(t){na=!0,dc=t}};function DE(t,e,n,r,s,i,o,l,u){na=!1,dc=null,RE.apply(jE,arguments)}function VE(t,e,n,r,s,i,o,l,u){if(DE.apply(this,arguments),na){if(na){var d=dc;na=!1,dc=null}else throw Error(re(198));hc||(hc=!0,zd=d)}}function mi(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ny(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function wp(t){if(mi(t)!==t)throw Error(re(188))}function ME(t){var e=t.alternate;if(!e){if(e=mi(t),e===null)throw Error(re(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return wp(s),t;if(i===r)return wp(s),e;i=i.sibling}throw Error(re(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(re(189))}}if(n.alternate!==r)throw Error(re(190))}if(n.tag!==3)throw Error(re(188));return n.stateNode.current===n?t:e}function Cy(t){return t=ME(t),t!==null?Ay(t):null}function Ay(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Ay(t);if(e!==null)return e;t=t.sibling}return null}var ky=kn.unstable_scheduleCallback,Ep=kn.unstable_cancelCallback,LE=kn.unstable_shouldYield,OE=kn.unstable_requestPaint,kt=kn.unstable_now,FE=kn.unstable_getCurrentPriorityLevel,rf=kn.unstable_ImmediatePriority,Py=kn.unstable_UserBlockingPriority,fc=kn.unstable_NormalPriority,UE=kn.unstable_LowPriority,Ry=kn.unstable_IdlePriority,tu=null,mr=null;function BE(t){if(mr&&typeof mr.onCommitFiberRoot=="function")try{mr.onCommitFiberRoot(tu,t,void 0,(t.current.flags&128)===128)}catch{}}var nr=Math.clz32?Math.clz32:WE,$E=Math.log,zE=Math.LN2;function WE(t){return t>>>=0,t===0?32:31-($E(t)/zE|0)|0}var xl=64,wl=4194304;function Qo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function mc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Qo(l):(i&=o,i!==0&&(r=Qo(i)))}else o=n&~s,o!==0?r=Qo(o):i!==0&&(r=Qo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-nr(e),s=1<<n,r|=t[n],e&=~s;return r}function HE(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qE(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-nr(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=HE(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Wd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function jy(){var t=xl;return xl<<=1,!(xl&4194240)&&(xl=64),t}function Gu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ha(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-nr(e),t[e]=n}function GE(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-nr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function sf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-nr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ot=0;function Dy(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Vy,of,My,Ly,Oy,Hd=!1,El=[],ms=null,ps=null,gs=null,xa=new Map,wa=new Map,os=[],KE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tp(t,e){switch(t){case"focusin":case"focusout":ms=null;break;case"dragenter":case"dragleave":ps=null;break;case"mouseover":case"mouseout":gs=null;break;case"pointerover":case"pointerout":xa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":wa.delete(e.pointerId)}}function Bo(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Ga(e),e!==null&&of(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function QE(t,e,n,r,s){switch(e){case"focusin":return ms=Bo(ms,t,e,n,r,s),!0;case"dragenter":return ps=Bo(ps,t,e,n,r,s),!0;case"mouseover":return gs=Bo(gs,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return xa.set(i,Bo(xa.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,wa.set(i,Bo(wa.get(i)||null,t,e,n,r,s)),!0}return!1}function Fy(t){var e=Ks(t.target);if(e!==null){var n=mi(e);if(n!==null){if(e=n.tag,e===13){if(e=Ny(n),e!==null){t.blockedOn=e,Oy(t.priority,function(){My(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function $l(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=qd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ud=r,n.target.dispatchEvent(r),Ud=null}else return e=Ga(n),e!==null&&of(e),t.blockedOn=n,!1;e.shift()}return!0}function Ip(t,e,n){$l(t)&&n.delete(e)}function YE(){Hd=!1,ms!==null&&$l(ms)&&(ms=null),ps!==null&&$l(ps)&&(ps=null),gs!==null&&$l(gs)&&(gs=null),xa.forEach(Ip),wa.forEach(Ip)}function $o(t,e){t.blockedOn===e&&(t.blockedOn=null,Hd||(Hd=!0,kn.unstable_scheduleCallback(kn.unstable_NormalPriority,YE)))}function Ea(t){function e(s){return $o(s,t)}if(0<El.length){$o(El[0],t);for(var n=1;n<El.length;n++){var r=El[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ms!==null&&$o(ms,t),ps!==null&&$o(ps,t),gs!==null&&$o(gs,t),xa.forEach(e),wa.forEach(e),n=0;n<os.length;n++)r=os[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<os.length&&(n=os[0],n.blockedOn===null);)Fy(n),n.blockedOn===null&&os.shift()}var Gi=qr.ReactCurrentBatchConfig,pc=!0;function XE(t,e,n,r){var s=ot,i=Gi.transition;Gi.transition=null;try{ot=1,af(t,e,n,r)}finally{ot=s,Gi.transition=i}}function JE(t,e,n,r){var s=ot,i=Gi.transition;Gi.transition=null;try{ot=4,af(t,e,n,r)}finally{ot=s,Gi.transition=i}}function af(t,e,n,r){if(pc){var s=qd(t,e,n,r);if(s===null)rd(t,e,r,gc,n),Tp(t,r);else if(QE(s,t,e,n,r))r.stopPropagation();else if(Tp(t,r),e&4&&-1<KE.indexOf(t)){for(;s!==null;){var i=Ga(s);if(i!==null&&Vy(i),i=qd(t,e,n,r),i===null&&rd(t,e,r,gc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else rd(t,e,r,null,n)}}var gc=null;function qd(t,e,n,r){if(gc=null,t=nf(r),t=Ks(t),t!==null)if(e=mi(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ny(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return gc=t,null}function Uy(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(FE()){case rf:return 1;case Py:return 4;case fc:case UE:return 16;case Ry:return 536870912;default:return 16}default:return 16}}var ds=null,lf=null,zl=null;function By(){if(zl)return zl;var t,e=lf,n=e.length,r,s="value"in ds?ds.value:ds.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return zl=s.slice(t,1<r?1-r:void 0)}function Wl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Tl(){return!0}function bp(){return!1}function Rn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Tl:bp,this.isPropagationStopped=bp,this}return Tt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Tl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Tl)},persist:function(){},isPersistent:Tl}),e}var xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cf=Rn(xo),qa=Tt({},xo,{view:0,detail:0}),ZE=Rn(qa),Ku,Qu,zo,nu=Tt({},qa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==zo&&(zo&&t.type==="mousemove"?(Ku=t.screenX-zo.screenX,Qu=t.screenY-zo.screenY):Qu=Ku=0,zo=t),Ku)},movementY:function(t){return"movementY"in t?t.movementY:Qu}}),Sp=Rn(nu),eT=Tt({},nu,{dataTransfer:0}),tT=Rn(eT),nT=Tt({},qa,{relatedTarget:0}),Yu=Rn(nT),rT=Tt({},xo,{animationName:0,elapsedTime:0,pseudoElement:0}),sT=Rn(rT),iT=Tt({},xo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),oT=Rn(iT),aT=Tt({},xo,{data:0}),Np=Rn(aT),lT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dT(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=uT[t])?!!e[t]:!1}function uf(){return dT}var hT=Tt({},qa,{key:function(t){if(t.key){var e=lT[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Wl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?cT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uf,charCode:function(t){return t.type==="keypress"?Wl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Wl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),fT=Rn(hT),mT=Tt({},nu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cp=Rn(mT),pT=Tt({},qa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uf}),gT=Rn(pT),yT=Tt({},xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),vT=Rn(yT),_T=Tt({},nu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),xT=Rn(_T),wT=[9,13,27,32],df=Or&&"CompositionEvent"in window,ra=null;Or&&"documentMode"in document&&(ra=document.documentMode);var ET=Or&&"TextEvent"in window&&!ra,$y=Or&&(!df||ra&&8<ra&&11>=ra),Ap=" ",kp=!1;function zy(t,e){switch(t){case"keyup":return wT.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wy(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Di=!1;function TT(t,e){switch(t){case"compositionend":return Wy(e);case"keypress":return e.which!==32?null:(kp=!0,Ap);case"textInput":return t=e.data,t===Ap&&kp?null:t;default:return null}}function IT(t,e){if(Di)return t==="compositionend"||!df&&zy(t,e)?(t=By(),zl=lf=ds=null,Di=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $y&&e.locale!=="ko"?null:e.data;default:return null}}var bT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!bT[t.type]:e==="textarea"}function Hy(t,e,n,r){Ey(r),e=yc(e,"onChange"),0<e.length&&(n=new cf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var sa=null,Ta=null;function ST(t){nv(t,0)}function ru(t){var e=Li(t);if(py(e))return t}function NT(t,e){if(t==="change")return e}var qy=!1;if(Or){var Xu;if(Or){var Ju="oninput"in document;if(!Ju){var Rp=document.createElement("div");Rp.setAttribute("oninput","return;"),Ju=typeof Rp.oninput=="function"}Xu=Ju}else Xu=!1;qy=Xu&&(!document.documentMode||9<document.documentMode)}function jp(){sa&&(sa.detachEvent("onpropertychange",Gy),Ta=sa=null)}function Gy(t){if(t.propertyName==="value"&&ru(Ta)){var e=[];Hy(e,Ta,t,nf(t)),Sy(ST,e)}}function CT(t,e,n){t==="focusin"?(jp(),sa=e,Ta=n,sa.attachEvent("onpropertychange",Gy)):t==="focusout"&&jp()}function AT(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ru(Ta)}function kT(t,e){if(t==="click")return ru(e)}function PT(t,e){if(t==="input"||t==="change")return ru(e)}function RT(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ir=typeof Object.is=="function"?Object.is:RT;function Ia(t,e){if(ir(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Cd.call(e,s)||!ir(t[s],e[s]))return!1}return!0}function Dp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Vp(t,e){var n=Dp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Dp(n)}}function Ky(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Ky(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Qy(){for(var t=window,e=uc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=uc(t.document)}return e}function hf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function jT(t){var e=Qy(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Ky(n.ownerDocument.documentElement,n)){if(r!==null&&hf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Vp(n,i);var o=Vp(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var DT=Or&&"documentMode"in document&&11>=document.documentMode,Vi=null,Gd=null,ia=null,Kd=!1;function Mp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Kd||Vi==null||Vi!==uc(r)||(r=Vi,"selectionStart"in r&&hf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ia&&Ia(ia,r)||(ia=r,r=yc(Gd,"onSelect"),0<r.length&&(e=new cf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Vi)))}function Il(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Mi={animationend:Il("Animation","AnimationEnd"),animationiteration:Il("Animation","AnimationIteration"),animationstart:Il("Animation","AnimationStart"),transitionend:Il("Transition","TransitionEnd")},Zu={},Yy={};Or&&(Yy=document.createElement("div").style,"AnimationEvent"in window||(delete Mi.animationend.animation,delete Mi.animationiteration.animation,delete Mi.animationstart.animation),"TransitionEvent"in window||delete Mi.transitionend.transition);function su(t){if(Zu[t])return Zu[t];if(!Mi[t])return t;var e=Mi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Yy)return Zu[t]=e[n];return t}var Xy=su("animationend"),Jy=su("animationiteration"),Zy=su("animationstart"),ev=su("transitionend"),tv=new Map,Lp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ms(t,e){tv.set(t,e),fi(e,[t])}for(var ed=0;ed<Lp.length;ed++){var td=Lp[ed],VT=td.toLowerCase(),MT=td[0].toUpperCase()+td.slice(1);Ms(VT,"on"+MT)}Ms(Xy,"onAnimationEnd");Ms(Jy,"onAnimationIteration");Ms(Zy,"onAnimationStart");Ms("dblclick","onDoubleClick");Ms("focusin","onFocus");Ms("focusout","onBlur");Ms(ev,"onTransitionEnd");no("onMouseEnter",["mouseout","mouseover"]);no("onMouseLeave",["mouseout","mouseover"]);no("onPointerEnter",["pointerout","pointerover"]);no("onPointerLeave",["pointerout","pointerover"]);fi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fi("onBeforeInput",["compositionend","keypress","textInput","paste"]);fi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yo));function Op(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,VE(r,e,void 0,t),t.currentTarget=null}function nv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;Op(s,l,d),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;Op(s,l,d),i=u}}}if(hc)throw t=zd,hc=!1,zd=null,t}function mt(t,e){var n=e[Zd];n===void 0&&(n=e[Zd]=new Set);var r=t+"__bubble";n.has(r)||(rv(e,t,2,!1),n.add(r))}function nd(t,e,n){var r=0;e&&(r|=4),rv(n,t,r,e)}var bl="_reactListening"+Math.random().toString(36).slice(2);function ba(t){if(!t[bl]){t[bl]=!0,uy.forEach(function(n){n!=="selectionchange"&&(LT.has(n)||nd(n,!1,t),nd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[bl]||(e[bl]=!0,nd("selectionchange",!1,e))}}function rv(t,e,n,r){switch(Uy(e)){case 1:var s=XE;break;case 4:s=JE;break;default:s=af}n=s.bind(null,e,n,t),s=void 0,!$d||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function rd(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Ks(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Sy(function(){var d=i,m=nf(n),g=[];e:{var y=tv.get(t);if(y!==void 0){var N=cf,R=t;switch(t){case"keypress":if(Wl(n)===0)break e;case"keydown":case"keyup":N=fT;break;case"focusin":R="focus",N=Yu;break;case"focusout":R="blur",N=Yu;break;case"beforeblur":case"afterblur":N=Yu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=Sp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=tT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=gT;break;case Xy:case Jy:case Zy:N=sT;break;case ev:N=vT;break;case"scroll":N=ZE;break;case"wheel":N=xT;break;case"copy":case"cut":case"paste":N=oT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=Cp}var j=(e&4)!==0,k=!j&&t==="scroll",E=j?y!==null?y+"Capture":null:y;j=[];for(var v=d,b;v!==null;){b=v;var P=b.stateNode;if(b.tag===5&&P!==null&&(b=P,E!==null&&(P=_a(v,E),P!=null&&j.push(Sa(v,P,b)))),k)break;v=v.return}0<j.length&&(y=new N(y,R,null,n,m),g.push({event:y,listeners:j}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",N=t==="mouseout"||t==="pointerout",y&&n!==Ud&&(R=n.relatedTarget||n.fromElement)&&(Ks(R)||R[Fr]))break e;if((N||y)&&(y=m.window===m?m:(y=m.ownerDocument)?y.defaultView||y.parentWindow:window,N?(R=n.relatedTarget||n.toElement,N=d,R=R?Ks(R):null,R!==null&&(k=mi(R),R!==k||R.tag!==5&&R.tag!==6)&&(R=null)):(N=null,R=d),N!==R)){if(j=Sp,P="onMouseLeave",E="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(j=Cp,P="onPointerLeave",E="onPointerEnter",v="pointer"),k=N==null?y:Li(N),b=R==null?y:Li(R),y=new j(P,v+"leave",N,n,m),y.target=k,y.relatedTarget=b,P=null,Ks(m)===d&&(j=new j(E,v+"enter",R,n,m),j.target=b,j.relatedTarget=k,P=j),k=P,N&&R)t:{for(j=N,E=R,v=0,b=j;b;b=Ni(b))v++;for(b=0,P=E;P;P=Ni(P))b++;for(;0<v-b;)j=Ni(j),v--;for(;0<b-v;)E=Ni(E),b--;for(;v--;){if(j===E||E!==null&&j===E.alternate)break t;j=Ni(j),E=Ni(E)}j=null}else j=null;N!==null&&Fp(g,y,N,j,!1),R!==null&&k!==null&&Fp(g,k,R,j,!0)}}e:{if(y=d?Li(d):window,N=y.nodeName&&y.nodeName.toLowerCase(),N==="select"||N==="input"&&y.type==="file")var L=NT;else if(Pp(y))if(qy)L=PT;else{L=AT;var V=CT}else(N=y.nodeName)&&N.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(L=kT);if(L&&(L=L(t,d))){Hy(g,L,n,m);break e}V&&V(t,y,d),t==="focusout"&&(V=y._wrapperState)&&V.controlled&&y.type==="number"&&Vd(y,"number",y.value)}switch(V=d?Li(d):window,t){case"focusin":(Pp(V)||V.contentEditable==="true")&&(Vi=V,Gd=d,ia=null);break;case"focusout":ia=Gd=Vi=null;break;case"mousedown":Kd=!0;break;case"contextmenu":case"mouseup":case"dragend":Kd=!1,Mp(g,n,m);break;case"selectionchange":if(DT)break;case"keydown":case"keyup":Mp(g,n,m)}var T;if(df)e:{switch(t){case"compositionstart":var p="onCompositionStart";break e;case"compositionend":p="onCompositionEnd";break e;case"compositionupdate":p="onCompositionUpdate";break e}p=void 0}else Di?zy(t,n)&&(p="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(p="onCompositionStart");p&&($y&&n.locale!=="ko"&&(Di||p!=="onCompositionStart"?p==="onCompositionEnd"&&Di&&(T=By()):(ds=m,lf="value"in ds?ds.value:ds.textContent,Di=!0)),V=yc(d,p),0<V.length&&(p=new Np(p,t,null,n,m),g.push({event:p,listeners:V}),T?p.data=T:(T=Wy(n),T!==null&&(p.data=T)))),(T=ET?TT(t,n):IT(t,n))&&(d=yc(d,"onBeforeInput"),0<d.length&&(m=new Np("onBeforeInput","beforeinput",null,n,m),g.push({event:m,listeners:d}),m.data=T))}nv(g,e)})}function Sa(t,e,n){return{instance:t,listener:e,currentTarget:n}}function yc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=_a(t,n),i!=null&&r.unshift(Sa(t,i,s)),i=_a(t,e),i!=null&&r.push(Sa(t,i,s))),t=t.return}return r}function Ni(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Fp(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,s?(u=_a(n,i),u!=null&&o.unshift(Sa(n,u,l))):s||(u=_a(n,i),u!=null&&o.push(Sa(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var OT=/\r\n?/g,FT=/\u0000|\uFFFD/g;function Up(t){return(typeof t=="string"?t:""+t).replace(OT,`
`).replace(FT,"")}function Sl(t,e,n){if(e=Up(e),Up(t)!==e&&n)throw Error(re(425))}function vc(){}var Qd=null,Yd=null;function Xd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Jd=typeof setTimeout=="function"?setTimeout:void 0,UT=typeof clearTimeout=="function"?clearTimeout:void 0,Bp=typeof Promise=="function"?Promise:void 0,BT=typeof queueMicrotask=="function"?queueMicrotask:typeof Bp<"u"?function(t){return Bp.resolve(null).then(t).catch($T)}:Jd;function $T(t){setTimeout(function(){throw t})}function sd(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ea(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ea(e)}function ys(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function $p(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var wo=Math.random().toString(36).slice(2),fr="__reactFiber$"+wo,Na="__reactProps$"+wo,Fr="__reactContainer$"+wo,Zd="__reactEvents$"+wo,zT="__reactListeners$"+wo,WT="__reactHandles$"+wo;function Ks(t){var e=t[fr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Fr]||n[fr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=$p(t);t!==null;){if(n=t[fr])return n;t=$p(t)}return e}t=n,n=t.parentNode}return null}function Ga(t){return t=t[fr]||t[Fr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Li(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(re(33))}function iu(t){return t[Na]||null}var eh=[],Oi=-1;function Ls(t){return{current:t}}function gt(t){0>Oi||(t.current=eh[Oi],eh[Oi]=null,Oi--)}function ht(t,e){Oi++,eh[Oi]=t.current,t.current=e}var Cs={},sn=Ls(Cs),_n=Ls(!1),ni=Cs;function ro(t,e){var n=t.type.contextTypes;if(!n)return Cs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function xn(t){return t=t.childContextTypes,t!=null}function _c(){gt(_n),gt(sn)}function zp(t,e,n){if(sn.current!==Cs)throw Error(re(168));ht(sn,e),ht(_n,n)}function sv(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(re(108,CE(t)||"Unknown",s));return Tt({},n,r)}function xc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Cs,ni=sn.current,ht(sn,t),ht(_n,_n.current),!0}function Wp(t,e,n){var r=t.stateNode;if(!r)throw Error(re(169));n?(t=sv(t,e,ni),r.__reactInternalMemoizedMergedChildContext=t,gt(_n),gt(sn),ht(sn,t)):gt(_n),ht(_n,n)}var Ar=null,ou=!1,id=!1;function iv(t){Ar===null?Ar=[t]:Ar.push(t)}function HT(t){ou=!0,iv(t)}function Os(){if(!id&&Ar!==null){id=!0;var t=0,e=ot;try{var n=Ar;for(ot=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ar=null,ou=!1}catch(s){throw Ar!==null&&(Ar=Ar.slice(t+1)),ky(rf,Os),s}finally{ot=e,id=!1}}return null}var Fi=[],Ui=0,wc=null,Ec=0,On=[],Fn=0,ri=null,Pr=1,Rr="";function Hs(t,e){Fi[Ui++]=Ec,Fi[Ui++]=wc,wc=t,Ec=e}function ov(t,e,n){On[Fn++]=Pr,On[Fn++]=Rr,On[Fn++]=ri,ri=t;var r=Pr;t=Rr;var s=32-nr(r)-1;r&=~(1<<s),n+=1;var i=32-nr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Pr=1<<32-nr(e)+s|n<<s|r,Rr=i+t}else Pr=1<<i|n<<s|r,Rr=t}function ff(t){t.return!==null&&(Hs(t,1),ov(t,1,0))}function mf(t){for(;t===wc;)wc=Fi[--Ui],Fi[Ui]=null,Ec=Fi[--Ui],Fi[Ui]=null;for(;t===ri;)ri=On[--Fn],On[Fn]=null,Rr=On[--Fn],On[Fn]=null,Pr=On[--Fn],On[Fn]=null}var An=null,Cn=null,vt=!1,Jn=null;function av(t,e){var n=Bn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Hp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,An=t,Cn=ys(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,An=t,Cn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ri!==null?{id:Pr,overflow:Rr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Bn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,An=t,Cn=null,!0):!1;default:return!1}}function th(t){return(t.mode&1)!==0&&(t.flags&128)===0}function nh(t){if(vt){var e=Cn;if(e){var n=e;if(!Hp(t,e)){if(th(t))throw Error(re(418));e=ys(n.nextSibling);var r=An;e&&Hp(t,e)?av(r,n):(t.flags=t.flags&-4097|2,vt=!1,An=t)}}else{if(th(t))throw Error(re(418));t.flags=t.flags&-4097|2,vt=!1,An=t}}}function qp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;An=t}function Nl(t){if(t!==An)return!1;if(!vt)return qp(t),vt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Xd(t.type,t.memoizedProps)),e&&(e=Cn)){if(th(t))throw lv(),Error(re(418));for(;e;)av(t,e),e=ys(e.nextSibling)}if(qp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(re(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Cn=ys(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Cn=null}}else Cn=An?ys(t.stateNode.nextSibling):null;return!0}function lv(){for(var t=Cn;t;)t=ys(t.nextSibling)}function so(){Cn=An=null,vt=!1}function pf(t){Jn===null?Jn=[t]:Jn.push(t)}var qT=qr.ReactCurrentBatchConfig;function Wo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(re(309));var r=n.stateNode}if(!r)throw Error(re(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(re(284));if(!n._owner)throw Error(re(290,t))}return t}function Cl(t,e){throw t=Object.prototype.toString.call(e),Error(re(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Gp(t){var e=t._init;return e(t._payload)}function cv(t){function e(E,v){if(t){var b=E.deletions;b===null?(E.deletions=[v],E.flags|=16):b.push(v)}}function n(E,v){if(!t)return null;for(;v!==null;)e(E,v),v=v.sibling;return null}function r(E,v){for(E=new Map;v!==null;)v.key!==null?E.set(v.key,v):E.set(v.index,v),v=v.sibling;return E}function s(E,v){return E=ws(E,v),E.index=0,E.sibling=null,E}function i(E,v,b){return E.index=b,t?(b=E.alternate,b!==null?(b=b.index,b<v?(E.flags|=2,v):b):(E.flags|=2,v)):(E.flags|=1048576,v)}function o(E){return t&&E.alternate===null&&(E.flags|=2),E}function l(E,v,b,P){return v===null||v.tag!==6?(v=hd(b,E.mode,P),v.return=E,v):(v=s(v,b),v.return=E,v)}function u(E,v,b,P){var L=b.type;return L===ji?m(E,v,b.props.children,P,b.key):v!==null&&(v.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===ss&&Gp(L)===v.type)?(P=s(v,b.props),P.ref=Wo(E,v,b),P.return=E,P):(P=Xl(b.type,b.key,b.props,null,E.mode,P),P.ref=Wo(E,v,b),P.return=E,P)}function d(E,v,b,P){return v===null||v.tag!==4||v.stateNode.containerInfo!==b.containerInfo||v.stateNode.implementation!==b.implementation?(v=fd(b,E.mode,P),v.return=E,v):(v=s(v,b.children||[]),v.return=E,v)}function m(E,v,b,P,L){return v===null||v.tag!==7?(v=ei(b,E.mode,P,L),v.return=E,v):(v=s(v,b),v.return=E,v)}function g(E,v,b){if(typeof v=="string"&&v!==""||typeof v=="number")return v=hd(""+v,E.mode,b),v.return=E,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case yl:return b=Xl(v.type,v.key,v.props,null,E.mode,b),b.ref=Wo(E,null,v),b.return=E,b;case Ri:return v=fd(v,E.mode,b),v.return=E,v;case ss:var P=v._init;return g(E,P(v._payload),b)}if(Ko(v)||Fo(v))return v=ei(v,E.mode,b,null),v.return=E,v;Cl(E,v)}return null}function y(E,v,b,P){var L=v!==null?v.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return L!==null?null:l(E,v,""+b,P);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case yl:return b.key===L?u(E,v,b,P):null;case Ri:return b.key===L?d(E,v,b,P):null;case ss:return L=b._init,y(E,v,L(b._payload),P)}if(Ko(b)||Fo(b))return L!==null?null:m(E,v,b,P,null);Cl(E,b)}return null}function N(E,v,b,P,L){if(typeof P=="string"&&P!==""||typeof P=="number")return E=E.get(b)||null,l(v,E,""+P,L);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case yl:return E=E.get(P.key===null?b:P.key)||null,u(v,E,P,L);case Ri:return E=E.get(P.key===null?b:P.key)||null,d(v,E,P,L);case ss:var V=P._init;return N(E,v,b,V(P._payload),L)}if(Ko(P)||Fo(P))return E=E.get(b)||null,m(v,E,P,L,null);Cl(v,P)}return null}function R(E,v,b,P){for(var L=null,V=null,T=v,p=v=0,w=null;T!==null&&p<b.length;p++){T.index>p?(w=T,T=null):w=T.sibling;var _=y(E,T,b[p],P);if(_===null){T===null&&(T=w);break}t&&T&&_.alternate===null&&e(E,T),v=i(_,v,p),V===null?L=_:V.sibling=_,V=_,T=w}if(p===b.length)return n(E,T),vt&&Hs(E,p),L;if(T===null){for(;p<b.length;p++)T=g(E,b[p],P),T!==null&&(v=i(T,v,p),V===null?L=T:V.sibling=T,V=T);return vt&&Hs(E,p),L}for(T=r(E,T);p<b.length;p++)w=N(T,E,p,b[p],P),w!==null&&(t&&w.alternate!==null&&T.delete(w.key===null?p:w.key),v=i(w,v,p),V===null?L=w:V.sibling=w,V=w);return t&&T.forEach(function(S){return e(E,S)}),vt&&Hs(E,p),L}function j(E,v,b,P){var L=Fo(b);if(typeof L!="function")throw Error(re(150));if(b=L.call(b),b==null)throw Error(re(151));for(var V=L=null,T=v,p=v=0,w=null,_=b.next();T!==null&&!_.done;p++,_=b.next()){T.index>p?(w=T,T=null):w=T.sibling;var S=y(E,T,_.value,P);if(S===null){T===null&&(T=w);break}t&&T&&S.alternate===null&&e(E,T),v=i(S,v,p),V===null?L=S:V.sibling=S,V=S,T=w}if(_.done)return n(E,T),vt&&Hs(E,p),L;if(T===null){for(;!_.done;p++,_=b.next())_=g(E,_.value,P),_!==null&&(v=i(_,v,p),V===null?L=_:V.sibling=_,V=_);return vt&&Hs(E,p),L}for(T=r(E,T);!_.done;p++,_=b.next())_=N(T,E,p,_.value,P),_!==null&&(t&&_.alternate!==null&&T.delete(_.key===null?p:_.key),v=i(_,v,p),V===null?L=_:V.sibling=_,V=_);return t&&T.forEach(function(C){return e(E,C)}),vt&&Hs(E,p),L}function k(E,v,b,P){if(typeof b=="object"&&b!==null&&b.type===ji&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case yl:e:{for(var L=b.key,V=v;V!==null;){if(V.key===L){if(L=b.type,L===ji){if(V.tag===7){n(E,V.sibling),v=s(V,b.props.children),v.return=E,E=v;break e}}else if(V.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===ss&&Gp(L)===V.type){n(E,V.sibling),v=s(V,b.props),v.ref=Wo(E,V,b),v.return=E,E=v;break e}n(E,V);break}else e(E,V);V=V.sibling}b.type===ji?(v=ei(b.props.children,E.mode,P,b.key),v.return=E,E=v):(P=Xl(b.type,b.key,b.props,null,E.mode,P),P.ref=Wo(E,v,b),P.return=E,E=P)}return o(E);case Ri:e:{for(V=b.key;v!==null;){if(v.key===V)if(v.tag===4&&v.stateNode.containerInfo===b.containerInfo&&v.stateNode.implementation===b.implementation){n(E,v.sibling),v=s(v,b.children||[]),v.return=E,E=v;break e}else{n(E,v);break}else e(E,v);v=v.sibling}v=fd(b,E.mode,P),v.return=E,E=v}return o(E);case ss:return V=b._init,k(E,v,V(b._payload),P)}if(Ko(b))return R(E,v,b,P);if(Fo(b))return j(E,v,b,P);Cl(E,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,v!==null&&v.tag===6?(n(E,v.sibling),v=s(v,b),v.return=E,E=v):(n(E,v),v=hd(b,E.mode,P),v.return=E,E=v),o(E)):n(E,v)}return k}var io=cv(!0),uv=cv(!1),Tc=Ls(null),Ic=null,Bi=null,gf=null;function yf(){gf=Bi=Ic=null}function vf(t){var e=Tc.current;gt(Tc),t._currentValue=e}function rh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ki(t,e){Ic=t,gf=Bi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(vn=!0),t.firstContext=null)}function zn(t){var e=t._currentValue;if(gf!==t)if(t={context:t,memoizedValue:e,next:null},Bi===null){if(Ic===null)throw Error(re(308));Bi=t,Ic.dependencies={lanes:0,firstContext:t}}else Bi=Bi.next=t;return e}var Qs=null;function _f(t){Qs===null?Qs=[t]:Qs.push(t)}function dv(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,_f(e)):(n.next=s.next,s.next=n),e.interleaved=n,Ur(t,r)}function Ur(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var is=!1;function xf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Mr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function vs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Je&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Ur(t,n)}return s=r.interleaved,s===null?(e.next=e,_f(r)):(e.next=s.next,s.next=e),r.interleaved=e,Ur(t,n)}function Hl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,sf(t,n)}}function Kp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function bc(t,e,n,r){var s=t.updateQueue;is=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var m=t.alternate;m!==null&&(m=m.updateQueue,l=m.lastBaseUpdate,l!==o&&(l===null?m.firstBaseUpdate=d:l.next=d,m.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;o=0,m=d=u=null,l=i;do{var y=l.lane,N=l.eventTime;if((r&y)===y){m!==null&&(m=m.next={eventTime:N,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var R=t,j=l;switch(y=e,N=n,j.tag){case 1:if(R=j.payload,typeof R=="function"){g=R.call(N,g,y);break e}g=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=j.payload,y=typeof R=="function"?R.call(N,g,y):R,y==null)break e;g=Tt({},g,y);break e;case 2:is=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[l]:y.push(l))}else N={eventTime:N,lane:y,tag:l.tag,payload:l.payload,callback:l.callback,next:null},m===null?(d=m=N,u=g):m=m.next=N,o|=y;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;y=l,l=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(m===null&&(u=g),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=m,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ii|=o,t.lanes=o,t.memoizedState=g}}function Qp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(re(191,s));s.call(r)}}}var Ka={},pr=Ls(Ka),Ca=Ls(Ka),Aa=Ls(Ka);function Ys(t){if(t===Ka)throw Error(re(174));return t}function wf(t,e){switch(ht(Aa,e),ht(Ca,t),ht(pr,Ka),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ld(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ld(e,t)}gt(pr),ht(pr,e)}function oo(){gt(pr),gt(Ca),gt(Aa)}function fv(t){Ys(Aa.current);var e=Ys(pr.current),n=Ld(e,t.type);e!==n&&(ht(Ca,t),ht(pr,n))}function Ef(t){Ca.current===t&&(gt(pr),gt(Ca))}var wt=Ls(0);function Sc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var od=[];function Tf(){for(var t=0;t<od.length;t++)od[t]._workInProgressVersionPrimary=null;od.length=0}var ql=qr.ReactCurrentDispatcher,ad=qr.ReactCurrentBatchConfig,si=0,Et=null,Vt=null,Ut=null,Nc=!1,oa=!1,ka=0,GT=0;function Jt(){throw Error(re(321))}function If(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ir(t[n],e[n]))return!1;return!0}function bf(t,e,n,r,s,i){if(si=i,Et=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ql.current=t===null||t.memoizedState===null?XT:JT,t=n(r,s),oa){i=0;do{if(oa=!1,ka=0,25<=i)throw Error(re(301));i+=1,Ut=Vt=null,e.updateQueue=null,ql.current=ZT,t=n(r,s)}while(oa)}if(ql.current=Cc,e=Vt!==null&&Vt.next!==null,si=0,Ut=Vt=Et=null,Nc=!1,e)throw Error(re(300));return t}function Sf(){var t=ka!==0;return ka=0,t}function cr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ut===null?Et.memoizedState=Ut=t:Ut=Ut.next=t,Ut}function Wn(){if(Vt===null){var t=Et.alternate;t=t!==null?t.memoizedState:null}else t=Vt.next;var e=Ut===null?Et.memoizedState:Ut.next;if(e!==null)Ut=e,Vt=t;else{if(t===null)throw Error(re(310));Vt=t,t={memoizedState:Vt.memoizedState,baseState:Vt.baseState,baseQueue:Vt.baseQueue,queue:Vt.queue,next:null},Ut===null?Et.memoizedState=Ut=t:Ut=Ut.next=t}return Ut}function Pa(t,e){return typeof e=="function"?e(t):e}function ld(t){var e=Wn(),n=e.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=t;var r=Vt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,d=i;do{var m=d.lane;if((si&m)===m)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var g={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=g,o=r):u=u.next=g,Et.lanes|=m,ii|=m}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=l,ir(r,e.memoizedState)||(vn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Et.lanes|=i,ii|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function cd(t){var e=Wn(),n=e.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);ir(i,e.memoizedState)||(vn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function mv(){}function pv(t,e){var n=Et,r=Wn(),s=e(),i=!ir(r.memoizedState,s);if(i&&(r.memoizedState=s,vn=!0),r=r.queue,Nf(vv.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Ut!==null&&Ut.memoizedState.tag&1){if(n.flags|=2048,Ra(9,yv.bind(null,n,r,s,e),void 0,null),Bt===null)throw Error(re(349));si&30||gv(n,e,s)}return s}function gv(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Et.updateQueue,e===null?(e={lastEffect:null,stores:null},Et.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function yv(t,e,n,r){e.value=n,e.getSnapshot=r,_v(e)&&xv(t)}function vv(t,e,n){return n(function(){_v(e)&&xv(t)})}function _v(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ir(t,n)}catch{return!0}}function xv(t){var e=Ur(t,1);e!==null&&rr(e,t,1,-1)}function Yp(t){var e=cr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:t},e.queue=t,t=t.dispatch=YT.bind(null,Et,t),[e.memoizedState,t]}function Ra(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Et.updateQueue,e===null?(e={lastEffect:null,stores:null},Et.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function wv(){return Wn().memoizedState}function Gl(t,e,n,r){var s=cr();Et.flags|=t,s.memoizedState=Ra(1|e,n,void 0,r===void 0?null:r)}function au(t,e,n,r){var s=Wn();r=r===void 0?null:r;var i=void 0;if(Vt!==null){var o=Vt.memoizedState;if(i=o.destroy,r!==null&&If(r,o.deps)){s.memoizedState=Ra(e,n,i,r);return}}Et.flags|=t,s.memoizedState=Ra(1|e,n,i,r)}function Xp(t,e){return Gl(8390656,8,t,e)}function Nf(t,e){return au(2048,8,t,e)}function Ev(t,e){return au(4,2,t,e)}function Tv(t,e){return au(4,4,t,e)}function Iv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function bv(t,e,n){return n=n!=null?n.concat([t]):null,au(4,4,Iv.bind(null,e,t),n)}function Cf(){}function Sv(t,e){var n=Wn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&If(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Nv(t,e){var n=Wn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&If(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Cv(t,e,n){return si&21?(ir(n,e)||(n=jy(),Et.lanes|=n,ii|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,vn=!0),t.memoizedState=n)}function KT(t,e){var n=ot;ot=n!==0&&4>n?n:4,t(!0);var r=ad.transition;ad.transition={};try{t(!1),e()}finally{ot=n,ad.transition=r}}function Av(){return Wn().memoizedState}function QT(t,e,n){var r=xs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},kv(t))Pv(e,n);else if(n=dv(t,e,n,r),n!==null){var s=dn();rr(n,t,r,s),Rv(n,e,r)}}function YT(t,e,n){var r=xs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(kv(t))Pv(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,ir(l,o)){var u=e.interleaved;u===null?(s.next=s,_f(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=dv(t,e,s,r),n!==null&&(s=dn(),rr(n,t,r,s),Rv(n,e,r))}}function kv(t){var e=t.alternate;return t===Et||e!==null&&e===Et}function Pv(t,e){oa=Nc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Rv(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,sf(t,n)}}var Cc={readContext:zn,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},XT={readContext:zn,useCallback:function(t,e){return cr().memoizedState=[t,e===void 0?null:e],t},useContext:zn,useEffect:Xp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Gl(4194308,4,Iv.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Gl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Gl(4,2,t,e)},useMemo:function(t,e){var n=cr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=cr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=QT.bind(null,Et,t),[r.memoizedState,t]},useRef:function(t){var e=cr();return t={current:t},e.memoizedState=t},useState:Yp,useDebugValue:Cf,useDeferredValue:function(t){return cr().memoizedState=t},useTransition:function(){var t=Yp(!1),e=t[0];return t=KT.bind(null,t[1]),cr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Et,s=cr();if(vt){if(n===void 0)throw Error(re(407));n=n()}else{if(n=e(),Bt===null)throw Error(re(349));si&30||gv(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Xp(vv.bind(null,r,i,t),[t]),r.flags|=2048,Ra(9,yv.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=cr(),e=Bt.identifierPrefix;if(vt){var n=Rr,r=Pr;n=(r&~(1<<32-nr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ka++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=GT++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},JT={readContext:zn,useCallback:Sv,useContext:zn,useEffect:Nf,useImperativeHandle:bv,useInsertionEffect:Ev,useLayoutEffect:Tv,useMemo:Nv,useReducer:ld,useRef:wv,useState:function(){return ld(Pa)},useDebugValue:Cf,useDeferredValue:function(t){var e=Wn();return Cv(e,Vt.memoizedState,t)},useTransition:function(){var t=ld(Pa)[0],e=Wn().memoizedState;return[t,e]},useMutableSource:mv,useSyncExternalStore:pv,useId:Av,unstable_isNewReconciler:!1},ZT={readContext:zn,useCallback:Sv,useContext:zn,useEffect:Nf,useImperativeHandle:bv,useInsertionEffect:Ev,useLayoutEffect:Tv,useMemo:Nv,useReducer:cd,useRef:wv,useState:function(){return cd(Pa)},useDebugValue:Cf,useDeferredValue:function(t){var e=Wn();return Vt===null?e.memoizedState=t:Cv(e,Vt.memoizedState,t)},useTransition:function(){var t=cd(Pa)[0],e=Wn().memoizedState;return[t,e]},useMutableSource:mv,useSyncExternalStore:pv,useId:Av,unstable_isNewReconciler:!1};function Yn(t,e){if(t&&t.defaultProps){e=Tt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function sh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Tt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var lu={isMounted:function(t){return(t=t._reactInternals)?mi(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=dn(),s=xs(t),i=Mr(r,s);i.payload=e,n!=null&&(i.callback=n),e=vs(t,i,s),e!==null&&(rr(e,t,s,r),Hl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=dn(),s=xs(t),i=Mr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=vs(t,i,s),e!==null&&(rr(e,t,s,r),Hl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=dn(),r=xs(t),s=Mr(n,r);s.tag=2,e!=null&&(s.callback=e),e=vs(t,s,r),e!==null&&(rr(e,t,r,n),Hl(e,t,r))}};function Jp(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ia(n,r)||!Ia(s,i):!0}function jv(t,e,n){var r=!1,s=Cs,i=e.contextType;return typeof i=="object"&&i!==null?i=zn(i):(s=xn(e)?ni:sn.current,r=e.contextTypes,i=(r=r!=null)?ro(t,s):Cs),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=lu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Zp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&lu.enqueueReplaceState(e,e.state,null)}function ih(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},xf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=zn(i):(i=xn(e)?ni:sn.current,s.context=ro(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(sh(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&lu.enqueueReplaceState(s,s.state,null),bc(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ao(t,e){try{var n="",r=e;do n+=NE(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function ud(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function oh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var e1=typeof WeakMap=="function"?WeakMap:Map;function Dv(t,e,n){n=Mr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){kc||(kc=!0,gh=r),oh(t,e)},n}function Vv(t,e,n){n=Mr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){oh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){oh(t,e),typeof r!="function"&&(_s===null?_s=new Set([this]):_s.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function eg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new e1;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=m1.bind(null,t,e,n),e.then(t,t))}function tg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ng(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Mr(-1,1),e.tag=2,vs(n,e,1))),n.lanes|=1),t)}var t1=qr.ReactCurrentOwner,vn=!1;function cn(t,e,n,r){e.child=t===null?uv(e,null,n,r):io(e,t.child,n,r)}function rg(t,e,n,r,s){n=n.render;var i=e.ref;return Ki(e,s),r=bf(t,e,n,r,i,s),n=Sf(),t!==null&&!vn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Br(t,e,s)):(vt&&n&&ff(e),e.flags|=1,cn(t,e,r,s),e.child)}function sg(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Mf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Mv(t,e,i,r,s)):(t=Xl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ia,n(o,r)&&t.ref===e.ref)return Br(t,e,s)}return e.flags|=1,t=ws(i,r),t.ref=e.ref,t.return=e,e.child=t}function Mv(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ia(i,r)&&t.ref===e.ref)if(vn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(vn=!0);else return e.lanes=t.lanes,Br(t,e,s)}return ah(t,e,n,r,s)}function Lv(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ht(zi,Nn),Nn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ht(zi,Nn),Nn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ht(zi,Nn),Nn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,ht(zi,Nn),Nn|=r;return cn(t,e,s,n),e.child}function Ov(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ah(t,e,n,r,s){var i=xn(n)?ni:sn.current;return i=ro(e,i),Ki(e,s),n=bf(t,e,n,r,i,s),r=Sf(),t!==null&&!vn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Br(t,e,s)):(vt&&r&&ff(e),e.flags|=1,cn(t,e,n,s),e.child)}function ig(t,e,n,r,s){if(xn(n)){var i=!0;xc(e)}else i=!1;if(Ki(e,s),e.stateNode===null)Kl(t,e),jv(e,n,r),ih(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=zn(d):(d=xn(n)?ni:sn.current,d=ro(e,d));var m=n.getDerivedStateFromProps,g=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&Zp(e,o,r,d),is=!1;var y=e.memoizedState;o.state=y,bc(e,r,o,s),u=e.memoizedState,l!==r||y!==u||_n.current||is?(typeof m=="function"&&(sh(e,n,m,r),u=e.memoizedState),(l=is||Jp(e,n,l,r,y,u,d))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,hv(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Yn(e.type,l),o.props=d,g=e.pendingProps,y=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=zn(u):(u=xn(n)?ni:sn.current,u=ro(e,u));var N=n.getDerivedStateFromProps;(m=typeof N=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==g||y!==u)&&Zp(e,o,r,u),is=!1,y=e.memoizedState,o.state=y,bc(e,r,o,s);var R=e.memoizedState;l!==g||y!==R||_n.current||is?(typeof N=="function"&&(sh(e,n,N,r),R=e.memoizedState),(d=is||Jp(e,n,d,r,y,R,u)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return lh(t,e,n,r,i,s)}function lh(t,e,n,r,s,i){Ov(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Wp(e,n,!1),Br(t,e,i);r=e.stateNode,t1.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=io(e,t.child,null,i),e.child=io(e,null,l,i)):cn(t,e,l,i),e.memoizedState=r.state,s&&Wp(e,n,!0),e.child}function Fv(t){var e=t.stateNode;e.pendingContext?zp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&zp(t,e.context,!1),wf(t,e.containerInfo)}function og(t,e,n,r,s){return so(),pf(s),e.flags|=256,cn(t,e,n,r),e.child}var ch={dehydrated:null,treeContext:null,retryLane:0};function uh(t){return{baseLanes:t,cachePool:null,transitions:null}}function Uv(t,e,n){var r=e.pendingProps,s=wt.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ht(wt,s&1),t===null)return nh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=du(o,r,0,null),t=ei(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=uh(n),e.memoizedState=ch,t):Af(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return n1(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=ws(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=ws(l,i):(i=ei(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?uh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=ch,r}return i=t.child,t=i.sibling,r=ws(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Af(t,e){return e=du({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Al(t,e,n,r){return r!==null&&pf(r),io(e,t.child,null,n),t=Af(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function n1(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=ud(Error(re(422))),Al(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=du({mode:"visible",children:r.children},s,0,null),i=ei(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&io(e,t.child,null,o),e.child.memoizedState=uh(o),e.memoizedState=ch,i);if(!(e.mode&1))return Al(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(re(419)),r=ud(i,r,void 0),Al(t,e,o,r)}if(l=(o&t.childLanes)!==0,vn||l){if(r=Bt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Ur(t,s),rr(r,t,s,-1))}return Vf(),r=ud(Error(re(421))),Al(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=p1.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Cn=ys(s.nextSibling),An=e,vt=!0,Jn=null,t!==null&&(On[Fn++]=Pr,On[Fn++]=Rr,On[Fn++]=ri,Pr=t.id,Rr=t.overflow,ri=e),e=Af(e,r.children),e.flags|=4096,e)}function ag(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),rh(t.return,e,n)}function dd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Bv(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(cn(t,e,r.children,n),r=wt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ag(t,n,e);else if(t.tag===19)ag(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ht(wt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Sc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),dd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Sc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}dd(e,!0,n,null,i);break;case"together":dd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Kl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Br(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ii|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(re(153));if(e.child!==null){for(t=e.child,n=ws(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ws(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function r1(t,e,n){switch(e.tag){case 3:Fv(e),so();break;case 5:fv(e);break;case 1:xn(e.type)&&xc(e);break;case 4:wf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ht(Tc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ht(wt,wt.current&1),e.flags|=128,null):n&e.child.childLanes?Uv(t,e,n):(ht(wt,wt.current&1),t=Br(t,e,n),t!==null?t.sibling:null);ht(wt,wt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Bv(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ht(wt,wt.current),r)break;return null;case 22:case 23:return e.lanes=0,Lv(t,e,n)}return Br(t,e,n)}var $v,dh,zv,Wv;$v=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};dh=function(){};zv=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ys(pr.current);var i=null;switch(n){case"input":s=jd(t,s),r=jd(t,r),i=[];break;case"select":s=Tt({},s,{value:void 0}),r=Tt({},r,{value:void 0}),i=[];break;case"textarea":s=Md(t,s),r=Md(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=vc)}Od(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ya.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ya.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&mt("scroll",t),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Wv=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ho(t,e){if(!vt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Zt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function s1(t,e,n){var r=e.pendingProps;switch(mf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(e),null;case 1:return xn(e.type)&&_c(),Zt(e),null;case 3:return r=e.stateNode,oo(),gt(_n),gt(sn),Tf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Nl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Jn!==null&&(_h(Jn),Jn=null))),dh(t,e),Zt(e),null;case 5:Ef(e);var s=Ys(Aa.current);if(n=e.type,t!==null&&e.stateNode!=null)zv(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(re(166));return Zt(e),null}if(t=Ys(pr.current),Nl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[fr]=e,r[Na]=i,t=(e.mode&1)!==0,n){case"dialog":mt("cancel",r),mt("close",r);break;case"iframe":case"object":case"embed":mt("load",r);break;case"video":case"audio":for(s=0;s<Yo.length;s++)mt(Yo[s],r);break;case"source":mt("error",r);break;case"img":case"image":case"link":mt("error",r),mt("load",r);break;case"details":mt("toggle",r);break;case"input":gp(r,i),mt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},mt("invalid",r);break;case"textarea":vp(r,i),mt("invalid",r)}Od(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Sl(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Sl(r.textContent,l,t),s=["children",""+l]):ya.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&mt("scroll",r)}switch(n){case"input":vl(r),yp(r,i,!0);break;case"textarea":vl(r),_p(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=vc)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=vy(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[fr]=e,t[Na]=r,$v(t,e,!1,!1),e.stateNode=t;e:{switch(o=Fd(n,r),n){case"dialog":mt("cancel",t),mt("close",t),s=r;break;case"iframe":case"object":case"embed":mt("load",t),s=r;break;case"video":case"audio":for(s=0;s<Yo.length;s++)mt(Yo[s],t);s=r;break;case"source":mt("error",t),s=r;break;case"img":case"image":case"link":mt("error",t),mt("load",t),s=r;break;case"details":mt("toggle",t),s=r;break;case"input":gp(t,r),s=jd(t,r),mt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Tt({},r,{value:void 0}),mt("invalid",t);break;case"textarea":vp(t,r),s=Md(t,r),mt("invalid",t);break;default:s=r}Od(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?wy(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&_y(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&va(t,u):typeof u=="number"&&va(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ya.hasOwnProperty(i)?u!=null&&i==="onScroll"&&mt("scroll",t):u!=null&&Jh(t,i,u,o))}switch(n){case"input":vl(t),yp(t,r,!1);break;case"textarea":vl(t),_p(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ns(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Wi(t,!!r.multiple,i,!1):r.defaultValue!=null&&Wi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=vc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Zt(e),null;case 6:if(t&&e.stateNode!=null)Wv(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(re(166));if(n=Ys(Aa.current),Ys(pr.current),Nl(e)){if(r=e.stateNode,n=e.memoizedProps,r[fr]=e,(i=r.nodeValue!==n)&&(t=An,t!==null))switch(t.tag){case 3:Sl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Sl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[fr]=e,e.stateNode=r}return Zt(e),null;case 13:if(gt(wt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(vt&&Cn!==null&&e.mode&1&&!(e.flags&128))lv(),so(),e.flags|=98560,i=!1;else if(i=Nl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(re(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(re(317));i[fr]=e}else so(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Zt(e),i=!1}else Jn!==null&&(_h(Jn),Jn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||wt.current&1?Mt===0&&(Mt=3):Vf())),e.updateQueue!==null&&(e.flags|=4),Zt(e),null);case 4:return oo(),dh(t,e),t===null&&ba(e.stateNode.containerInfo),Zt(e),null;case 10:return vf(e.type._context),Zt(e),null;case 17:return xn(e.type)&&_c(),Zt(e),null;case 19:if(gt(wt),i=e.memoizedState,i===null)return Zt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Ho(i,!1);else{if(Mt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Sc(t),o!==null){for(e.flags|=128,Ho(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ht(wt,wt.current&1|2),e.child}t=t.sibling}i.tail!==null&&kt()>lo&&(e.flags|=128,r=!0,Ho(i,!1),e.lanes=4194304)}else{if(!r)if(t=Sc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ho(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!vt)return Zt(e),null}else 2*kt()-i.renderingStartTime>lo&&n!==1073741824&&(e.flags|=128,r=!0,Ho(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=kt(),e.sibling=null,n=wt.current,ht(wt,r?n&1|2:n&1),e):(Zt(e),null);case 22:case 23:return Df(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Nn&1073741824&&(Zt(e),e.subtreeFlags&6&&(e.flags|=8192)):Zt(e),null;case 24:return null;case 25:return null}throw Error(re(156,e.tag))}function i1(t,e){switch(mf(e),e.tag){case 1:return xn(e.type)&&_c(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return oo(),gt(_n),gt(sn),Tf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ef(e),null;case 13:if(gt(wt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(re(340));so()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return gt(wt),null;case 4:return oo(),null;case 10:return vf(e.type._context),null;case 22:case 23:return Df(),null;case 24:return null;default:return null}}var kl=!1,nn=!1,o1=typeof WeakSet=="function"?WeakSet:Set,pe=null;function $i(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ct(t,e,r)}else n.current=null}function hh(t,e,n){try{n()}catch(r){Ct(t,e,r)}}var lg=!1;function a1(t,e){if(Qd=pc,t=Qy(),hf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,m=0,g=t,y=null;t:for(;;){for(var N;g!==n||s!==0&&g.nodeType!==3||(l=o+s),g!==i||r!==0&&g.nodeType!==3||(u=o+r),g.nodeType===3&&(o+=g.nodeValue.length),(N=g.firstChild)!==null;)y=g,g=N;for(;;){if(g===t)break t;if(y===n&&++d===s&&(l=o),y===i&&++m===r&&(u=o),(N=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=N}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Yd={focusedElem:t,selectionRange:n},pc=!1,pe=e;pe!==null;)if(e=pe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,pe=t;else for(;pe!==null;){e=pe;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var j=R.memoizedProps,k=R.memoizedState,E=e.stateNode,v=E.getSnapshotBeforeUpdate(e.elementType===e.type?j:Yn(e.type,j),k);E.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(P){Ct(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,pe=t;break}pe=e.return}return R=lg,lg=!1,R}function aa(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&hh(e,n,i)}s=s.next}while(s!==r)}}function cu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function fh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Hv(t){var e=t.alternate;e!==null&&(t.alternate=null,Hv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[fr],delete e[Na],delete e[Zd],delete e[zT],delete e[WT])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function qv(t){return t.tag===5||t.tag===3||t.tag===4}function cg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||qv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function mh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=vc));else if(r!==4&&(t=t.child,t!==null))for(mh(t,e,n),t=t.sibling;t!==null;)mh(t,e,n),t=t.sibling}function ph(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(ph(t,e,n),t=t.sibling;t!==null;)ph(t,e,n),t=t.sibling}var Wt=null,Xn=!1;function ns(t,e,n){for(n=n.child;n!==null;)Gv(t,e,n),n=n.sibling}function Gv(t,e,n){if(mr&&typeof mr.onCommitFiberUnmount=="function")try{mr.onCommitFiberUnmount(tu,n)}catch{}switch(n.tag){case 5:nn||$i(n,e);case 6:var r=Wt,s=Xn;Wt=null,ns(t,e,n),Wt=r,Xn=s,Wt!==null&&(Xn?(t=Wt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Wt.removeChild(n.stateNode));break;case 18:Wt!==null&&(Xn?(t=Wt,n=n.stateNode,t.nodeType===8?sd(t.parentNode,n):t.nodeType===1&&sd(t,n),Ea(t)):sd(Wt,n.stateNode));break;case 4:r=Wt,s=Xn,Wt=n.stateNode.containerInfo,Xn=!0,ns(t,e,n),Wt=r,Xn=s;break;case 0:case 11:case 14:case 15:if(!nn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&hh(n,e,o),s=s.next}while(s!==r)}ns(t,e,n);break;case 1:if(!nn&&($i(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ct(n,e,l)}ns(t,e,n);break;case 21:ns(t,e,n);break;case 22:n.mode&1?(nn=(r=nn)||n.memoizedState!==null,ns(t,e,n),nn=r):ns(t,e,n);break;default:ns(t,e,n)}}function ug(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new o1),e.forEach(function(r){var s=g1.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Kn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Wt=l.stateNode,Xn=!1;break e;case 3:Wt=l.stateNode.containerInfo,Xn=!0;break e;case 4:Wt=l.stateNode.containerInfo,Xn=!0;break e}l=l.return}if(Wt===null)throw Error(re(160));Gv(i,o,s),Wt=null,Xn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Ct(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Kv(e,t),e=e.sibling}function Kv(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Kn(e,t),lr(t),r&4){try{aa(3,t,t.return),cu(3,t)}catch(j){Ct(t,t.return,j)}try{aa(5,t,t.return)}catch(j){Ct(t,t.return,j)}}break;case 1:Kn(e,t),lr(t),r&512&&n!==null&&$i(n,n.return);break;case 5:if(Kn(e,t),lr(t),r&512&&n!==null&&$i(n,n.return),t.flags&32){var s=t.stateNode;try{va(s,"")}catch(j){Ct(t,t.return,j)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&gy(s,i),Fd(l,o);var d=Fd(l,i);for(o=0;o<u.length;o+=2){var m=u[o],g=u[o+1];m==="style"?wy(s,g):m==="dangerouslySetInnerHTML"?_y(s,g):m==="children"?va(s,g):Jh(s,m,g,d)}switch(l){case"input":Dd(s,i);break;case"textarea":yy(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var N=i.value;N!=null?Wi(s,!!i.multiple,N,!1):y!==!!i.multiple&&(i.defaultValue!=null?Wi(s,!!i.multiple,i.defaultValue,!0):Wi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Na]=i}catch(j){Ct(t,t.return,j)}}break;case 6:if(Kn(e,t),lr(t),r&4){if(t.stateNode===null)throw Error(re(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(j){Ct(t,t.return,j)}}break;case 3:if(Kn(e,t),lr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ea(e.containerInfo)}catch(j){Ct(t,t.return,j)}break;case 4:Kn(e,t),lr(t);break;case 13:Kn(e,t),lr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Rf=kt())),r&4&&ug(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(nn=(d=nn)||m,Kn(e,t),nn=d):Kn(e,t),lr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!m&&t.mode&1)for(pe=t,m=t.child;m!==null;){for(g=pe=m;pe!==null;){switch(y=pe,N=y.child,y.tag){case 0:case 11:case 14:case 15:aa(4,y,y.return);break;case 1:$i(y,y.return);var R=y.stateNode;if(typeof R.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(j){Ct(r,n,j)}}break;case 5:$i(y,y.return);break;case 22:if(y.memoizedState!==null){hg(g);continue}}N!==null?(N.return=y,pe=N):hg(g)}m=m.sibling}e:for(m=null,g=t;;){if(g.tag===5){if(m===null){m=g;try{s=g.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=g.stateNode,u=g.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=xy("display",o))}catch(j){Ct(t,t.return,j)}}}else if(g.tag===6){if(m===null)try{g.stateNode.nodeValue=d?"":g.memoizedProps}catch(j){Ct(t,t.return,j)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;m===g&&(m=null),g=g.return}m===g&&(m=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Kn(e,t),lr(t),r&4&&ug(t);break;case 21:break;default:Kn(e,t),lr(t)}}function lr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(qv(n)){var r=n;break e}n=n.return}throw Error(re(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(va(s,""),r.flags&=-33);var i=cg(t);ph(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=cg(t);mh(t,l,o);break;default:throw Error(re(161))}}catch(u){Ct(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function l1(t,e,n){pe=t,Qv(t)}function Qv(t,e,n){for(var r=(t.mode&1)!==0;pe!==null;){var s=pe,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||kl;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||nn;l=kl;var d=nn;if(kl=o,(nn=u)&&!d)for(pe=s;pe!==null;)o=pe,u=o.child,o.tag===22&&o.memoizedState!==null?fg(s):u!==null?(u.return=o,pe=u):fg(s);for(;i!==null;)pe=i,Qv(i),i=i.sibling;pe=s,kl=l,nn=d}dg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,pe=i):dg(t)}}function dg(t){for(;pe!==null;){var e=pe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:nn||cu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!nn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Yn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Qp(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Qp(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var g=m.dehydrated;g!==null&&Ea(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}nn||e.flags&512&&fh(e)}catch(y){Ct(e,e.return,y)}}if(e===t){pe=null;break}if(n=e.sibling,n!==null){n.return=e.return,pe=n;break}pe=e.return}}function hg(t){for(;pe!==null;){var e=pe;if(e===t){pe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,pe=n;break}pe=e.return}}function fg(t){for(;pe!==null;){var e=pe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{cu(4,e)}catch(u){Ct(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Ct(e,s,u)}}var i=e.return;try{fh(e)}catch(u){Ct(e,i,u)}break;case 5:var o=e.return;try{fh(e)}catch(u){Ct(e,o,u)}}}catch(u){Ct(e,e.return,u)}if(e===t){pe=null;break}var l=e.sibling;if(l!==null){l.return=e.return,pe=l;break}pe=e.return}}var c1=Math.ceil,Ac=qr.ReactCurrentDispatcher,kf=qr.ReactCurrentOwner,$n=qr.ReactCurrentBatchConfig,Je=0,Bt=null,jt=null,Gt=0,Nn=0,zi=Ls(0),Mt=0,ja=null,ii=0,uu=0,Pf=0,la=null,yn=null,Rf=0,lo=1/0,Cr=null,kc=!1,gh=null,_s=null,Pl=!1,hs=null,Pc=0,ca=0,yh=null,Ql=-1,Yl=0;function dn(){return Je&6?kt():Ql!==-1?Ql:Ql=kt()}function xs(t){return t.mode&1?Je&2&&Gt!==0?Gt&-Gt:qT.transition!==null?(Yl===0&&(Yl=jy()),Yl):(t=ot,t!==0||(t=window.event,t=t===void 0?16:Uy(t.type)),t):1}function rr(t,e,n,r){if(50<ca)throw ca=0,yh=null,Error(re(185));Ha(t,n,r),(!(Je&2)||t!==Bt)&&(t===Bt&&(!(Je&2)&&(uu|=n),Mt===4&&as(t,Gt)),wn(t,r),n===1&&Je===0&&!(e.mode&1)&&(lo=kt()+500,ou&&Os()))}function wn(t,e){var n=t.callbackNode;qE(t,e);var r=mc(t,t===Bt?Gt:0);if(r===0)n!==null&&Ep(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ep(n),e===1)t.tag===0?HT(mg.bind(null,t)):iv(mg.bind(null,t)),BT(function(){!(Je&6)&&Os()}),n=null;else{switch(Dy(r)){case 1:n=rf;break;case 4:n=Py;break;case 16:n=fc;break;case 536870912:n=Ry;break;default:n=fc}n=r_(n,Yv.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Yv(t,e){if(Ql=-1,Yl=0,Je&6)throw Error(re(327));var n=t.callbackNode;if(Qi()&&t.callbackNode!==n)return null;var r=mc(t,t===Bt?Gt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Rc(t,r);else{e=r;var s=Je;Je|=2;var i=Jv();(Bt!==t||Gt!==e)&&(Cr=null,lo=kt()+500,Zs(t,e));do try{h1();break}catch(l){Xv(t,l)}while(!0);yf(),Ac.current=i,Je=s,jt!==null?e=0:(Bt=null,Gt=0,e=Mt)}if(e!==0){if(e===2&&(s=Wd(t),s!==0&&(r=s,e=vh(t,s))),e===1)throw n=ja,Zs(t,0),as(t,r),wn(t,kt()),n;if(e===6)as(t,r);else{if(s=t.current.alternate,!(r&30)&&!u1(s)&&(e=Rc(t,r),e===2&&(i=Wd(t),i!==0&&(r=i,e=vh(t,i))),e===1))throw n=ja,Zs(t,0),as(t,r),wn(t,kt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(re(345));case 2:qs(t,yn,Cr);break;case 3:if(as(t,r),(r&130023424)===r&&(e=Rf+500-kt(),10<e)){if(mc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){dn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Jd(qs.bind(null,t,yn,Cr),e);break}qs(t,yn,Cr);break;case 4:if(as(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-nr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=kt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*c1(r/1960))-r,10<r){t.timeoutHandle=Jd(qs.bind(null,t,yn,Cr),r);break}qs(t,yn,Cr);break;case 5:qs(t,yn,Cr);break;default:throw Error(re(329))}}}return wn(t,kt()),t.callbackNode===n?Yv.bind(null,t):null}function vh(t,e){var n=la;return t.current.memoizedState.isDehydrated&&(Zs(t,e).flags|=256),t=Rc(t,e),t!==2&&(e=yn,yn=n,e!==null&&_h(e)),t}function _h(t){yn===null?yn=t:yn.push.apply(yn,t)}function u1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!ir(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function as(t,e){for(e&=~Pf,e&=~uu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-nr(e),r=1<<n;t[n]=-1,e&=~r}}function mg(t){if(Je&6)throw Error(re(327));Qi();var e=mc(t,0);if(!(e&1))return wn(t,kt()),null;var n=Rc(t,e);if(t.tag!==0&&n===2){var r=Wd(t);r!==0&&(e=r,n=vh(t,r))}if(n===1)throw n=ja,Zs(t,0),as(t,e),wn(t,kt()),n;if(n===6)throw Error(re(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,qs(t,yn,Cr),wn(t,kt()),null}function jf(t,e){var n=Je;Je|=1;try{return t(e)}finally{Je=n,Je===0&&(lo=kt()+500,ou&&Os())}}function oi(t){hs!==null&&hs.tag===0&&!(Je&6)&&Qi();var e=Je;Je|=1;var n=$n.transition,r=ot;try{if($n.transition=null,ot=1,t)return t()}finally{ot=r,$n.transition=n,Je=e,!(Je&6)&&Os()}}function Df(){Nn=zi.current,gt(zi)}function Zs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,UT(n)),jt!==null)for(n=jt.return;n!==null;){var r=n;switch(mf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&_c();break;case 3:oo(),gt(_n),gt(sn),Tf();break;case 5:Ef(r);break;case 4:oo();break;case 13:gt(wt);break;case 19:gt(wt);break;case 10:vf(r.type._context);break;case 22:case 23:Df()}n=n.return}if(Bt=t,jt=t=ws(t.current,null),Gt=Nn=e,Mt=0,ja=null,Pf=uu=ii=0,yn=la=null,Qs!==null){for(e=0;e<Qs.length;e++)if(n=Qs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Qs=null}return t}function Xv(t,e){do{var n=jt;try{if(yf(),ql.current=Cc,Nc){for(var r=Et.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Nc=!1}if(si=0,Ut=Vt=Et=null,oa=!1,ka=0,kf.current=null,n===null||n.return===null){Mt=1,ja=e,jt=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=Gt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,m=l,g=m.tag;if(!(m.mode&1)&&(g===0||g===11||g===15)){var y=m.alternate;y?(m.updateQueue=y.updateQueue,m.memoizedState=y.memoizedState,m.lanes=y.lanes):(m.updateQueue=null,m.memoizedState=null)}var N=tg(o);if(N!==null){N.flags&=-257,ng(N,o,l,i,e),N.mode&1&&eg(i,d,e),e=N,u=d;var R=e.updateQueue;if(R===null){var j=new Set;j.add(u),e.updateQueue=j}else R.add(u);break e}else{if(!(e&1)){eg(i,d,e),Vf();break e}u=Error(re(426))}}else if(vt&&l.mode&1){var k=tg(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),ng(k,o,l,i,e),pf(ao(u,l));break e}}i=u=ao(u,l),Mt!==4&&(Mt=2),la===null?la=[i]:la.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var E=Dv(i,u,e);Kp(i,E);break e;case 1:l=u;var v=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(_s===null||!_s.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var P=Vv(i,l,e);Kp(i,P);break e}}i=i.return}while(i!==null)}e_(n)}catch(L){e=L,jt===n&&n!==null&&(jt=n=n.return);continue}break}while(!0)}function Jv(){var t=Ac.current;return Ac.current=Cc,t===null?Cc:t}function Vf(){(Mt===0||Mt===3||Mt===2)&&(Mt=4),Bt===null||!(ii&268435455)&&!(uu&268435455)||as(Bt,Gt)}function Rc(t,e){var n=Je;Je|=2;var r=Jv();(Bt!==t||Gt!==e)&&(Cr=null,Zs(t,e));do try{d1();break}catch(s){Xv(t,s)}while(!0);if(yf(),Je=n,Ac.current=r,jt!==null)throw Error(re(261));return Bt=null,Gt=0,Mt}function d1(){for(;jt!==null;)Zv(jt)}function h1(){for(;jt!==null&&!LE();)Zv(jt)}function Zv(t){var e=n_(t.alternate,t,Nn);t.memoizedProps=t.pendingProps,e===null?e_(t):jt=e,kf.current=null}function e_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=i1(n,e),n!==null){n.flags&=32767,jt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Mt=6,jt=null;return}}else if(n=s1(n,e,Nn),n!==null){jt=n;return}if(e=e.sibling,e!==null){jt=e;return}jt=e=t}while(e!==null);Mt===0&&(Mt=5)}function qs(t,e,n){var r=ot,s=$n.transition;try{$n.transition=null,ot=1,f1(t,e,n,r)}finally{$n.transition=s,ot=r}return null}function f1(t,e,n,r){do Qi();while(hs!==null);if(Je&6)throw Error(re(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(re(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(GE(t,i),t===Bt&&(jt=Bt=null,Gt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Pl||(Pl=!0,r_(fc,function(){return Qi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=$n.transition,$n.transition=null;var o=ot;ot=1;var l=Je;Je|=4,kf.current=null,a1(t,n),Kv(n,t),jT(Yd),pc=!!Qd,Yd=Qd=null,t.current=n,l1(n),OE(),Je=l,ot=o,$n.transition=i}else t.current=n;if(Pl&&(Pl=!1,hs=t,Pc=s),i=t.pendingLanes,i===0&&(_s=null),BE(n.stateNode),wn(t,kt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(kc)throw kc=!1,t=gh,gh=null,t;return Pc&1&&t.tag!==0&&Qi(),i=t.pendingLanes,i&1?t===yh?ca++:(ca=0,yh=t):ca=0,Os(),null}function Qi(){if(hs!==null){var t=Dy(Pc),e=$n.transition,n=ot;try{if($n.transition=null,ot=16>t?16:t,hs===null)var r=!1;else{if(t=hs,hs=null,Pc=0,Je&6)throw Error(re(331));var s=Je;for(Je|=4,pe=t.current;pe!==null;){var i=pe,o=i.child;if(pe.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(pe=d;pe!==null;){var m=pe;switch(m.tag){case 0:case 11:case 15:aa(8,m,i)}var g=m.child;if(g!==null)g.return=m,pe=g;else for(;pe!==null;){m=pe;var y=m.sibling,N=m.return;if(Hv(m),m===d){pe=null;break}if(y!==null){y.return=N,pe=y;break}pe=N}}}var R=i.alternate;if(R!==null){var j=R.child;if(j!==null){R.child=null;do{var k=j.sibling;j.sibling=null,j=k}while(j!==null)}}pe=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,pe=o;else e:for(;pe!==null;){if(i=pe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:aa(9,i,i.return)}var E=i.sibling;if(E!==null){E.return=i.return,pe=E;break e}pe=i.return}}var v=t.current;for(pe=v;pe!==null;){o=pe;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,pe=b;else e:for(o=v;pe!==null;){if(l=pe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:cu(9,l)}}catch(L){Ct(l,l.return,L)}if(l===o){pe=null;break e}var P=l.sibling;if(P!==null){P.return=l.return,pe=P;break e}pe=l.return}}if(Je=s,Os(),mr&&typeof mr.onPostCommitFiberRoot=="function")try{mr.onPostCommitFiberRoot(tu,t)}catch{}r=!0}return r}finally{ot=n,$n.transition=e}}return!1}function pg(t,e,n){e=ao(n,e),e=Dv(t,e,1),t=vs(t,e,1),e=dn(),t!==null&&(Ha(t,1,e),wn(t,e))}function Ct(t,e,n){if(t.tag===3)pg(t,t,n);else for(;e!==null;){if(e.tag===3){pg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(_s===null||!_s.has(r))){t=ao(n,t),t=Vv(e,t,1),e=vs(e,t,1),t=dn(),e!==null&&(Ha(e,1,t),wn(e,t));break}}e=e.return}}function m1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=dn(),t.pingedLanes|=t.suspendedLanes&n,Bt===t&&(Gt&n)===n&&(Mt===4||Mt===3&&(Gt&130023424)===Gt&&500>kt()-Rf?Zs(t,0):Pf|=n),wn(t,e)}function t_(t,e){e===0&&(t.mode&1?(e=wl,wl<<=1,!(wl&130023424)&&(wl=4194304)):e=1);var n=dn();t=Ur(t,e),t!==null&&(Ha(t,e,n),wn(t,n))}function p1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),t_(t,n)}function g1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(re(314))}r!==null&&r.delete(e),t_(t,n)}var n_;n_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||_n.current)vn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return vn=!1,r1(t,e,n);vn=!!(t.flags&131072)}else vn=!1,vt&&e.flags&1048576&&ov(e,Ec,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Kl(t,e),t=e.pendingProps;var s=ro(e,sn.current);Ki(e,n),s=bf(null,e,r,t,s,n);var i=Sf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,xn(r)?(i=!0,xc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,xf(e),s.updater=lu,e.stateNode=s,s._reactInternals=e,ih(e,r,t,n),e=lh(null,e,r,!0,i,n)):(e.tag=0,vt&&i&&ff(e),cn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Kl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=v1(r),t=Yn(r,t),s){case 0:e=ah(null,e,r,t,n);break e;case 1:e=ig(null,e,r,t,n);break e;case 11:e=rg(null,e,r,t,n);break e;case 14:e=sg(null,e,r,Yn(r.type,t),n);break e}throw Error(re(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yn(r,s),ah(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yn(r,s),ig(t,e,r,s,n);case 3:e:{if(Fv(e),t===null)throw Error(re(387));r=e.pendingProps,i=e.memoizedState,s=i.element,hv(t,e),bc(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ao(Error(re(423)),e),e=og(t,e,r,n,s);break e}else if(r!==s){s=ao(Error(re(424)),e),e=og(t,e,r,n,s);break e}else for(Cn=ys(e.stateNode.containerInfo.firstChild),An=e,vt=!0,Jn=null,n=uv(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(so(),r===s){e=Br(t,e,n);break e}cn(t,e,r,n)}e=e.child}return e;case 5:return fv(e),t===null&&nh(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Xd(r,s)?o=null:i!==null&&Xd(r,i)&&(e.flags|=32),Ov(t,e),cn(t,e,o,n),e.child;case 6:return t===null&&nh(e),null;case 13:return Uv(t,e,n);case 4:return wf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=io(e,null,r,n):cn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yn(r,s),rg(t,e,r,s,n);case 7:return cn(t,e,e.pendingProps,n),e.child;case 8:return cn(t,e,e.pendingProps.children,n),e.child;case 12:return cn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,ht(Tc,r._currentValue),r._currentValue=o,i!==null)if(ir(i.value,o)){if(i.children===s.children&&!_n.current){e=Br(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Mr(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?u.next=u:(u.next=m.next,m.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),rh(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(re(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),rh(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}cn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Ki(e,n),s=zn(s),r=r(s),e.flags|=1,cn(t,e,r,n),e.child;case 14:return r=e.type,s=Yn(r,e.pendingProps),s=Yn(r.type,s),sg(t,e,r,s,n);case 15:return Mv(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yn(r,s),Kl(t,e),e.tag=1,xn(r)?(t=!0,xc(e)):t=!1,Ki(e,n),jv(e,r,s),ih(e,r,s,n),lh(null,e,r,!0,t,n);case 19:return Bv(t,e,n);case 22:return Lv(t,e,n)}throw Error(re(156,e.tag))};function r_(t,e){return ky(t,e)}function y1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(t,e,n,r){return new y1(t,e,n,r)}function Mf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function v1(t){if(typeof t=="function")return Mf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ef)return 11;if(t===tf)return 14}return 2}function ws(t,e){var n=t.alternate;return n===null?(n=Bn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Xl(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Mf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ji:return ei(n.children,s,i,e);case Zh:o=8,s|=8;break;case Ad:return t=Bn(12,n,e,s|2),t.elementType=Ad,t.lanes=i,t;case kd:return t=Bn(13,n,e,s),t.elementType=kd,t.lanes=i,t;case Pd:return t=Bn(19,n,e,s),t.elementType=Pd,t.lanes=i,t;case fy:return du(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case dy:o=10;break e;case hy:o=9;break e;case ef:o=11;break e;case tf:o=14;break e;case ss:o=16,r=null;break e}throw Error(re(130,t==null?t:typeof t,""))}return e=Bn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ei(t,e,n,r){return t=Bn(7,t,r,e),t.lanes=n,t}function du(t,e,n,r){return t=Bn(22,t,r,e),t.elementType=fy,t.lanes=n,t.stateNode={isHidden:!1},t}function hd(t,e,n){return t=Bn(6,t,null,e),t.lanes=n,t}function fd(t,e,n){return e=Bn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function _1(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gu(0),this.expirationTimes=Gu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Lf(t,e,n,r,s,i,o,l,u){return t=new _1(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Bn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},xf(i),t}function x1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ri,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function s_(t){if(!t)return Cs;t=t._reactInternals;e:{if(mi(t)!==t||t.tag!==1)throw Error(re(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(xn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(re(171))}if(t.tag===1){var n=t.type;if(xn(n))return sv(t,n,e)}return e}function i_(t,e,n,r,s,i,o,l,u){return t=Lf(n,r,!0,t,s,i,o,l,u),t.context=s_(null),n=t.current,r=dn(),s=xs(n),i=Mr(r,s),i.callback=e??null,vs(n,i,s),t.current.lanes=s,Ha(t,s,r),wn(t,r),t}function hu(t,e,n,r){var s=e.current,i=dn(),o=xs(s);return n=s_(n),e.context===null?e.context=n:e.pendingContext=n,e=Mr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=vs(s,e,o),t!==null&&(rr(t,s,o,i),Hl(t,s,o)),o}function jc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function gg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Of(t,e){gg(t,e),(t=t.alternate)&&gg(t,e)}function w1(){return null}var o_=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ff(t){this._internalRoot=t}fu.prototype.render=Ff.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(re(409));hu(t,e,null,null)};fu.prototype.unmount=Ff.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;oi(function(){hu(null,t,null,null)}),e[Fr]=null}};function fu(t){this._internalRoot=t}fu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ly();t={blockedOn:null,target:t,priority:e};for(var n=0;n<os.length&&e!==0&&e<os[n].priority;n++);os.splice(n,0,t),n===0&&Fy(t)}};function Uf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function mu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function yg(){}function E1(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=jc(o);i.call(d)}}var o=i_(e,r,t,0,null,!1,!1,"",yg);return t._reactRootContainer=o,t[Fr]=o.current,ba(t.nodeType===8?t.parentNode:t),oi(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=jc(u);l.call(d)}}var u=Lf(t,0,!1,null,null,!1,!1,"",yg);return t._reactRootContainer=u,t[Fr]=u.current,ba(t.nodeType===8?t.parentNode:t),oi(function(){hu(e,u,n,r)}),u}function pu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=jc(o);l.call(u)}}hu(e,o,t,s)}else o=E1(n,e,t,s,r);return jc(o)}Vy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Qo(e.pendingLanes);n!==0&&(sf(e,n|1),wn(e,kt()),!(Je&6)&&(lo=kt()+500,Os()))}break;case 13:oi(function(){var r=Ur(t,1);if(r!==null){var s=dn();rr(r,t,1,s)}}),Of(t,1)}};of=function(t){if(t.tag===13){var e=Ur(t,134217728);if(e!==null){var n=dn();rr(e,t,134217728,n)}Of(t,134217728)}};My=function(t){if(t.tag===13){var e=xs(t),n=Ur(t,e);if(n!==null){var r=dn();rr(n,t,e,r)}Of(t,e)}};Ly=function(){return ot};Oy=function(t,e){var n=ot;try{return ot=t,e()}finally{ot=n}};Bd=function(t,e,n){switch(e){case"input":if(Dd(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=iu(r);if(!s)throw Error(re(90));py(r),Dd(r,s)}}}break;case"textarea":yy(t,n);break;case"select":e=n.value,e!=null&&Wi(t,!!n.multiple,e,!1)}};Iy=jf;by=oi;var T1={usingClientEntryPoint:!1,Events:[Ga,Li,iu,Ey,Ty,jf]},qo={findFiberByHostInstance:Ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},I1={bundleType:qo.bundleType,version:qo.version,rendererPackageName:qo.rendererPackageName,rendererConfig:qo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Cy(t),t===null?null:t.stateNode},findFiberByHostInstance:qo.findFiberByHostInstance||w1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rl.isDisabled&&Rl.supportsFiber)try{tu=Rl.inject(I1),mr=Rl}catch{}}Pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T1;Pn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Uf(e))throw Error(re(200));return x1(t,e,null,n)};Pn.createRoot=function(t,e){if(!Uf(t))throw Error(re(299));var n=!1,r="",s=o_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Lf(t,1,!1,null,null,n,!1,r,s),t[Fr]=e.current,ba(t.nodeType===8?t.parentNode:t),new Ff(e)};Pn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(re(188)):(t=Object.keys(t).join(","),Error(re(268,t)));return t=Cy(e),t=t===null?null:t.stateNode,t};Pn.flushSync=function(t){return oi(t)};Pn.hydrate=function(t,e,n){if(!mu(e))throw Error(re(200));return pu(null,t,e,!0,n)};Pn.hydrateRoot=function(t,e,n){if(!Uf(t))throw Error(re(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=o_;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=i_(e,null,t,1,n??null,s,!1,i,o),t[Fr]=e.current,ba(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new fu(e)};Pn.render=function(t,e,n){if(!mu(e))throw Error(re(200));return pu(null,t,e,!1,n)};Pn.unmountComponentAtNode=function(t){if(!mu(t))throw Error(re(40));return t._reactRootContainer?(oi(function(){pu(null,null,t,!1,function(){t._reactRootContainer=null,t[Fr]=null})}),!0):!1};Pn.unstable_batchedUpdates=jf;Pn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!mu(n))throw Error(re(200));if(t==null||t._reactInternals===void 0)throw Error(re(38));return pu(t,e,n,!1,r)};Pn.version="18.3.1-next-f1338f8080-20240426";function a_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a_)}catch(t){console.error(t)}}a_(),ay.exports=Pn;var b1=ay.exports,vg=b1;Nd.createRoot=vg.createRoot,Nd.hydrateRoot=vg.hydrateRoot;const S1=()=>{};var _g={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},N1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},c_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,m=i>>2,g=(i&3)<<4|l>>4;let y=(l&15)<<2|d>>6,N=d&63;u||(N=64,o||(y=64)),r.push(n[m],n[g],n[y],n[N])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(l_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):N1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||g==null)throw new C1;const y=i<<2|l>>4;if(r.push(y),d!==64){const N=l<<4&240|d>>2;if(r.push(N),g!==64){const R=d<<6&192|g;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class C1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const A1=function(t){const e=l_(t);return c_.encodeByteArray(e,!0)},Dc=function(t){return A1(t).replace(/\./g,"")},u_=function(t){try{return c_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P1=()=>k1().__FIREBASE_DEFAULTS__,R1=()=>{if(typeof process>"u"||typeof _g>"u")return;const t=_g.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},j1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&u_(t[1]);return e&&JSON.parse(e)},gu=()=>{try{return S1()||P1()||R1()||j1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},d_=t=>{var e,n;return(n=(e=gu())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},D1=t=>{const e=d_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},h_=()=>{var t;return(t=gu())===null||t===void 0?void 0:t.config},f_=t=>{var e;return(e=gu())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M1(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Dc(JSON.stringify(n)),Dc(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function on(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function L1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(on())}function O1(){var t;const e=(t=gu())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function F1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function U1(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function B1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $1(){const t=on();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function z1(){return!O1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function W1(){try{return typeof indexedDB=="object"}catch{return!1}}function H1(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q1="FirebaseError";class Gr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=q1,Object.setPrototypeOf(this,Gr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qa.prototype.create)}}class Qa{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?G1(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Gr(s,l,r)}}function G1(t,e){return t.replace(K1,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const K1=/\{\$([^}]+)}/g;function Q1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ai(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(xg(i)&&xg(o)){if(!ai(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function xg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ya(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Y1(t,e){const n=new X1(t,e);return n.subscribe.bind(n)}class X1{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");J1(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=md),s.error===void 0&&(s.error=md),s.complete===void 0&&(s.complete=md);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function J1(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function md(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tn(t){return t&&t._delegate?t._delegate:t}class li{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new V1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tI(e))try{this.getOrInitializeService({instanceIdentifier:Gs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Gs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Gs){return this.instances.has(e)}getOptions(e=Gs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:eI(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Gs){return this.component?this.component.multipleInstances?e:Gs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function eI(t){return t===Gs?void 0:t}function tI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Z1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(He||(He={}));const rI={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},sI=He.INFO,iI={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},oI=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=iI[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Bf{constructor(e){this.name=e,this._logLevel=sI,this._logHandler=oI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?rI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const aI=(t,e)=>e.some(n=>t instanceof n);let wg,Eg;function lI(){return wg||(wg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cI(){return Eg||(Eg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const m_=new WeakMap,xh=new WeakMap,p_=new WeakMap,pd=new WeakMap,$f=new WeakMap;function uI(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Es(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&m_.set(n,t)}).catch(()=>{}),$f.set(e,t),e}function dI(t){if(xh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});xh.set(t,e)}let wh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return xh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||p_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Es(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function hI(t){wh=t(wh)}function fI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(gd(this),e,...n);return p_.set(r,e.sort?e.sort():[e]),Es(r)}:cI().includes(t)?function(...e){return t.apply(gd(this),e),Es(m_.get(this))}:function(...e){return Es(t.apply(gd(this),e))}}function mI(t){return typeof t=="function"?fI(t):(t instanceof IDBTransaction&&dI(t),aI(t,lI())?new Proxy(t,wh):t)}function Es(t){if(t instanceof IDBRequest)return uI(t);if(pd.has(t))return pd.get(t);const e=mI(t);return e!==t&&(pd.set(t,e),$f.set(e,t)),e}const gd=t=>$f.get(t);function pI(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Es(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Es(o.result),u.oldVersion,u.newVersion,Es(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const gI=["get","getKey","getAll","getAllKeys","count"],yI=["put","add","delete","clear"],yd=new Map;function Tg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(yd.get(e))return yd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=yI.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||gI.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&u.done]))[0]};return yd.set(e,i),i}hI(t=>({...t,get:(e,n,r)=>Tg(e,n)||t.get(e,n,r),has:(e,n)=>!!Tg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(_I(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function _I(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Eh="@firebase/app",Ig="0.11.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $r=new Bf("@firebase/app"),xI="@firebase/app-compat",wI="@firebase/analytics-compat",EI="@firebase/analytics",TI="@firebase/app-check-compat",II="@firebase/app-check",bI="@firebase/auth",SI="@firebase/auth-compat",NI="@firebase/database",CI="@firebase/data-connect",AI="@firebase/database-compat",kI="@firebase/functions",PI="@firebase/functions-compat",RI="@firebase/installations",jI="@firebase/installations-compat",DI="@firebase/messaging",VI="@firebase/messaging-compat",MI="@firebase/performance",LI="@firebase/performance-compat",OI="@firebase/remote-config",FI="@firebase/remote-config-compat",UI="@firebase/storage",BI="@firebase/storage-compat",$I="@firebase/firestore",zI="@firebase/vertexai",WI="@firebase/firestore-compat",HI="firebase",qI="11.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Th="[DEFAULT]",GI={[Eh]:"fire-core",[xI]:"fire-core-compat",[EI]:"fire-analytics",[wI]:"fire-analytics-compat",[II]:"fire-app-check",[TI]:"fire-app-check-compat",[bI]:"fire-auth",[SI]:"fire-auth-compat",[NI]:"fire-rtdb",[CI]:"fire-data-connect",[AI]:"fire-rtdb-compat",[kI]:"fire-fn",[PI]:"fire-fn-compat",[RI]:"fire-iid",[jI]:"fire-iid-compat",[DI]:"fire-fcm",[VI]:"fire-fcm-compat",[MI]:"fire-perf",[LI]:"fire-perf-compat",[OI]:"fire-rc",[FI]:"fire-rc-compat",[UI]:"fire-gcs",[BI]:"fire-gcs-compat",[$I]:"fire-fst",[WI]:"fire-fst-compat",[zI]:"fire-vertex","fire-js":"fire-js",[HI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Da=new Map,KI=new Map,Ih=new Map;function bg(t,e){try{t.container.addComponent(e)}catch(n){$r.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function co(t){const e=t.name;if(Ih.has(e))return $r.debug(`There were multiple attempts to register component ${e}.`),!1;Ih.set(e,t);for(const n of Da.values())bg(n,t);for(const n of KI.values())bg(n,t);return!0}function zf(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Zn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ts=new Qa("app","Firebase",QI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new li("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ts.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eo=qI;function g_(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Th,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Ts.create("bad-app-name",{appName:String(s)});if(n||(n=h_()),!n)throw Ts.create("no-options");const i=Da.get(s);if(i){if(ai(n,i.options)&&ai(r,i.config))return i;throw Ts.create("duplicate-app",{appName:s})}const o=new nI(s);for(const u of Ih.values())o.addComponent(u);const l=new YI(n,r,o);return Da.set(s,l),l}function y_(t=Th){const e=Da.get(t);if(!e&&t===Th&&h_())return g_();if(!e)throw Ts.create("no-app",{appName:t});return e}function Sg(){return Array.from(Da.values())}function Is(t,e,n){var r;let s=(r=GI[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$r.warn(l.join(" "));return}co(new li(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI="firebase-heartbeat-database",JI=1,Va="firebase-heartbeat-store";let vd=null;function v_(){return vd||(vd=pI(XI,JI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Va)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ts.create("idb-open",{originalErrorMessage:t.message})})),vd}async function ZI(t){try{const n=(await v_()).transaction(Va),r=await n.objectStore(Va).get(__(t));return await n.done,r}catch(e){if(e instanceof Gr)$r.warn(e.message);else{const n=Ts.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});$r.warn(n.message)}}}async function Ng(t,e){try{const r=(await v_()).transaction(Va,"readwrite");await r.objectStore(Va).put(e,__(t)),await r.done}catch(n){if(n instanceof Gr)$r.warn(n.message);else{const r=Ts.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});$r.warn(r.message)}}}function __(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eb=1024,tb=30;class nb{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new sb(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Cg();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>tb){const o=ib(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){$r.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Cg(),{heartbeatsToSend:r,unsentEntries:s}=rb(this._heartbeatsCache.heartbeats),i=Dc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return $r.warn(n),""}}}function Cg(){return new Date().toISOString().substring(0,10)}function rb(t,e=eb){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Ag(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ag(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class sb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return W1()?H1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await ZI(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ng(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ng(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Ag(t){return Dc(JSON.stringify({version:2,heartbeats:t})).length}function ib(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ob(t){co(new li("platform-logger",e=>new vI(e),"PRIVATE")),co(new li("heartbeat",e=>new nb(e),"PRIVATE")),Is(Eh,Ig,t),Is(Eh,Ig,"esm2017"),Is("fire-js","")}ob("");var kg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bs,x_;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,p){function w(){}w.prototype=p.prototype,T.D=p.prototype,T.prototype=new w,T.prototype.constructor=T,T.C=function(_,S,C){for(var I=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)I[ce-2]=arguments[ce];return p.prototype[S].apply(_,I)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,p,w){w||(w=0);var _=Array(16);if(typeof p=="string")for(var S=0;16>S;++S)_[S]=p.charCodeAt(w++)|p.charCodeAt(w++)<<8|p.charCodeAt(w++)<<16|p.charCodeAt(w++)<<24;else for(S=0;16>S;++S)_[S]=p[w++]|p[w++]<<8|p[w++]<<16|p[w++]<<24;p=T.g[0],w=T.g[1],S=T.g[2];var C=T.g[3],I=p+(C^w&(S^C))+_[0]+3614090360&4294967295;p=w+(I<<7&4294967295|I>>>25),I=C+(S^p&(w^S))+_[1]+3905402710&4294967295,C=p+(I<<12&4294967295|I>>>20),I=S+(w^C&(p^w))+_[2]+606105819&4294967295,S=C+(I<<17&4294967295|I>>>15),I=w+(p^S&(C^p))+_[3]+3250441966&4294967295,w=S+(I<<22&4294967295|I>>>10),I=p+(C^w&(S^C))+_[4]+4118548399&4294967295,p=w+(I<<7&4294967295|I>>>25),I=C+(S^p&(w^S))+_[5]+1200080426&4294967295,C=p+(I<<12&4294967295|I>>>20),I=S+(w^C&(p^w))+_[6]+2821735955&4294967295,S=C+(I<<17&4294967295|I>>>15),I=w+(p^S&(C^p))+_[7]+4249261313&4294967295,w=S+(I<<22&4294967295|I>>>10),I=p+(C^w&(S^C))+_[8]+1770035416&4294967295,p=w+(I<<7&4294967295|I>>>25),I=C+(S^p&(w^S))+_[9]+2336552879&4294967295,C=p+(I<<12&4294967295|I>>>20),I=S+(w^C&(p^w))+_[10]+4294925233&4294967295,S=C+(I<<17&4294967295|I>>>15),I=w+(p^S&(C^p))+_[11]+2304563134&4294967295,w=S+(I<<22&4294967295|I>>>10),I=p+(C^w&(S^C))+_[12]+1804603682&4294967295,p=w+(I<<7&4294967295|I>>>25),I=C+(S^p&(w^S))+_[13]+4254626195&4294967295,C=p+(I<<12&4294967295|I>>>20),I=S+(w^C&(p^w))+_[14]+2792965006&4294967295,S=C+(I<<17&4294967295|I>>>15),I=w+(p^S&(C^p))+_[15]+1236535329&4294967295,w=S+(I<<22&4294967295|I>>>10),I=p+(S^C&(w^S))+_[1]+4129170786&4294967295,p=w+(I<<5&4294967295|I>>>27),I=C+(w^S&(p^w))+_[6]+3225465664&4294967295,C=p+(I<<9&4294967295|I>>>23),I=S+(p^w&(C^p))+_[11]+643717713&4294967295,S=C+(I<<14&4294967295|I>>>18),I=w+(C^p&(S^C))+_[0]+3921069994&4294967295,w=S+(I<<20&4294967295|I>>>12),I=p+(S^C&(w^S))+_[5]+3593408605&4294967295,p=w+(I<<5&4294967295|I>>>27),I=C+(w^S&(p^w))+_[10]+38016083&4294967295,C=p+(I<<9&4294967295|I>>>23),I=S+(p^w&(C^p))+_[15]+3634488961&4294967295,S=C+(I<<14&4294967295|I>>>18),I=w+(C^p&(S^C))+_[4]+3889429448&4294967295,w=S+(I<<20&4294967295|I>>>12),I=p+(S^C&(w^S))+_[9]+568446438&4294967295,p=w+(I<<5&4294967295|I>>>27),I=C+(w^S&(p^w))+_[14]+3275163606&4294967295,C=p+(I<<9&4294967295|I>>>23),I=S+(p^w&(C^p))+_[3]+4107603335&4294967295,S=C+(I<<14&4294967295|I>>>18),I=w+(C^p&(S^C))+_[8]+1163531501&4294967295,w=S+(I<<20&4294967295|I>>>12),I=p+(S^C&(w^S))+_[13]+2850285829&4294967295,p=w+(I<<5&4294967295|I>>>27),I=C+(w^S&(p^w))+_[2]+4243563512&4294967295,C=p+(I<<9&4294967295|I>>>23),I=S+(p^w&(C^p))+_[7]+1735328473&4294967295,S=C+(I<<14&4294967295|I>>>18),I=w+(C^p&(S^C))+_[12]+2368359562&4294967295,w=S+(I<<20&4294967295|I>>>12),I=p+(w^S^C)+_[5]+4294588738&4294967295,p=w+(I<<4&4294967295|I>>>28),I=C+(p^w^S)+_[8]+2272392833&4294967295,C=p+(I<<11&4294967295|I>>>21),I=S+(C^p^w)+_[11]+1839030562&4294967295,S=C+(I<<16&4294967295|I>>>16),I=w+(S^C^p)+_[14]+4259657740&4294967295,w=S+(I<<23&4294967295|I>>>9),I=p+(w^S^C)+_[1]+2763975236&4294967295,p=w+(I<<4&4294967295|I>>>28),I=C+(p^w^S)+_[4]+1272893353&4294967295,C=p+(I<<11&4294967295|I>>>21),I=S+(C^p^w)+_[7]+4139469664&4294967295,S=C+(I<<16&4294967295|I>>>16),I=w+(S^C^p)+_[10]+3200236656&4294967295,w=S+(I<<23&4294967295|I>>>9),I=p+(w^S^C)+_[13]+681279174&4294967295,p=w+(I<<4&4294967295|I>>>28),I=C+(p^w^S)+_[0]+3936430074&4294967295,C=p+(I<<11&4294967295|I>>>21),I=S+(C^p^w)+_[3]+3572445317&4294967295,S=C+(I<<16&4294967295|I>>>16),I=w+(S^C^p)+_[6]+76029189&4294967295,w=S+(I<<23&4294967295|I>>>9),I=p+(w^S^C)+_[9]+3654602809&4294967295,p=w+(I<<4&4294967295|I>>>28),I=C+(p^w^S)+_[12]+3873151461&4294967295,C=p+(I<<11&4294967295|I>>>21),I=S+(C^p^w)+_[15]+530742520&4294967295,S=C+(I<<16&4294967295|I>>>16),I=w+(S^C^p)+_[2]+3299628645&4294967295,w=S+(I<<23&4294967295|I>>>9),I=p+(S^(w|~C))+_[0]+4096336452&4294967295,p=w+(I<<6&4294967295|I>>>26),I=C+(w^(p|~S))+_[7]+1126891415&4294967295,C=p+(I<<10&4294967295|I>>>22),I=S+(p^(C|~w))+_[14]+2878612391&4294967295,S=C+(I<<15&4294967295|I>>>17),I=w+(C^(S|~p))+_[5]+4237533241&4294967295,w=S+(I<<21&4294967295|I>>>11),I=p+(S^(w|~C))+_[12]+1700485571&4294967295,p=w+(I<<6&4294967295|I>>>26),I=C+(w^(p|~S))+_[3]+2399980690&4294967295,C=p+(I<<10&4294967295|I>>>22),I=S+(p^(C|~w))+_[10]+4293915773&4294967295,S=C+(I<<15&4294967295|I>>>17),I=w+(C^(S|~p))+_[1]+2240044497&4294967295,w=S+(I<<21&4294967295|I>>>11),I=p+(S^(w|~C))+_[8]+1873313359&4294967295,p=w+(I<<6&4294967295|I>>>26),I=C+(w^(p|~S))+_[15]+4264355552&4294967295,C=p+(I<<10&4294967295|I>>>22),I=S+(p^(C|~w))+_[6]+2734768916&4294967295,S=C+(I<<15&4294967295|I>>>17),I=w+(C^(S|~p))+_[13]+1309151649&4294967295,w=S+(I<<21&4294967295|I>>>11),I=p+(S^(w|~C))+_[4]+4149444226&4294967295,p=w+(I<<6&4294967295|I>>>26),I=C+(w^(p|~S))+_[11]+3174756917&4294967295,C=p+(I<<10&4294967295|I>>>22),I=S+(p^(C|~w))+_[2]+718787259&4294967295,S=C+(I<<15&4294967295|I>>>17),I=w+(C^(S|~p))+_[9]+3951481745&4294967295,T.g[0]=T.g[0]+p&4294967295,T.g[1]=T.g[1]+(S+(I<<21&4294967295|I>>>11))&4294967295,T.g[2]=T.g[2]+S&4294967295,T.g[3]=T.g[3]+C&4294967295}r.prototype.u=function(T,p){p===void 0&&(p=T.length);for(var w=p-this.blockSize,_=this.B,S=this.h,C=0;C<p;){if(S==0)for(;C<=w;)s(this,T,C),C+=this.blockSize;if(typeof T=="string"){for(;C<p;)if(_[S++]=T.charCodeAt(C++),S==this.blockSize){s(this,_),S=0;break}}else for(;C<p;)if(_[S++]=T[C++],S==this.blockSize){s(this,_),S=0;break}}this.h=S,this.o+=p},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var p=1;p<T.length-8;++p)T[p]=0;var w=8*this.o;for(p=T.length-8;p<T.length;++p)T[p]=w&255,w/=256;for(this.u(T),T=Array(16),p=w=0;4>p;++p)for(var _=0;32>_;_+=8)T[w++]=this.g[p]>>>_&255;return T};function i(T,p){var w=l;return Object.prototype.hasOwnProperty.call(w,T)?w[T]:w[T]=p(T)}function o(T,p){this.h=p;for(var w=[],_=!0,S=T.length-1;0<=S;S--){var C=T[S]|0;_&&C==p||(w[S]=C,_=!1)}this.g=w}var l={};function u(T){return-128<=T&&128>T?i(T,function(p){return new o([p|0],0>p?-1:0)}):new o([T|0],0>T?-1:0)}function d(T){if(isNaN(T)||!isFinite(T))return g;if(0>T)return k(d(-T));for(var p=[],w=1,_=0;T>=w;_++)p[_]=T/w|0,w*=4294967296;return new o(p,0)}function m(T,p){if(T.length==0)throw Error("number format error: empty string");if(p=p||10,2>p||36<p)throw Error("radix out of range: "+p);if(T.charAt(0)=="-")return k(m(T.substring(1),p));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=d(Math.pow(p,8)),_=g,S=0;S<T.length;S+=8){var C=Math.min(8,T.length-S),I=parseInt(T.substring(S,S+C),p);8>C?(C=d(Math.pow(p,C)),_=_.j(C).add(d(I))):(_=_.j(w),_=_.add(d(I)))}return _}var g=u(0),y=u(1),N=u(16777216);t=o.prototype,t.m=function(){if(j(this))return-k(this).m();for(var T=0,p=1,w=0;w<this.g.length;w++){var _=this.i(w);T+=(0<=_?_:4294967296+_)*p,p*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(R(this))return"0";if(j(this))return"-"+k(this).toString(T);for(var p=d(Math.pow(T,6)),w=this,_="";;){var S=P(w,p).g;w=E(w,S.j(p));var C=((0<w.g.length?w.g[0]:w.h)>>>0).toString(T);if(w=S,R(w))return C+_;for(;6>C.length;)C="0"+C;_=C+_}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function R(T){if(T.h!=0)return!1;for(var p=0;p<T.g.length;p++)if(T.g[p]!=0)return!1;return!0}function j(T){return T.h==-1}t.l=function(T){return T=E(this,T),j(T)?-1:R(T)?0:1};function k(T){for(var p=T.g.length,w=[],_=0;_<p;_++)w[_]=~T.g[_];return new o(w,~T.h).add(y)}t.abs=function(){return j(this)?k(this):this},t.add=function(T){for(var p=Math.max(this.g.length,T.g.length),w=[],_=0,S=0;S<=p;S++){var C=_+(this.i(S)&65535)+(T.i(S)&65535),I=(C>>>16)+(this.i(S)>>>16)+(T.i(S)>>>16);_=I>>>16,C&=65535,I&=65535,w[S]=I<<16|C}return new o(w,w[w.length-1]&-2147483648?-1:0)};function E(T,p){return T.add(k(p))}t.j=function(T){if(R(this)||R(T))return g;if(j(this))return j(T)?k(this).j(k(T)):k(k(this).j(T));if(j(T))return k(this.j(k(T)));if(0>this.l(N)&&0>T.l(N))return d(this.m()*T.m());for(var p=this.g.length+T.g.length,w=[],_=0;_<2*p;_++)w[_]=0;for(_=0;_<this.g.length;_++)for(var S=0;S<T.g.length;S++){var C=this.i(_)>>>16,I=this.i(_)&65535,ce=T.i(S)>>>16,Be=T.i(S)&65535;w[2*_+2*S]+=I*Be,v(w,2*_+2*S),w[2*_+2*S+1]+=C*Be,v(w,2*_+2*S+1),w[2*_+2*S+1]+=I*ce,v(w,2*_+2*S+1),w[2*_+2*S+2]+=C*ce,v(w,2*_+2*S+2)}for(_=0;_<p;_++)w[_]=w[2*_+1]<<16|w[2*_];for(_=p;_<2*p;_++)w[_]=0;return new o(w,0)};function v(T,p){for(;(T[p]&65535)!=T[p];)T[p+1]+=T[p]>>>16,T[p]&=65535,p++}function b(T,p){this.g=T,this.h=p}function P(T,p){if(R(p))throw Error("division by zero");if(R(T))return new b(g,g);if(j(T))return p=P(k(T),p),new b(k(p.g),k(p.h));if(j(p))return p=P(T,k(p)),new b(k(p.g),p.h);if(30<T.g.length){if(j(T)||j(p))throw Error("slowDivide_ only works with positive integers.");for(var w=y,_=p;0>=_.l(T);)w=L(w),_=L(_);var S=V(w,1),C=V(_,1);for(_=V(_,2),w=V(w,2);!R(_);){var I=C.add(_);0>=I.l(T)&&(S=S.add(w),C=I),_=V(_,1),w=V(w,1)}return p=E(T,S.j(p)),new b(S,p)}for(S=g;0<=T.l(p);){for(w=Math.max(1,Math.floor(T.m()/p.m())),_=Math.ceil(Math.log(w)/Math.LN2),_=48>=_?1:Math.pow(2,_-48),C=d(w),I=C.j(p);j(I)||0<I.l(T);)w-=_,C=d(w),I=C.j(p);R(C)&&(C=y),S=S.add(C),T=E(T,I)}return new b(S,T)}t.A=function(T){return P(this,T).h},t.and=function(T){for(var p=Math.max(this.g.length,T.g.length),w=[],_=0;_<p;_++)w[_]=this.i(_)&T.i(_);return new o(w,this.h&T.h)},t.or=function(T){for(var p=Math.max(this.g.length,T.g.length),w=[],_=0;_<p;_++)w[_]=this.i(_)|T.i(_);return new o(w,this.h|T.h)},t.xor=function(T){for(var p=Math.max(this.g.length,T.g.length),w=[],_=0;_<p;_++)w[_]=this.i(_)^T.i(_);return new o(w,this.h^T.h)};function L(T){for(var p=T.g.length+1,w=[],_=0;_<p;_++)w[_]=T.i(_)<<1|T.i(_-1)>>>31;return new o(w,T.h)}function V(T,p){var w=p>>5;p%=32;for(var _=T.g.length-w,S=[],C=0;C<_;C++)S[C]=0<p?T.i(C+w)>>>p|T.i(C+w+1)<<32-p:T.i(C+w);return new o(S,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,x_=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=m,bs=o}).apply(typeof kg<"u"?kg:typeof self<"u"?self:typeof window<"u"?window:{});var jl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var w_,Xo,E_,Jl,bh,T_,I_,b_;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,f){return a==Array.prototype||a==Object.prototype||(a[h]=f.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof jl=="object"&&jl];for(var h=0;h<a.length;++h){var f=a[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(a,h){if(h)e:{var f=r;a=a.split(".");for(var x=0;x<a.length-1;x++){var M=a[x];if(!(M in f))break e;f=f[M]}a=a[a.length-1],x=f[a],h=h(x),h!=x&&h!=null&&e(f,a,{configurable:!0,writable:!0,value:h})}}function i(a,h){a instanceof String&&(a+="");var f=0,x=!1,M={next:function(){if(!x&&f<a.length){var z=f++;return{value:h(z,a[z]),done:!1}}return x=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}s("Array.prototype.values",function(a){return a||function(){return i(this,function(h,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function d(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function m(a,h,f){return a.call.apply(a.bind,arguments)}function g(a,h,f){if(!a)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,x),a.apply(h,M)}}return function(){return a.apply(h,arguments)}}function y(a,h,f){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:g,y.apply(null,arguments)}function N(a,h){var f=Array.prototype.slice.call(arguments,1);return function(){var x=f.slice();return x.push.apply(x,arguments),a.apply(this,x)}}function R(a,h){function f(){}f.prototype=h.prototype,a.aa=h.prototype,a.prototype=new f,a.prototype.constructor=a,a.Qb=function(x,M,z){for(var ae=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)ae[ut-2]=arguments[ut];return h.prototype[M].apply(x,ae)}}function j(a){const h=a.length;if(0<h){const f=Array(h);for(let x=0;x<h;x++)f[x]=a[x];return f}return[]}function k(a,h){for(let f=1;f<arguments.length;f++){const x=arguments[f];if(u(x)){const M=a.length||0,z=x.length||0;a.length=M+z;for(let ae=0;ae<z;ae++)a[M+ae]=x[ae]}else a.push(x)}}class E{constructor(h,f){this.i=h,this.j=f,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function v(a){return/^[\s\xa0]*$/.test(a)}function b(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function P(a){return P[" "](a),a}P[" "]=function(){};var L=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function V(a,h,f){for(const x in a)h.call(f,a[x],x,a)}function T(a,h){for(const f in a)h.call(void 0,a[f],f,a)}function p(a){const h={};for(const f in a)h[f]=a[f];return h}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(a,h){let f,x;for(let M=1;M<arguments.length;M++){x=arguments[M];for(f in x)a[f]=x[f];for(let z=0;z<w.length;z++)f=w[z],Object.prototype.hasOwnProperty.call(x,f)&&(a[f]=x[f])}}function S(a){var h=1;a=a.split(":");const f=[];for(;0<h&&a.length;)f.push(a.shift()),h--;return a.length&&f.push(a.join(":")),f}function C(a){l.setTimeout(()=>{throw a},0)}function I(){var a=ne;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class ce{constructor(){this.h=this.g=null}add(h,f){const x=Be.get();x.set(h,f),this.h?this.h.next=x:this.g=x,this.h=x}}var Be=new E(()=>new q,a=>a.reset());class q{constructor(){this.next=this.g=this.h=null}set(h,f){this.h=h,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let X,W=!1,ne=new ce,$=()=>{const a=l.Promise.resolve(void 0);X=()=>{a.then(Y)}};var Y=()=>{for(var a;a=I();){try{a.h.call(a.g)}catch(f){C(f)}var h=Be;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}W=!1};function J(){this.s=this.s,this.C=this.C}J.prototype.s=!1,J.prototype.ma=function(){this.s||(this.s=!0,this.N())},J.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function oe(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}oe.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const f=()=>{};l.addEventListener("test",f,h),l.removeEventListener("test",f,h)}catch{}return a}();function Ue(a,h){if(oe.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var f=this.type=a.type,x=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(L){e:{try{P(h.nodeName);var M=!0;break e}catch{}M=!1}M||(h=null)}}else f=="mouseover"?h=a.fromElement:f=="mouseout"&&(h=a.toElement);this.relatedTarget=h,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:D[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Ue.aa.h.call(this)}}R(Ue,oe);var D={2:"touch",3:"pen",4:"mouse"};Ue.prototype.h=function(){Ue.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),ge=0;function xe(a,h,f,x,M){this.listener=a,this.proxy=null,this.src=h,this.type=f,this.capture=!!x,this.ha=M,this.key=++ge,this.da=this.fa=!1}function ve(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Te(a){this.src=a,this.g={},this.h=0}Te.prototype.add=function(a,h,f,x,M){var z=a.toString();a=this.g[z],a||(a=this.g[z]=[],this.h++);var ae=Pe(a,h,x,M);return-1<ae?(h=a[ae],f||(h.fa=!1)):(h=new xe(h,this.src,z,!!x,M),h.fa=f,a.push(h)),h};function Ne(a,h){var f=h.type;if(f in a.g){var x=a.g[f],M=Array.prototype.indexOf.call(x,h,void 0),z;(z=0<=M)&&Array.prototype.splice.call(x,M,1),z&&(ve(h),a.g[f].length==0&&(delete a.g[f],a.h--))}}function Pe(a,h,f,x){for(var M=0;M<a.length;++M){var z=a[M];if(!z.da&&z.listener==h&&z.capture==!!f&&z.ha==x)return M}return-1}var _e="closure_lm_"+(1e6*Math.random()|0),Ie={};function Oe(a,h,f,x,M){if(Array.isArray(h)){for(var z=0;z<h.length;z++)Oe(a,h[z],f,x,M);return null}return f=O(f),a&&a[de]?a.K(h,f,d(x)?!!x.capture:!1,M):Ge(a,h,f,!1,x,M)}function Ge(a,h,f,x,M,z){if(!h)throw Error("Invalid event type");var ae=d(M)?!!M.capture:!!M,ut=be(a);if(ut||(a[_e]=ut=new Te(a)),f=ut.add(h,f,x,ae,z),f.proxy)return f;if(x=De(),f.proxy=x,x.src=a,x.listener=f,a.addEventListener)K||(M=ae),M===void 0&&(M=!1),a.addEventListener(h.toString(),x,M);else if(a.attachEvent)a.attachEvent(_t(h.toString()),x);else if(a.addListener&&a.removeListener)a.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return f}function De(){function a(f){return h.call(a.src,a.listener,f)}const h=bt;return a}function at(a,h,f,x,M){if(Array.isArray(h))for(var z=0;z<h.length;z++)at(a,h[z],f,x,M);else x=d(x)?!!x.capture:!!x,f=O(f),a&&a[de]?(a=a.i,h=String(h).toString(),h in a.g&&(z=a.g[h],f=Pe(z,f,x,M),-1<f&&(ve(z[f]),Array.prototype.splice.call(z,f,1),z.length==0&&(delete a.g[h],a.h--)))):a&&(a=be(a))&&(h=a.g[h.toString()],a=-1,h&&(a=Pe(h,f,x,M)),(f=-1<a?h[a]:null)&&Ke(f))}function Ke(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[de])Ne(h.i,a);else{var f=a.type,x=a.proxy;h.removeEventListener?h.removeEventListener(f,x,a.capture):h.detachEvent?h.detachEvent(_t(f),x):h.addListener&&h.removeListener&&h.removeListener(x),(f=be(h))?(Ne(f,a),f.h==0&&(f.src=null,h[_e]=null)):ve(a)}}}function _t(a){return a in Ie?Ie[a]:Ie[a]="on"+a}function bt(a,h){if(a.da)a=!0;else{h=new Ue(h,this);var f=a.listener,x=a.ha||a.src;a.fa&&Ke(a),a=f.call(x,h)}return a}function be(a){return a=a[_e],a instanceof Te?a:null}var nt="__closure_events_fn_"+(1e9*Math.random()>>>0);function O(a){return typeof a=="function"?a:(a[nt]||(a[nt]=function(h){return a.handleEvent(h)}),a[nt])}function G(){J.call(this),this.i=new Te(this),this.M=this,this.F=null}R(G,J),G.prototype[de]=!0,G.prototype.removeEventListener=function(a,h,f,x){at(this,a,h,f,x)};function Q(a,h){var f,x=a.F;if(x)for(f=[];x;x=x.F)f.push(x);if(a=a.M,x=h.type||h,typeof h=="string")h=new oe(h,a);else if(h instanceof oe)h.target=h.target||a;else{var M=h;h=new oe(x,a),_(h,M)}if(M=!0,f)for(var z=f.length-1;0<=z;z--){var ae=h.g=f[z];M=he(ae,x,!0,h)&&M}if(ae=h.g=a,M=he(ae,x,!0,h)&&M,M=he(ae,x,!1,h)&&M,f)for(z=0;z<f.length;z++)ae=h.g=f[z],M=he(ae,x,!1,h)&&M}G.prototype.N=function(){if(G.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var f=a.g[h],x=0;x<f.length;x++)ve(f[x]);delete a.g[h],a.h--}}this.F=null},G.prototype.K=function(a,h,f,x){return this.i.add(String(a),h,!1,f,x)},G.prototype.L=function(a,h,f,x){return this.i.add(String(a),h,!0,f,x)};function he(a,h,f,x){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var M=!0,z=0;z<h.length;++z){var ae=h[z];if(ae&&!ae.da&&ae.capture==f){var ut=ae.listener,zt=ae.ha||ae.src;ae.fa&&Ne(a.i,ae),M=ut.call(zt,x)!==!1&&M}}return M&&!x.defaultPrevented}function ke(a,h,f){if(typeof a=="function")f&&(a=y(a,f));else if(a&&typeof a.handleEvent=="function")a=y(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:l.setTimeout(a,h||0)}function Ve(a){a.g=ke(()=>{a.g=null,a.i&&(a.i=!1,Ve(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class Ce extends J{constructor(h,f){super(),this.m=h,this.l=f,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Ve(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qe(a){J.call(this),this.h=a,this.g={}}R(Qe,J);var an=[];function mn(a){V(a.g,function(h,f){this.g.hasOwnProperty(f)&&Ke(h)},a),a.g={}}Qe.prototype.N=function(){Qe.aa.N.call(this),mn(this)},Qe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ln=l.JSON.stringify,Kr=l.JSON.parse,_i=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function Qr(){}Qr.prototype.h=null;function Us(a){return a.h||(a.h=a.i())}function Bs(){}var Hn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Yr(){oe.call(this,"d")}R(Yr,oe);function jn(){oe.call(this,"c")}R(jn,oe);var Dn={},Pt=null;function Vn(){return Pt=Pt||new G}Dn.La="serverreachability";function Er(a){oe.call(this,Dn.La,a)}R(Er,oe);function Mn(a){const h=Vn();Q(h,new Er(h))}Dn.STAT_EVENT="statevent";function Tr(a,h){oe.call(this,Dn.STAT_EVENT,a),this.stat=h}R(Tr,oe);function yt(a){const h=Vn();Q(h,new Tr(h,a))}Dn.Ma="timingevent";function In(a,h){oe.call(this,Dn.Ma,a),this.size=h}R(In,oe);function Ln(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},h)}function Xr(){this.g=!0}Xr.prototype.xa=function(){this.g=!1};function xi(a,h,f,x,M,z){a.info(function(){if(a.g)if(z)for(var ae="",ut=z.split("&"),zt=0;zt<ut.length;zt++){var Ze=ut[zt].split("=");if(1<Ze.length){var Yt=Ze[0];Ze=Ze[1];var Xt=Yt.split("_");ae=2<=Xt.length&&Xt[1]=="type"?ae+(Yt+"="+Ze+"&"):ae+(Yt+"=redacted&")}}else ae=null;else ae=z;return"XMLHTTP REQ ("+x+") [attempt "+M+"]: "+h+`
`+f+`
`+ae})}function wi(a,h,f,x,M,z,ae){a.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+M+"]: "+h+`
`+f+`
`+z+" "+ae})}function qn(a,h,f,x){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+il(a,f)+(x?" "+x:"")})}function Vu(a,h){a.info(function(){return"TIMEOUT: "+h})}Xr.prototype.info=function(){};function il(a,h){if(!a.g)return h;if(!h)return null;try{var f=JSON.parse(h);if(f){for(a=0;a<f.length;a++)if(Array.isArray(f[a])){var x=f[a];if(!(2>x.length)){var M=x[1];if(Array.isArray(M)&&!(1>M.length)){var z=M[0];if(z!="noop"&&z!="stop"&&z!="close")for(var ae=1;ae<M.length;ae++)M[ae]=""}}}}return ln(f)}catch{return h}}var Jr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ir={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ao;function Ei(){}R(Ei,Qr),Ei.prototype.g=function(){return new XMLHttpRequest},Ei.prototype.i=function(){return{}},Ao=new Ei;function ar(a,h,f,x){this.j=a,this.i=h,this.l=f,this.R=x||1,this.U=new Qe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ol}function ol(){this.i=null,this.g="",this.h=!1}var al={},ko={};function Po(a,h,f){a.L=1,a.v=Ti(lt(h)),a.m=f,a.P=!0,Ro(a,null)}function Ro(a,h){a.F=Date.now(),H(a),a.A=lt(a.v);var f=a.A,x=a.R;Array.isArray(x)||(x=[String(x)]),$m(f.i,"t",x),a.C=0,f=a.j.J,a.h=new ol,a.g=op(a.j,f?h:null,!a.m),0<a.O&&(a.M=new Ce(y(a.Y,a,a.g),a.O)),h=a.U,f=a.g,x=a.ca;var M="readystatechange";Array.isArray(M)||(M&&(an[0]=M.toString()),M=an);for(var z=0;z<M.length;z++){var ae=Oe(f,M[z],x||h.handleEvent,!1,h.h||h);if(!ae)break;h.g[ae.key]=ae}h=a.H?p(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),Mn(),xi(a.i,a.u,a.A,a.l,a.R,a.m)}ar.prototype.ca=function(a){a=a.target;const h=this.M;h&&br(a)==3?h.j():this.Y(a)},ar.prototype.Y=function(a){try{if(a==this.g)e:{const Xt=br(this.g);var h=this.g.Ba();const Si=this.g.Z();if(!(3>Xt)&&(Xt!=3||this.g&&(this.h.h||this.g.oa()||Qm(this.g)))){this.J||Xt!=4||h==7||(h==8||0>=Si?Mn(3):Mn(2)),te(this);var f=this.g.Z();this.X=f;t:if(A(this)){var x=Qm(this.g);a="";var M=x.length,z=br(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ie(this),se(this);var ae="";break t}this.h.i=new l.TextDecoder}for(h=0;h<M;h++)this.h.h=!0,a+=this.h.i.decode(x[h],{stream:!(z&&h==M-1)});x.length=0,this.h.g+=a,this.C=0,ae=this.h.g}else ae=this.g.oa();if(this.o=f==200,wi(this.i,this.u,this.A,this.l,this.R,Xt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var ut,zt=this.g;if((ut=zt.g?zt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(ut)){var Ze=ut;break t}}Ze=null}if(f=Ze)qn(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,le(this,f);else{this.o=!1,this.s=3,yt(12),ie(this),se(this);break e}}if(this.P){f=!0;let Gn;for(;!this.J&&this.C<ae.length;)if(Gn=B(this,ae),Gn==ko){Xt==4&&(this.s=4,yt(14),f=!1),qn(this.i,this.l,null,"[Incomplete Response]");break}else if(Gn==al){this.s=4,yt(15),qn(this.i,this.l,ae,"[Invalid Chunk]"),f=!1;break}else qn(this.i,this.l,Gn,null),le(this,Gn);if(A(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Xt!=4||ae.length!=0||this.h.h||(this.s=1,yt(16),f=!1),this.o=this.o&&f,!f)qn(this.i,this.l,ae,"[Invalid Chunked Response]"),ie(this),se(this);else if(0<ae.length&&!this.W){this.W=!0;var Yt=this.j;Yt.g==this&&Yt.ba&&!Yt.M&&(Yt.j.info("Great, no buffering proxy detected. Bytes received: "+ae.length),Uu(Yt),Yt.M=!0,yt(11))}}else qn(this.i,this.l,ae,null),le(this,ae);Xt==4&&ie(this),this.o&&!this.J&&(Xt==4?np(this.j,this):(this.o=!1,H(this)))}else Xw(this.g),f==400&&0<ae.indexOf("Unknown SID")?(this.s=3,yt(12)):(this.s=0,yt(13)),ie(this),se(this)}}}catch{}finally{}};function A(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function B(a,h){var f=a.C,x=h.indexOf(`
`,f);return x==-1?ko:(f=Number(h.substring(f,x)),isNaN(f)?al:(x+=1,x+f>h.length?ko:(h=h.slice(x,x+f),a.C=x+f,h)))}ar.prototype.cancel=function(){this.J=!0,ie(this)};function H(a){a.S=Date.now()+a.I,F(a,a.I)}function F(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Ln(y(a.ba,a),h)}function te(a){a.B&&(l.clearTimeout(a.B),a.B=null)}ar.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(Vu(this.i,this.A),this.L!=2&&(Mn(),yt(17)),ie(this),this.s=2,se(this)):F(this,this.S-a)};function se(a){a.j.G==0||a.J||np(a.j,a)}function ie(a){te(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,mn(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function le(a,h){try{var f=a.j;if(f.G!=0&&(f.g==a||we(f.h,a))){if(!a.K&&we(f.h,a)&&f.G==3){try{var x=f.Da.g.parse(h)}catch{x=null}if(Array.isArray(x)&&x.length==3){var M=x;if(M[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<a.F)fl(f),dl(f);else break e;Fu(f),yt(18)}}else f.za=M[1],0<f.za-f.T&&37500>M[2]&&f.F&&f.v==0&&!f.C&&(f.C=Ln(y(f.Za,f),6e3));if(1>=Se(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Ws(f,11)}else if((a.K||f.g==a)&&fl(f),!v(h))for(M=f.Da.g.parse(h),h=0;h<M.length;h++){let Ze=M[h];if(f.T=Ze[0],Ze=Ze[1],f.G==2)if(Ze[0]=="c"){f.K=Ze[1],f.ia=Ze[2];const Yt=Ze[3];Yt!=null&&(f.la=Yt,f.j.info("VER="+f.la));const Xt=Ze[4];Xt!=null&&(f.Aa=Xt,f.j.info("SVER="+f.Aa));const Si=Ze[5];Si!=null&&typeof Si=="number"&&0<Si&&(x=1.5*Si,f.L=x,f.j.info("backChannelRequestTimeoutMs_="+x)),x=f;const Gn=a.g;if(Gn){const pl=Gn.g?Gn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pl){var z=x.h;z.g||pl.indexOf("spdy")==-1&&pl.indexOf("quic")==-1&&pl.indexOf("h2")==-1||(z.j=z.l,z.g=new Set,z.h&&(xt(z,z.h),z.h=null))}if(x.D){const Bu=Gn.g?Gn.g.getResponseHeader("X-HTTP-Session-Id"):null;Bu&&(x.ya=Bu,ct(x.I,x.D,Bu))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-a.F,f.j.info("Handshake RTT: "+f.R+"ms")),x=f;var ae=a;if(x.qa=ip(x,x.J?x.ia:null,x.W),ae.K){Xe(x.h,ae);var ut=ae,zt=x.L;zt&&(ut.I=zt),ut.B&&(te(ut),H(ut)),x.g=ae}else ep(x);0<f.i.length&&hl(f)}else Ze[0]!="stop"&&Ze[0]!="close"||Ws(f,7);else f.G==3&&(Ze[0]=="stop"||Ze[0]=="close"?Ze[0]=="stop"?Ws(f,7):Ou(f):Ze[0]!="noop"&&f.l&&f.l.ta(Ze),f.v=0)}}Mn(4)}catch{}}var ue=class{constructor(a,h){this.g=a,this.map=h}};function ye(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ae(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Se(a){return a.h?1:a.g?a.g.size:0}function we(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function xt(a,h){a.g?a.g.add(h):a.h=h}function Xe(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}ye.prototype.cancel=function(){if(this.i=dt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function dt(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const f of a.g.values())h=h.concat(f.D);return h}return j(a.i)}function $t(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var h=[],f=a.length,x=0;x<f;x++)h.push(a[x]);return h}h=[],f=0;for(x in a)h[f++]=a[x];return h}function Fe(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var h=[];a=a.length;for(var f=0;f<a;f++)h.push(f);return h}h=[],f=0;for(const x in a)h[f++]=x;return h}}}function ft(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var f=Fe(a),x=$t(a),M=x.length,z=0;z<M;z++)h.call(void 0,x[z],f&&f[z],a)}var pn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function St(a,h){if(a){a=a.split("&");for(var f=0;f<a.length;f++){var x=a[f].indexOf("="),M=null;if(0<=x){var z=a[f].substring(0,x);M=a[f].substring(x+1)}else z=a[f];h(z,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function it(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof it){this.h=a.h,Zr(this,a.j),this.o=a.o,this.g=a.g,jo(this,a.s),this.l=a.l;var h=a.i,f=new Do;f.i=h.i,h.g&&(f.g=new Map(h.g),f.h=h.h),Mu(this,f),this.m=a.m}else a&&(h=String(a).match(pn))?(this.h=!1,Zr(this,h[1]||"",!0),this.o=$s(h[2]||""),this.g=$s(h[3]||"",!0),jo(this,h[4]),this.l=$s(h[5]||"",!0),Mu(this,h[6]||"",!0),this.m=$s(h[7]||"")):(this.h=!1,this.i=new Do(null,this.h))}it.prototype.toString=function(){var a=[],h=this.j;h&&a.push(zs(h,Fm,!0),":");var f=this.g;return(f||h=="file")&&(a.push("//"),(h=this.o)&&a.push(zs(h,Fm,!0),"@"),a.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&a.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&a.push("/"),a.push(zs(f,f.charAt(0)=="/"?Bw:Uw,!0))),(f=this.i.toString())&&a.push("?",f),(f=this.m)&&a.push("#",zs(f,zw)),a.join("")};function lt(a){return new it(a)}function Zr(a,h,f){a.j=f?$s(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function jo(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function Mu(a,h,f){h instanceof Do?(a.i=h,Ww(a.i,a.h)):(f||(h=zs(h,$w)),a.i=new Do(h,a.h))}function ct(a,h,f){a.i.set(h,f)}function Ti(a){return ct(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function $s(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function zs(a,h,f){return typeof a=="string"?(a=encodeURI(a).replace(h,Fw),f&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Fw(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Fm=/[#\/\?@]/g,Uw=/[#\?:]/g,Bw=/[#\?]/g,$w=/[#\?@]/g,zw=/#/g;function Do(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function es(a){a.g||(a.g=new Map,a.h=0,a.i&&St(a.i,function(h,f){a.add(decodeURIComponent(h.replace(/\+/g," ")),f)}))}t=Do.prototype,t.add=function(a,h){es(this),this.i=null,a=Ii(this,a);var f=this.g.get(a);return f||this.g.set(a,f=[]),f.push(h),this.h+=1,this};function Um(a,h){es(a),h=Ii(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function Bm(a,h){return es(a),h=Ii(a,h),a.g.has(h)}t.forEach=function(a,h){es(this),this.g.forEach(function(f,x){f.forEach(function(M){a.call(h,M,x,this)},this)},this)},t.na=function(){es(this);const a=Array.from(this.g.values()),h=Array.from(this.g.keys()),f=[];for(let x=0;x<h.length;x++){const M=a[x];for(let z=0;z<M.length;z++)f.push(h[x])}return f},t.V=function(a){es(this);let h=[];if(typeof a=="string")Bm(this,a)&&(h=h.concat(this.g.get(Ii(this,a))));else{a=Array.from(this.g.values());for(let f=0;f<a.length;f++)h=h.concat(a[f])}return h},t.set=function(a,h){return es(this),this.i=null,a=Ii(this,a),Bm(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function $m(a,h,f){Um(a,h),0<f.length&&(a.i=null,a.g.set(Ii(a,h),j(f)),a.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(var f=0;f<h.length;f++){var x=h[f];const z=encodeURIComponent(String(x)),ae=this.V(x);for(x=0;x<ae.length;x++){var M=z;ae[x]!==""&&(M+="="+encodeURIComponent(String(ae[x]))),a.push(M)}}return this.i=a.join("&")};function Ii(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function Ww(a,h){h&&!a.j&&(es(a),a.i=null,a.g.forEach(function(f,x){var M=x.toLowerCase();x!=M&&(Um(this,x),$m(this,M,f))},a)),a.j=h}function Hw(a,h){const f=new Xr;if(l.Image){const x=new Image;x.onload=N(ts,f,"TestLoadImage: loaded",!0,h,x),x.onerror=N(ts,f,"TestLoadImage: error",!1,h,x),x.onabort=N(ts,f,"TestLoadImage: abort",!1,h,x),x.ontimeout=N(ts,f,"TestLoadImage: timeout",!1,h,x),l.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=a}else h(!1)}function qw(a,h){const f=new Xr,x=new AbortController,M=setTimeout(()=>{x.abort(),ts(f,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:x.signal}).then(z=>{clearTimeout(M),z.ok?ts(f,"TestPingServer: ok",!0,h):ts(f,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(M),ts(f,"TestPingServer: error",!1,h)})}function ts(a,h,f,x,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),x(f)}catch{}}function Gw(){this.g=new _i}function Kw(a,h,f){const x=f||"";try{ft(a,function(M,z){let ae=M;d(M)&&(ae=ln(M)),h.push(x+z+"="+encodeURIComponent(ae))})}catch(M){throw h.push(x+"type="+encodeURIComponent("_badmap")),M}}function ll(a){this.l=a.Ub||null,this.j=a.eb||!1}R(ll,Qr),ll.prototype.g=function(){return new cl(this.l,this.j)},ll.prototype.i=function(a){return function(){return a}}({});function cl(a,h){G.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(cl,G),t=cl.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,Mo(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||l).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Vo(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Mo(this)),this.g&&(this.readyState=3,Mo(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;zm(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function zm(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Vo(this):Mo(this),this.readyState==3&&zm(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Vo(this))},t.Qa=function(a){this.g&&(this.response=a,Vo(this))},t.ga=function(){this.g&&Vo(this)};function Vo(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Mo(a)}t.setRequestHeader=function(a,h){this.u.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var f=h.next();!f.done;)f=f.value,a.push(f[0]+": "+f[1]),f=h.next();return a.join(`\r
`)};function Mo(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(cl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Wm(a){let h="";return V(a,function(f,x){h+=x,h+=":",h+=f,h+=`\r
`}),h}function Lu(a,h,f){e:{for(x in f){var x=!1;break e}x=!0}x||(f=Wm(f),typeof a=="string"?f!=null&&encodeURIComponent(String(f)):ct(a,h,f))}function Nt(a){G.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(Nt,G);var Qw=/^https?$/i,Yw=["POST","PUT"];t=Nt.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,h,f,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ao.g(),this.v=this.o?Us(this.o):Us(Ao),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(z){Hm(this,z);return}if(a=f||"",f=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var M in x)f.set(M,x[M]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const z of x.keys())f.set(z,x.get(z));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(f.keys()).find(z=>z.toLowerCase()=="content-type"),M=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Yw,h,void 0))||x||M||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[z,ae]of f)this.g.setRequestHeader(z,ae);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Km(this),this.u=!0,this.g.send(a),this.u=!1}catch(z){Hm(this,z)}};function Hm(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,qm(a),ul(a)}function qm(a){a.A||(a.A=!0,Q(a,"complete"),Q(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Q(this,"complete"),Q(this,"abort"),ul(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ul(this,!0)),Nt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Gm(this):this.bb())},t.bb=function(){Gm(this)};function Gm(a){if(a.h&&typeof o<"u"&&(!a.v[1]||br(a)!=4||a.Z()!=2)){if(a.u&&br(a)==4)ke(a.Ea,0,a);else if(Q(a,"readystatechange"),br(a)==4){a.h=!1;try{const ae=a.Z();e:switch(ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var f;if(!(f=h)){var x;if(x=ae===0){var M=String(a.D).match(pn)[1]||null;!M&&l.self&&l.self.location&&(M=l.self.location.protocol.slice(0,-1)),x=!Qw.test(M?M.toLowerCase():"")}f=x}if(f)Q(a,"complete"),Q(a,"success");else{a.m=6;try{var z=2<br(a)?a.g.statusText:""}catch{z=""}a.l=z+" ["+a.Z()+"]",qm(a)}}finally{ul(a)}}}}function ul(a,h){if(a.g){Km(a);const f=a.g,x=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||Q(a,"ready");try{f.onreadystatechange=x}catch{}}}function Km(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function br(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<br(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),Kr(h)}};function Qm(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Xw(a){const h={};a=(a.g&&2<=br(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<a.length;x++){if(v(a[x]))continue;var f=S(a[x]);const M=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const z=h[M]||[];h[M]=z,z.push(f)}T(h,function(x){return x.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Lo(a,h,f){return f&&f.internalChannelParams&&f.internalChannelParams[a]||h}function Ym(a){this.Aa=0,this.i=[],this.j=new Xr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Lo("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Lo("baseRetryDelayMs",5e3,a),this.cb=Lo("retryDelaySeedMs",1e4,a),this.Wa=Lo("forwardChannelMaxRetries",2,a),this.wa=Lo("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new ye(a&&a.concurrentRequestLimit),this.Da=new Gw,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ym.prototype,t.la=8,t.G=1,t.connect=function(a,h,f,x){yt(0),this.W=a,this.H=h||{},f&&x!==void 0&&(this.H.OSID=f,this.H.OAID=x),this.F=this.X,this.I=ip(this,null,this.W),hl(this)};function Ou(a){if(Xm(a),a.G==3){var h=a.U++,f=lt(a.I);if(ct(f,"SID",a.K),ct(f,"RID",h),ct(f,"TYPE","terminate"),Oo(a,f),h=new ar(a,a.j,h),h.L=2,h.v=Ti(lt(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(h.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=h.v,f=!0),f||(h.g=op(h.j,null),h.g.ea(h.v)),h.F=Date.now(),H(h)}sp(a)}function dl(a){a.g&&(Uu(a),a.g.cancel(),a.g=null)}function Xm(a){dl(a),a.u&&(l.clearTimeout(a.u),a.u=null),fl(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function hl(a){if(!Ae(a.h)&&!a.s){a.s=!0;var h=a.Ga;X||$(),W||(X(),W=!0),ne.add(h,a),a.B=0}}function Jw(a,h){return Se(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Ln(y(a.Ga,a,h),rp(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const M=new ar(this,this.j,a);let z=this.o;if(this.S&&(z?(z=p(z),_(z,this.S)):z=this.S),this.m!==null||this.O||(M.H=z,z=null),this.P)e:{for(var h=0,f=0;f<this.i.length;f++){t:{var x=this.i[f];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(h+=x,4096<h){h=f;break e}if(h===4096||f===this.i.length-1){h=f+1;break e}}h=1e3}else h=1e3;h=Zm(this,M,h),f=lt(this.I),ct(f,"RID",a),ct(f,"CVER",22),this.D&&ct(f,"X-HTTP-Session-Id",this.D),Oo(this,f),z&&(this.O?h="headers="+encodeURIComponent(String(Wm(z)))+"&"+h:this.m&&Lu(f,this.m,z)),xt(this.h,M),this.Ua&&ct(f,"TYPE","init"),this.P?(ct(f,"$req",h),ct(f,"SID","null"),M.T=!0,Po(M,f,null)):Po(M,f,h),this.G=2}}else this.G==3&&(a?Jm(this,a):this.i.length==0||Ae(this.h)||Jm(this))};function Jm(a,h){var f;h?f=h.l:f=a.U++;const x=lt(a.I);ct(x,"SID",a.K),ct(x,"RID",f),ct(x,"AID",a.T),Oo(a,x),a.m&&a.o&&Lu(x,a.m,a.o),f=new ar(a,a.j,f,a.B+1),a.m===null&&(f.H=a.o),h&&(a.i=h.D.concat(a.i)),h=Zm(a,f,1e3),f.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),xt(a.h,f),Po(f,x,h)}function Oo(a,h){a.H&&V(a.H,function(f,x){ct(h,x,f)}),a.l&&ft({},function(f,x){ct(h,x,f)})}function Zm(a,h,f){f=Math.min(a.i.length,f);var x=a.l?y(a.l.Na,a.l,a):null;e:{var M=a.i;let z=-1;for(;;){const ae=["count="+f];z==-1?0<f?(z=M[0].g,ae.push("ofs="+z)):z=0:ae.push("ofs="+z);let ut=!0;for(let zt=0;zt<f;zt++){let Ze=M[zt].g;const Yt=M[zt].map;if(Ze-=z,0>Ze)z=Math.max(0,M[zt].g-100),ut=!1;else try{Kw(Yt,ae,"req"+Ze+"_")}catch{x&&x(Yt)}}if(ut){x=ae.join("&");break e}}}return a=a.i.splice(0,f),h.D=a,x}function ep(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;X||$(),W||(X(),W=!0),ne.add(h,a),a.v=0}}function Fu(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Ln(y(a.Fa,a),rp(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,tp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Ln(y(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yt(10),dl(this),tp(this))};function Uu(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function tp(a){a.g=new ar(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=lt(a.qa);ct(h,"RID","rpc"),ct(h,"SID",a.K),ct(h,"AID",a.T),ct(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&ct(h,"TO",a.ja),ct(h,"TYPE","xmlhttp"),Oo(a,h),a.m&&a.o&&Lu(h,a.m,a.o),a.L&&(a.g.I=a.L);var f=a.g;a=a.ia,f.L=1,f.v=Ti(lt(h)),f.m=null,f.P=!0,Ro(f,a)}t.Za=function(){this.C!=null&&(this.C=null,dl(this),Fu(this),yt(19))};function fl(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function np(a,h){var f=null;if(a.g==h){fl(a),Uu(a),a.g=null;var x=2}else if(we(a.h,h))f=h.D,Xe(a.h,h),x=1;else return;if(a.G!=0){if(h.o)if(x==1){f=h.m?h.m.length:0,h=Date.now()-h.F;var M=a.B;x=Vn(),Q(x,new In(x,f)),hl(a)}else ep(a);else if(M=h.s,M==3||M==0&&0<h.X||!(x==1&&Jw(a,h)||x==2&&Fu(a)))switch(f&&0<f.length&&(h=a.h,h.i=h.i.concat(f)),M){case 1:Ws(a,5);break;case 4:Ws(a,10);break;case 3:Ws(a,6);break;default:Ws(a,2)}}}function rp(a,h){let f=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(f*=2),f*h}function Ws(a,h){if(a.j.info("Error code "+h),h==2){var f=y(a.fb,a),x=a.Xa;const M=!x;x=new it(x||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Zr(x,"https"),Ti(x),M?Hw(x.toString(),f):qw(x.toString(),f)}else yt(2);a.G=0,a.l&&a.l.sa(h),sp(a),Xm(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function sp(a){if(a.G=0,a.ka=[],a.l){const h=dt(a.h);(h.length!=0||a.i.length!=0)&&(k(a.ka,h),k(a.ka,a.i),a.h.i.length=0,j(a.i),a.i.length=0),a.l.ra()}}function ip(a,h,f){var x=f instanceof it?lt(f):new it(f);if(x.g!="")h&&(x.g=h+"."+x.g),jo(x,x.s);else{var M=l.location;x=M.protocol,h=h?h+"."+M.hostname:M.hostname,M=+M.port;var z=new it(null);x&&Zr(z,x),h&&(z.g=h),M&&jo(z,M),f&&(z.l=f),x=z}return f=a.D,h=a.ya,f&&h&&ct(x,f,h),ct(x,"VER",a.la),Oo(a,x),x}function op(a,h,f){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new Nt(new ll({eb:f})):new Nt(a.pa),h.Ha(a.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ap(){}t=ap.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ml(){}ml.prototype.g=function(a,h){return new bn(a,h)};function bn(a,h){G.call(this),this.g=new Ym(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!v(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!v(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new bi(this)}R(bn,G),bn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},bn.prototype.close=function(){Ou(this.g)},bn.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var f={};f.__data__=a,a=f}else this.u&&(f={},f.__data__=ln(a),a=f);h.i.push(new ue(h.Ya++,a)),h.G==3&&hl(h)},bn.prototype.N=function(){this.g.l=null,delete this.j,Ou(this.g),delete this.g,bn.aa.N.call(this)};function lp(a){Yr.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const f in h){a=f;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}R(lp,Yr);function cp(){jn.call(this),this.status=1}R(cp,jn);function bi(a){this.g=a}R(bi,ap),bi.prototype.ua=function(){Q(this.g,"a")},bi.prototype.ta=function(a){Q(this.g,new lp(a))},bi.prototype.sa=function(a){Q(this.g,new cp)},bi.prototype.ra=function(){Q(this.g,"b")},ml.prototype.createWebChannel=ml.prototype.g,bn.prototype.send=bn.prototype.o,bn.prototype.open=bn.prototype.m,bn.prototype.close=bn.prototype.close,b_=function(){return new ml},I_=function(){return Vn()},T_=Dn,bh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Jr.NO_ERROR=0,Jr.TIMEOUT=8,Jr.HTTP_ERROR=6,Jl=Jr,Ir.COMPLETE="complete",E_=Ir,Bs.EventType=Hn,Hn.OPEN="a",Hn.CLOSE="b",Hn.ERROR="c",Hn.MESSAGE="d",G.prototype.listen=G.prototype.K,Xo=Bs,Nt.prototype.listenOnce=Nt.prototype.L,Nt.prototype.getLastError=Nt.prototype.Ka,Nt.prototype.getLastErrorCode=Nt.prototype.Ba,Nt.prototype.getStatus=Nt.prototype.Z,Nt.prototype.getResponseJson=Nt.prototype.Oa,Nt.prototype.getResponseText=Nt.prototype.oa,Nt.prototype.send=Nt.prototype.ea,Nt.prototype.setWithCredentials=Nt.prototype.Ha,w_=Nt}).apply(typeof jl<"u"?jl:typeof self<"u"?self:typeof window<"u"?window:{});const Pg="@firebase/firestore",Rg="4.7.10";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}tn.UNAUTHENTICATED=new tn(null),tn.GOOGLE_CREDENTIALS=new tn("google-credentials-uid"),tn.FIRST_PARTY=new tn("first-party-uid"),tn.MOCK_USER=new tn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let To="11.5.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci=new Bf("@firebase/firestore");function Ci(){return ci.logLevel}function fe(t,...e){if(ci.logLevel<=He.DEBUG){const n=e.map(Wf);ci.debug(`Firestore (${To}): ${t}`,...n)}}function zr(t,...e){if(ci.logLevel<=He.ERROR){const n=e.map(Wf);ci.error(`Firestore (${To}): ${t}`,...n)}}function uo(t,...e){if(ci.logLevel<=He.WARN){const n=e.map(Wf);ci.warn(`Firestore (${To}): ${t}`,...n)}}function Wf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Re(t="Unexpected state"){const e=`FIRESTORE (${To}) INTERNAL ASSERTION FAILED: `+t;throw zr(e),new Error(e)}function st(t,e){t||Re()}function Le(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends Gr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ab{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(tn.UNAUTHENTICATED))}shutdown(){}}class lb{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class cb{constructor(e){this.t=e,this.currentUser=tn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){st(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Lr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Lr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Lr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(st(typeof r.accessToken=="string"),new S_(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return st(e===null||typeof e=="string"),new tn(e)}}class ub{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=tn.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class db{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new ub(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(tn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class jg{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class hb{constructor(e,n){this.A=n,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,Zn(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,n){st(this.o===void 0);const r=i=>{i.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,fe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new jg(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(st(typeof n.token=="string"),this.R=n.token,new jg(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N_(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=fb(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function $e(t,e){return t<e?-1:t>e?1:0}function Sh(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return $e(r,s);{const i=N_(),o=mb(i.encode(Dg(t,n)),i.encode(Dg(e,n)));return o!==0?o:$e(r,s)}}n+=r>65535?2:1}return $e(t.length,e.length)}function Dg(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function mb(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return $e(t[n],e[n]);return $e(t.length,e.length)}function ho(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vg=-62135596800,Mg=1e6;class Lt{static now(){return Lt.fromMillis(Date.now())}static fromDate(e){return Lt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*Mg);return new Lt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new me(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new me(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Vg)throw new me(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Mg}_compareTo(e){return this.seconds===e.seconds?$e(this.nanoseconds,e.nanoseconds):$e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-Vg;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{static fromTimestamp(e){return new Me(e)}static min(){return new Me(new Lt(0,0))}static max(){return new Me(new Lt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lg="__name__";class hr{constructor(e,n,r){n===void 0?n=0:n>e.length&&Re(),r===void 0?r=e.length-n:r>e.length-n&&Re(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return hr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof hr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=hr.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return $e(e.length,n.length)}static compareSegments(e,n){const r=hr.isNumericId(e),s=hr.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?hr.extractNumericId(e).compare(hr.extractNumericId(n)):Sh(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return bs.fromString(e.substring(4,e.length-2))}}class pt extends hr{construct(e,n,r){return new pt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new me(Z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new pt(n)}static emptyPath(){return new pt([])}}const pb=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qt extends hr{construct(e,n,r){return new qt(e,n,r)}static isValidIdentifier(e){return pb.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Lg}static keyField(){return new qt([Lg])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new me(Z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new me(Z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new me(Z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new me(Z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qt(n)}static emptyPath(){return new qt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(pt.fromString(e))}static fromName(e){return new Ee(pt.fromString(e).popFirst(5))}static empty(){return new Ee(pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return pt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new pt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma=-1;function gb(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Me.fromTimestamp(r===1e9?new Lt(n+1,0):new Lt(n,r));return new As(s,Ee.empty(),e)}function yb(t){return new As(t.readTime,t.key,Ma)}class As{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new As(Me.min(),Ee.empty(),Ma)}static max(){return new As(Me.max(),Ee.empty(),Ma)}}function vb(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ee.comparator(t.documentKey,e.documentKey),n!==0?n:$e(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _b="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Io(t){if(t.code!==Z.FAILED_PRECONDITION||t.message!==_b)throw t;fe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Re(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ee((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ee?n:ee.resolve(n)}catch(n){return ee.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ee.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ee.reject(n)}static resolve(e){return new ee((n,r)=>{n(e)})}static reject(e){return new ee((n,r)=>{r(e)})}static waitFor(e){return new ee((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=ee.resolve(!1);for(const r of e)n=n.next(s=>s?ee.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new ee((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(m=>{o[d]=m,++l,l===i&&r(o)},m=>s(m))}})}static doWhile(e,n){return new ee((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function wb(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function bo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.oe(r),this._e=r=>n.writeSequenceNumber(r))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}yu.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf=-1;function vu(t){return t==null}function Vc(t){return t===0&&1/t==-1/0}function Eb(t){return typeof t=="number"&&Number.isInteger(t)&&!Vc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_="";function Tb(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Og(e)),e=Ib(t.get(n),e);return Og(e)}function Ib(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case A_:n+="";break;default:n+=i}}return n}function Og(t){return t+A_+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function pi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function k_(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e,n){this.comparator=e,this.root=n||Ht.EMPTY}insert(e,n){return new It(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ht.BLACK,null,null))}remove(e){return new It(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ht.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Dl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Dl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Dl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Dl(this.root,e,this.comparator,!0)}}class Dl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ht{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Ht.RED,this.left=s??Ht.EMPTY,this.right=i??Ht.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Ht(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ht.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Ht.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ht.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ht.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Re();const e=this.left.check();if(e!==this.right.check())throw Re();return e+(this.isRed()?0:1)}}Ht.EMPTY=null,Ht.RED=!0,Ht.BLACK=!1;Ht.EMPTY=new class{constructor(){this.size=0}get key(){throw Re()}get value(){throw Re()}get color(){throw Re()}get left(){throw Re()}get right(){throw Re()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Ht(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.comparator=e,this.data=new It(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ug(this.data.getIterator())}getIteratorFrom(e){return new Ug(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ot)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ot(this.comparator);return n.data=e,n}}class Ug{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e){this.fields=e,e.sort(qt.comparator)}static empty(){return new er([])}unionWith(e){let n=new Ot(qt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new er(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ho(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new P_("Invalid base64 string: "+i):i}}(e);return new Qt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Qt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qt.EMPTY_BYTE_STRING=new Qt("");const bb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ks(t){if(st(!!t),typeof t=="string"){let e=0;const n=bb.exec(t);if(st(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:At(t.seconds),nanos:At(t.nanos)}}function At(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ps(t){return typeof t=="string"?Qt.fromBase64String(t):Qt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R_="server_timestamp",j_="__type__",D_="__previous_value__",V_="__local_write_time__";function qf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[j_])===null||n===void 0?void 0:n.stringValue)===R_}function _u(t){const e=t.mapValue.fields[D_];return qf(e)?_u(e):e}function La(t){const e=ks(t.mapValue.fields[V_].timestampValue);return new Lt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb{constructor(e,n,r,s,i,o,l,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d}}const Mc="(default)";class Oa{constructor(e,n){this.projectId=e,this.database=n||Mc}static empty(){return new Oa("","")}get isDefaultDatabase(){return this.database===Mc}isEqual(e){return e instanceof Oa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M_="__type__",Nb="__max__",Vl={mapValue:{}},L_="__vector__",Lc="value";function Rs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?qf(t)?4:Ab(t)?9007199254740991:Cb(t)?10:11:Re()}function xr(t,e){if(t===e)return!0;const n=Rs(t);if(n!==Rs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return La(t).isEqual(La(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=ks(s.timestampValue),l=ks(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Ps(s.bytesValue).isEqual(Ps(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return At(s.geoPointValue.latitude)===At(i.geoPointValue.latitude)&&At(s.geoPointValue.longitude)===At(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return At(s.integerValue)===At(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=At(s.doubleValue),l=At(i.doubleValue);return o===l?Vc(o)===Vc(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return ho(t.arrayValue.values||[],e.arrayValue.values||[],xr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Fg(o)!==Fg(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!xr(o[u],l[u])))return!1;return!0}(t,e);default:return Re()}}function Fa(t,e){return(t.values||[]).find(n=>xr(n,e))!==void 0}function fo(t,e){if(t===e)return 0;const n=Rs(t),r=Rs(e);if(n!==r)return $e(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return $e(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=At(i.integerValue||i.doubleValue),u=At(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return Bg(t.timestampValue,e.timestampValue);case 4:return Bg(La(t),La(e));case 5:return Sh(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Ps(i),u=Ps(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let d=0;d<l.length&&d<u.length;d++){const m=$e(l[d],u[d]);if(m!==0)return m}return $e(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=$e(At(i.latitude),At(o.latitude));return l!==0?l:$e(At(i.longitude),At(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return $g(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,u,d,m;const g=i.fields||{},y=o.fields||{},N=(l=g[Lc])===null||l===void 0?void 0:l.arrayValue,R=(u=y[Lc])===null||u===void 0?void 0:u.arrayValue,j=$e(((d=N==null?void 0:N.values)===null||d===void 0?void 0:d.length)||0,((m=R==null?void 0:R.values)===null||m===void 0?void 0:m.length)||0);return j!==0?j:$g(N,R)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Vl.mapValue&&o===Vl.mapValue)return 0;if(i===Vl.mapValue)return 1;if(o===Vl.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),d=o.fields||{},m=Object.keys(d);u.sort(),m.sort();for(let g=0;g<u.length&&g<m.length;++g){const y=Sh(u[g],m[g]);if(y!==0)return y;const N=fo(l[u[g]],d[m[g]]);if(N!==0)return N}return $e(u.length,m.length)}(t.mapValue,e.mapValue);default:throw Re()}}function Bg(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return $e(t,e);const n=ks(t),r=ks(e),s=$e(n.seconds,r.seconds);return s!==0?s:$e(n.nanos,r.nanos)}function $g(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=fo(n[s],r[s]);if(i)return i}return $e(n.length,r.length)}function mo(t){return Nh(t)}function Nh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ks(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ps(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Ee.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Nh(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Nh(n.fields[o])}`;return s+"}"}(t.mapValue):Re()}function Zl(t){switch(Rs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=_u(t);return e?16+Zl(e):16;case 5:return 2*t.stringValue.length;case 6:return Ps(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Zl(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return pi(r.fields,(i,o)=>{s+=i.length+Zl(o)}),s}(t.mapValue);default:throw Re()}}function zg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ch(t){return!!t&&"integerValue"in t}function Gf(t){return!!t&&"arrayValue"in t}function Wg(t){return!!t&&"nullValue"in t}function Hg(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ec(t){return!!t&&"mapValue"in t}function Cb(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[M_])===null||n===void 0?void 0:n.stringValue)===L_}function ua(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return pi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ua(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ua(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Ab(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Nb}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this.value=e}static empty(){return new Un({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!ec(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ua(n)}setAll(e){let n=qt.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=ua(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());ec(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return xr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];ec(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){pi(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Un(ua(this.value))}}function O_(t){const e=[];return pi(t.fields,(n,r)=>{const s=new qt([n]);if(ec(r)){const i=O_(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new er(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new rn(e,0,Me.min(),Me.min(),Me.min(),Un.empty(),0)}static newFoundDocument(e,n,r,s){return new rn(e,1,n,Me.min(),r,s,0)}static newNoDocument(e,n){return new rn(e,2,n,Me.min(),Me.min(),Un.empty(),0)}static newUnknownDocument(e,n){return new rn(e,3,n,Me.min(),Me.min(),Un.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof rn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(e,n){this.position=e,this.inclusive=n}}function qg(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=Ee.comparator(Ee.fromName(o.referenceValue),n.key):r=fo(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Gg(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!xr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,n="asc"){this.field=e,this.dir=n}}function kb(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{}class Dt extends F_{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Rb(e,n,r):n==="array-contains"?new Vb(e,r):n==="in"?new Mb(e,r):n==="not-in"?new Lb(e,r):n==="array-contains-any"?new Ob(e,r):new Dt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new jb(e,r):new Db(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(fo(n,this.value)):n!==null&&Rs(this.value)===Rs(n)&&this.matchesComparison(fo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class or extends F_{constructor(e,n){super(),this.filters=e,this.op=n,this.ce=null}static create(e,n){return new or(e,n)}matches(e){return U_(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function U_(t){return t.op==="and"}function B_(t){return Pb(t)&&U_(t)}function Pb(t){for(const e of t.filters)if(e instanceof or)return!1;return!0}function Ah(t){if(t instanceof Dt)return t.field.canonicalString()+t.op.toString()+mo(t.value);if(B_(t))return t.filters.map(e=>Ah(e)).join(",");{const e=t.filters.map(n=>Ah(n)).join(",");return`${t.op}(${e})`}}function $_(t,e){return t instanceof Dt?function(r,s){return s instanceof Dt&&r.op===s.op&&r.field.isEqual(s.field)&&xr(r.value,s.value)}(t,e):t instanceof or?function(r,s){return s instanceof or&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&$_(o,s.filters[l]),!0):!1}(t,e):void Re()}function z_(t){return t instanceof Dt?function(n){return`${n.field.canonicalString()} ${n.op} ${mo(n.value)}`}(t):t instanceof or?function(n){return n.op.toString()+" {"+n.getFilters().map(z_).join(" ,")+"}"}(t):"Filter"}class Rb extends Dt{constructor(e,n,r){super(e,n,r),this.key=Ee.fromName(r.referenceValue)}matches(e){const n=Ee.comparator(e.key,this.key);return this.matchesComparison(n)}}class jb extends Dt{constructor(e,n){super(e,"in",n),this.keys=W_("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Db extends Dt{constructor(e,n){super(e,"not-in",n),this.keys=W_("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function W_(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Ee.fromName(r.referenceValue))}class Vb extends Dt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Gf(n)&&Fa(n.arrayValue,this.value)}}class Mb extends Dt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Fa(this.value.arrayValue,n)}}class Lb extends Dt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Fa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Fa(this.value.arrayValue,n)}}class Ob extends Dt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Gf(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Fa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fb{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.le=null}}function Kg(t,e=null,n=[],r=[],s=null,i=null,o=null){return new Fb(t,e,n,r,s,i,o)}function Kf(t){const e=Le(t);if(e.le===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Ah(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),vu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>mo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>mo(r)).join(",")),e.le=n}return e.le}function Qf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!kb(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!$_(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Gg(t.startAt,e.startAt)&&Gg(t.endAt,e.endAt)}function kh(t){return Ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function Ub(t,e,n,r,s,i,o,l){return new So(t,e,n,r,s,i,o,l)}function Yf(t){return new So(t)}function Qg(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function H_(t){return t.collectionGroup!==null}function da(t){const e=Le(t);if(e.he===null){e.he=[];const n=new Set;for(const i of e.explicitOrderBy)e.he.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ot(qt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.he.push(new Ua(i,r))}),n.has(qt.keyField().canonicalString())||e.he.push(new Ua(qt.keyField(),r))}return e.he}function gr(t){const e=Le(t);return e.Pe||(e.Pe=Bb(e,da(t))),e.Pe}function Bb(t,e){if(t.limitType==="F")return Kg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Ua(s.field,i)});const n=t.endAt?new Oc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Oc(t.startAt.position,t.startAt.inclusive):null;return Kg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Ph(t,e){const n=t.filters.concat([e]);return new So(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Fc(t,e,n){return new So(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function xu(t,e){return Qf(gr(t),gr(e))&&t.limitType===e.limitType}function q_(t){return`${Kf(gr(t))}|lt:${t.limitType}`}function Ai(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>z_(s)).join(", ")}]`),vu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>mo(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>mo(s)).join(",")),`Target(${r})`}(gr(t))}; limitType=${t.limitType})`}function wu(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Ee.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of da(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,u){const d=qg(o,l,u);return o.inclusive?d<=0:d<0}(r.startAt,da(r),s)||r.endAt&&!function(o,l,u){const d=qg(o,l,u);return o.inclusive?d>=0:d>0}(r.endAt,da(r),s))}(t,e)}function $b(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function G_(t){return(e,n)=>{let r=!1;for(const s of da(t)){const i=zb(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function zb(t,e,n){const r=t.field.isKeyField()?Ee.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),d=l.data.field(i);return u!==null&&d!==null?fo(u,d):Re()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Re()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){pi(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return k_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb=new It(Ee.comparator);function Wr(){return Wb}const K_=new It(Ee.comparator);function Jo(...t){let e=K_;for(const n of t)e=e.insert(n.key,n);return e}function Q_(t){let e=K_;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Xs(){return ha()}function Y_(){return ha()}function ha(){return new gi(t=>t.toString(),(t,e)=>t.isEqual(e))}const Hb=new It(Ee.comparator),qb=new Ot(Ee.comparator);function qe(...t){let e=qb;for(const n of t)e=e.add(n);return e}const Gb=new Ot($e);function Kb(){return Gb}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vc(e)?"-0":e}}function X_(t){return{integerValue:""+t}}function Qb(t,e){return Eb(e)?X_(e):Xf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(){this._=void 0}}function Yb(t,e,n){return t instanceof Uc?function(s,i){const o={fields:{[j_]:{stringValue:R_},[V_]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&qf(i)&&(i=_u(i)),i&&(o.fields[D_]=i),{mapValue:o}}(n,e):t instanceof Ba?Z_(t,e):t instanceof $a?ex(t,e):function(s,i){const o=J_(s,i),l=Yg(o)+Yg(s.Ie);return Ch(o)&&Ch(s.Ie)?X_(l):Xf(s.serializer,l)}(t,e)}function Xb(t,e,n){return t instanceof Ba?Z_(t,e):t instanceof $a?ex(t,e):n}function J_(t,e){return t instanceof Bc?function(r){return Ch(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Uc extends Eu{}class Ba extends Eu{constructor(e){super(),this.elements=e}}function Z_(t,e){const n=tx(e);for(const r of t.elements)n.some(s=>xr(s,r))||n.push(r);return{arrayValue:{values:n}}}class $a extends Eu{constructor(e){super(),this.elements=e}}function ex(t,e){let n=tx(e);for(const r of t.elements)n=n.filter(s=>!xr(s,r));return{arrayValue:{values:n}}}class Bc extends Eu{constructor(e,n){super(),this.serializer=e,this.Ie=n}}function Yg(t){return At(t.integerValue||t.doubleValue)}function tx(t){return Gf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Jb(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Ba&&s instanceof Ba||r instanceof $a&&s instanceof $a?ho(r.elements,s.elements,xr):r instanceof Bc&&s instanceof Bc?xr(r.Ie,s.Ie):r instanceof Uc&&s instanceof Uc}(t.transform,e.transform)}class Zb{constructor(e,n){this.version=e,this.transformResults=n}}class yr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new yr}static exists(e){return new yr(void 0,e)}static updateTime(e){return new yr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function tc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Tu{}function nx(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Jf(t.key,yr.none()):new Xa(t.key,t.data,yr.none());{const n=t.data,r=Un.empty();let s=new Ot(qt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new yi(t.key,r,new er(s.toArray()),yr.none())}}function eS(t,e,n){t instanceof Xa?function(s,i,o){const l=s.value.clone(),u=Jg(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof yi?function(s,i,o){if(!tc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Jg(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(rx(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function fa(t,e,n,r){return t instanceof Xa?function(i,o,l,u){if(!tc(i.precondition,o))return l;const d=i.value.clone(),m=Zg(i.fieldTransforms,u,o);return d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof yi?function(i,o,l,u){if(!tc(i.precondition,o))return l;const d=Zg(i.fieldTransforms,u,o),m=o.data;return m.setAll(rx(i)),m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(i,o,l){return tc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function tS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=J_(r.transform,s||null);i!=null&&(n===null&&(n=Un.empty()),n.set(r.field,i))}return n||null}function Xg(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ho(r,s,(i,o)=>Jb(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Xa extends Tu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class yi extends Tu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function rx(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Jg(t,e,n){const r=new Map;st(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,Xb(o,l,n[s]))}return r}function Zg(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,Yb(i,o,e))}return r}class Jf extends Tu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nS extends Tu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&eS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=fa(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=fa(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Y_();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const u=nx(o,l);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(Me.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),qe())}isEqual(e){return this.batchId===e.batchId&&ho(this.mutations,e.mutations,(n,r)=>Xg(n,r))&&ho(this.baseMutations,e.baseMutations,(n,r)=>Xg(n,r))}}class Zf{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){st(e.mutations.length===r.length);let s=function(){return Hb}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Zf(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt,Ye;function oS(t){switch(t){case Z.OK:return Re();case Z.CANCELLED:case Z.UNKNOWN:case Z.DEADLINE_EXCEEDED:case Z.RESOURCE_EXHAUSTED:case Z.INTERNAL:case Z.UNAVAILABLE:case Z.UNAUTHENTICATED:return!1;case Z.INVALID_ARGUMENT:case Z.NOT_FOUND:case Z.ALREADY_EXISTS:case Z.PERMISSION_DENIED:case Z.FAILED_PRECONDITION:case Z.ABORTED:case Z.OUT_OF_RANGE:case Z.UNIMPLEMENTED:case Z.DATA_LOSS:return!0;default:return Re()}}function sx(t){if(t===void 0)return zr("GRPC error has no .code"),Z.UNKNOWN;switch(t){case Rt.OK:return Z.OK;case Rt.CANCELLED:return Z.CANCELLED;case Rt.UNKNOWN:return Z.UNKNOWN;case Rt.DEADLINE_EXCEEDED:return Z.DEADLINE_EXCEEDED;case Rt.RESOURCE_EXHAUSTED:return Z.RESOURCE_EXHAUSTED;case Rt.INTERNAL:return Z.INTERNAL;case Rt.UNAVAILABLE:return Z.UNAVAILABLE;case Rt.UNAUTHENTICATED:return Z.UNAUTHENTICATED;case Rt.INVALID_ARGUMENT:return Z.INVALID_ARGUMENT;case Rt.NOT_FOUND:return Z.NOT_FOUND;case Rt.ALREADY_EXISTS:return Z.ALREADY_EXISTS;case Rt.PERMISSION_DENIED:return Z.PERMISSION_DENIED;case Rt.FAILED_PRECONDITION:return Z.FAILED_PRECONDITION;case Rt.ABORTED:return Z.ABORTED;case Rt.OUT_OF_RANGE:return Z.OUT_OF_RANGE;case Rt.UNIMPLEMENTED:return Z.UNIMPLEMENTED;case Rt.DATA_LOSS:return Z.DATA_LOSS;default:return Re()}}(Ye=Rt||(Rt={}))[Ye.OK=0]="OK",Ye[Ye.CANCELLED=1]="CANCELLED",Ye[Ye.UNKNOWN=2]="UNKNOWN",Ye[Ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ye[Ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ye[Ye.NOT_FOUND=5]="NOT_FOUND",Ye[Ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ye[Ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ye[Ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ye[Ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ye[Ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ye[Ye.ABORTED=10]="ABORTED",Ye[Ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ye[Ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ye[Ye.INTERNAL=13]="INTERNAL",Ye[Ye.UNAVAILABLE=14]="UNAVAILABLE",Ye[Ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS=new bs([4294967295,4294967295],0);function e0(t){const e=N_().encode(t),n=new x_;return n.update(e),new Uint8Array(n.digest())}function t0(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new bs([n,r],0),new bs([s,i],0)]}class em{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Zo(`Invalid padding: ${n}`);if(r<0)throw new Zo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Zo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Zo(`Invalid padding when bitmap length is 0: ${n}`);this.Ee=8*e.length-n,this.de=bs.fromNumber(this.Ee)}Ae(e,n,r){let s=e.add(n.multiply(bs.fromNumber(r)));return s.compare(aS)===1&&(s=new bs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;const n=e0(e),[r,s]=t0(n);for(let i=0;i<this.hashCount;i++){const o=this.Ae(r,s,i);if(!this.Re(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new em(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ee===0)return;const n=e0(e),[r,s]=t0(n);for(let i=0;i<this.hashCount;i++){const o=this.Ae(r,s,i);this.Ve(o)}}Ve(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Zo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ja.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Iu(Me.min(),s,new It($e),Wr(),qe())}}class Ja{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ja(r,n,qe(),qe(),qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,n,r,s){this.me=e,this.removedTargetIds=n,this.key=r,this.fe=s}}class ix{constructor(e,n){this.targetId=e,this.ge=n}}class ox{constructor(e,n,r=Qt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class n0{constructor(){this.pe=0,this.ye=r0(),this.we=Qt.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=qe(),n=qe(),r=qe();return this.ye.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Re()}}),new Ja(this.we,this.Se,e,n,r)}Me(){this.be=!1,this.ye=r0()}xe(e,n){this.be=!0,this.ye=this.ye.insert(e,n)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,st(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class lS{constructor(e){this.ke=e,this.qe=new Map,this.Qe=Wr(),this.$e=Ml(),this.Ue=Ml(),this.Ke=new It($e)}We(e){for(const n of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(n,e.fe):this.ze(n,e.key,e.fe);for(const n of e.removedTargetIds)this.ze(n,e.key,e.fe)}je(e){this.forEachTarget(e,n=>{const r=this.He(n);switch(e.state){case 0:this.Je(n)&&r.Ce(e.resumeToken);break;case 1:r.Be(),r.De||r.Me(),r.Ce(e.resumeToken);break;case 2:r.Be(),r.De||this.removeTarget(n);break;case 3:this.Je(n)&&(r.Le(),r.Ce(e.resumeToken));break;case 4:this.Je(n)&&(this.Ye(n),r.Ce(e.resumeToken));break;default:Re()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.qe.forEach((r,s)=>{this.Je(s)&&n(s)})}Ze(e){const n=e.targetId,r=e.ge.count,s=this.Xe(n);if(s){const i=s.target;if(kh(i))if(r===0){const o=new Ee(i.path);this.ze(n,o,rn.newNoDocument(o,Me.min()))}else st(r===1);else{const o=this.et(n);if(o!==r){const l=this.tt(e),u=l?this.nt(l,e,o):1;if(u!==0){this.Ye(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,d)}}}}}tt(e){const n=e.ge.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=Ps(r).toUint8Array()}catch(u){if(u instanceof P_)return uo("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new em(o,s,i)}catch(u){return uo(u instanceof Zo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ee===0?null:l}nt(e,n,r){return n.ge.count===r-this.st(e,n.targetId)?0:2}st(e,n){const r=this.ke.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.ke.it(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.ze(n,i,null),s++)}),s}ot(e){const n=new Map;this.qe.forEach((i,o)=>{const l=this.Xe(o);if(l){if(i.current&&kh(l.target)){const u=new Ee(l.target.path);this._t(u).has(o)||this.ut(o,u)||this.ze(o,u,rn.newNoDocument(u,e))}i.ve&&(n.set(o,i.Fe()),i.Me())}});let r=qe();this.Ue.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const d=this.Xe(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.Qe.forEach((i,o)=>o.setReadTime(e));const s=new Iu(e,n,this.Ke,this.Qe,r);return this.Qe=Wr(),this.$e=Ml(),this.Ue=Ml(),this.Ke=new It($e),s}Ge(e,n){if(!this.Je(e))return;const r=this.ut(e,n.key)?2:0;this.He(e).xe(n.key,r),this.Qe=this.Qe.insert(n.key,n),this.$e=this.$e.insert(n.key,this._t(n.key).add(e)),this.Ue=this.Ue.insert(n.key,this.ct(n.key).add(e))}ze(e,n,r){if(!this.Je(e))return;const s=this.He(e);this.ut(e,n)?s.xe(n,1):s.Oe(n),this.Ue=this.Ue.insert(n,this.ct(n).delete(e)),this.Ue=this.Ue.insert(n,this.ct(n).add(e)),r&&(this.Qe=this.Qe.insert(n,r))}removeTarget(e){this.qe.delete(e)}et(e){const n=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let n=this.qe.get(e);return n||(n=new n0,this.qe.set(e,n)),n}ct(e){let n=this.Ue.get(e);return n||(n=new Ot($e),this.Ue=this.Ue.insert(e,n)),n}_t(e){let n=this.$e.get(e);return n||(n=new Ot($e),this.$e=this.$e.insert(e,n)),n}Je(e){const n=this.Xe(e)!==null;return n||fe("WatchChangeAggregator","Detected inactive target",e),n}Xe(e){const n=this.qe.get(e);return n&&n.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new n0),this.ke.getRemoteKeysForTarget(e).forEach(n=>{this.ze(e,n,null)})}ut(e,n){return this.ke.getRemoteKeysForTarget(e).has(n)}}function Ml(){return new It(Ee.comparator)}function r0(){return new It(Ee.comparator)}const cS={asc:"ASCENDING",desc:"DESCENDING"},uS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},dS={and:"AND",or:"OR"};class hS{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Rh(t,e){return t.useProto3Json||vu(e)?e:{value:e}}function $c(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ax(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function fS(t,e){return $c(t,e.toTimestamp())}function vr(t){return st(!!t),Me.fromTimestamp(function(n){const r=ks(n);return new Lt(r.seconds,r.nanos)}(t))}function tm(t,e){return jh(t,e).canonicalString()}function jh(t,e){const n=function(s){return new pt(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function lx(t){const e=pt.fromString(t);return st(fx(e)),e}function Dh(t,e){return tm(t.databaseId,e.path)}function _d(t,e){const n=lx(e);if(n.get(1)!==t.databaseId.projectId)throw new me(Z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new me(Z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ee(ux(n))}function cx(t,e){return tm(t.databaseId,e)}function mS(t){const e=lx(t);return e.length===4?pt.emptyPath():ux(e)}function Vh(t){return new pt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ux(t){return st(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function s0(t,e,n){return{name:Dh(t,e),fields:n.value.mapValue.fields}}function pS(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Re()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,m){return d.useProto3Json?(st(m===void 0||typeof m=="string"),Qt.fromBase64String(m||"")):(st(m===void 0||m instanceof Buffer||m instanceof Uint8Array),Qt.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const m=d.code===void 0?Z.UNKNOWN:sx(d.code);return new me(m,d.message||"")}(o);n=new ox(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=_d(t,r.document.name),i=vr(r.document.updateTime),o=r.document.createTime?vr(r.document.createTime):Me.min(),l=new Un({mapValue:{fields:r.document.fields}}),u=rn.newFoundDocument(s,i,o,l),d=r.targetIds||[],m=r.removedTargetIds||[];n=new nc(d,m,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=_d(t,r.document),i=r.readTime?vr(r.readTime):Me.min(),o=rn.newNoDocument(s,i),l=r.removedTargetIds||[];n=new nc([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=_d(t,r.document),i=r.removedTargetIds||[];n=new nc([],i,s,null)}else{if(!("filter"in e))return Re();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new iS(s,i),l=r.targetId;n=new ix(l,o)}}return n}function gS(t,e){let n;if(e instanceof Xa)n={update:s0(t,e.key,e.value)};else if(e instanceof Jf)n={delete:Dh(t,e.key)};else if(e instanceof yi)n={update:s0(t,e.key,e.data),updateMask:bS(e.fieldMask)};else{if(!(e instanceof nS))return Re();n={verify:Dh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Uc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Ba)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof $a)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Bc)return{fieldPath:o.field.canonicalString(),increment:l.Ie};throw Re()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:fS(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Re()}(t,e.precondition)),n}function yS(t,e){return t&&t.length>0?(st(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?vr(s.updateTime):vr(i);return o.isEqual(Me.min())&&(o=vr(i)),new Zb(o,s.transformResults||[])}(n,e))):[]}function vS(t,e){return{documents:[cx(t,e.path)]}}function _S(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=cx(t,s);const i=function(d){if(d.length!==0)return hx(or.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(m=>function(y){return{field:ki(y.field),direction:ES(y.dir)}}(m))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Rh(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ht:n,parent:s}}function xS(t){let e=mS(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){st(r===1);const m=n.from[0];m.allDescendants?s=m.collectionId:e=e.child(m.collectionId)}let i=[];n.where&&(i=function(g){const y=dx(g);return y instanceof or&&B_(y)?y.getFilters():[y]}(n.where));let o=[];n.orderBy&&(o=function(g){return g.map(y=>function(R){return new Ua(Pi(R.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(y))}(n.orderBy));let l=null;n.limit&&(l=function(g){let y;return y=typeof g=="object"?g.value:g,vu(y)?null:y}(n.limit));let u=null;n.startAt&&(u=function(g){const y=!!g.before,N=g.values||[];return new Oc(N,y)}(n.startAt));let d=null;return n.endAt&&(d=function(g){const y=!g.before,N=g.values||[];return new Oc(N,y)}(n.endAt)),Ub(e,s,o,i,l,"F",u,d)}function wS(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Re()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function dx(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Pi(n.unaryFilter.field);return Dt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Pi(n.unaryFilter.field);return Dt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Pi(n.unaryFilter.field);return Dt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Pi(n.unaryFilter.field);return Dt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Re()}}(t):t.fieldFilter!==void 0?function(n){return Dt.create(Pi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Re()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return or.create(n.compositeFilter.filters.map(r=>dx(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Re()}}(n.compositeFilter.op))}(t):Re()}function ES(t){return cS[t]}function TS(t){return uS[t]}function IS(t){return dS[t]}function ki(t){return{fieldPath:t.canonicalString()}}function Pi(t){return qt.fromServerFormat(t.fieldPath)}function hx(t){return t instanceof Dt?function(n){if(n.op==="=="){if(Hg(n.value))return{unaryFilter:{field:ki(n.field),op:"IS_NAN"}};if(Wg(n.value))return{unaryFilter:{field:ki(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Hg(n.value))return{unaryFilter:{field:ki(n.field),op:"IS_NOT_NAN"}};if(Wg(n.value))return{unaryFilter:{field:ki(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ki(n.field),op:TS(n.op),value:n.value}}}(t):t instanceof or?function(n){const r=n.getFilters().map(s=>hx(s));return r.length===1?r[0]:{compositeFilter:{op:IS(n.op),filters:r}}}(t):Re()}function bS(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function fx(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,n,r,s,i=Me.min(),o=Me.min(),l=Qt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new fs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new fs(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new fs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new fs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e){this.Tt=e}}function NS(t){const e=xS({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Fc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(){this.Tn=new AS}addToCollectionParentIndex(e,n){return this.Tn.add(n),ee.resolve()}getCollectionParents(e,n){return ee.resolve(this.Tn.getEntries(n))}addFieldIndex(e,n){return ee.resolve()}deleteFieldIndex(e,n){return ee.resolve()}deleteAllFieldIndexes(e){return ee.resolve()}createTargetIndexes(e,n){return ee.resolve()}getDocumentsMatchingTarget(e,n){return ee.resolve(null)}getIndexType(e,n){return ee.resolve(0)}getFieldIndexes(e,n){return ee.resolve([])}getNextCollectionGroupToUpdate(e){return ee.resolve(null)}getMinOffset(e,n){return ee.resolve(As.min())}getMinOffsetFromCollectionGroup(e,n){return ee.resolve(As.min())}updateCollectionGroup(e,n,r){return ee.resolve()}updateIndexEntries(e,n){return ee.resolve()}}class AS{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Ot(pt.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ot(pt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},mx=41943040;class gn{static withCacheSize(e){return new gn(e,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gn.DEFAULT_COLLECTION_PERCENTILE=10,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gn.DEFAULT=new gn(mx,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gn.DISABLED=new gn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new po(0)}static Kn(){return new po(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0="LruGarbageCollector",kS=1048576;function a0([t,e],[n,r]){const s=$e(t,n);return s===0?$e(e,r):s}class PS{constructor(e){this.Hn=e,this.buffer=new Ot(a0),this.Jn=0}Yn(){return++this.Jn}Zn(e){const n=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();a0(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class RS{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){fe(o0,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){bo(n)?fe(o0,"Ignoring IndexedDB error during garbage collection: ",n):await Io(n)}await this.er(3e5)})}}class jS{constructor(e,n){this.tr=e,this.params=n}calculateTargetCount(e,n){return this.tr.nr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return ee.resolve(yu.ae);const r=new PS(n);return this.tr.forEachTarget(e,s=>r.Zn(s.sequenceNumber)).next(()=>this.tr.rr(e,s=>r.Zn(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.tr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.tr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),ee.resolve(i0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),i0):this.ir(e,n))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,n){let r,s,i,o,l,u,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),s=this.params.maximumSequenceNumbersToCollect):s=g,o=Date.now(),this.nthSequenceNumber(e,s))).next(g=>(r=g,l=Date.now(),this.removeTargets(e,r,n))).next(g=>(i=g,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(g=>(d=Date.now(),Ci()<=He.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${g} documents in `+(d-u)+`ms
Total Duration: ${d-m}ms`),ee.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:g})))}}function DS(t,e){return new jS(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(){this.changes=new gi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,rn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ee.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&fa(r.mutation,s,er.empty(),Lt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,qe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=qe()){const s=Xs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Jo();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Xs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,qe()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Wr();const o=ha(),l=function(){return ha()}();return n.forEach((u,d)=>{const m=r.get(d.key);s.has(d.key)&&(m===void 0||m.mutation instanceof yi)?i=i.insert(d.key,d):m!==void 0?(o.set(d.key,m.mutation.getFieldMask()),fa(m.mutation,d,m.mutation.getFieldMask(),Lt.now())):o.set(d.key,er.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,m)=>o.set(d,m)),n.forEach((d,m)=>{var g;return l.set(d,new MS(m,(g=o.get(d))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=ha();let s=new It((o,l)=>o-l),i=qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let m=r.get(u)||er.empty();m=l.applyToLocalView(d,m),r.set(u,m);const g=(s.get(l.batchId)||qe()).add(u);s=s.insert(l.batchId,g)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,m=u.value,g=Y_();m.forEach(y=>{if(!i.has(y)){const N=nx(n.get(y),r.get(y));N!==null&&g.set(y,N),i=i.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,g))}return ee.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return Ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):H_(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):ee.resolve(Xs());let l=Ma,u=i;return o.next(d=>ee.forEach(d,(m,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),i.get(m)?ee.resolve():this.remoteDocumentCache.getEntry(e,m).next(y=>{u=u.insert(m,y)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,qe())).next(m=>({batchId:l,changes:Q_(m)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ee(n)).next(r=>{let s=Jo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Jo();return this.indexManager.getCollectionParents(e,i).next(l=>ee.forEach(l,u=>{const d=function(g,y){return new So(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(m=>{m.forEach((g,y)=>{o=o.insert(g,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,d)=>{const m=d.getKey();o.get(m)===null&&(o=o.insert(m,rn.newInvalidDocument(m)))});let l=Jo();return o.forEach((u,d)=>{const m=i.get(u);m!==void 0&&fa(m.mutation,d,er.empty(),Lt.now()),wu(n,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,n){return ee.resolve(this.dr.get(n))}saveBundleMetadata(e,n){return this.dr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:vr(s.createTime)}}(n)),ee.resolve()}getNamedQuery(e,n){return ee.resolve(this.Ar.get(n))}saveNamedQuery(e,n){return this.Ar.set(n.name,function(s){return{name:s.name,query:NS(s.bundledQuery),readTime:vr(s.readTime)}}(n)),ee.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(){this.overlays=new It(Ee.comparator),this.Rr=new Map}getOverlay(e,n){return ee.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Xs();return ee.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.Et(e,n,i)}),ee.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Rr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Rr.delete(r)),ee.resolve()}getOverlaysForCollection(e,n,r){const s=Xs(),i=n.length+1,o=new Ee(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return ee.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new It((d,m)=>d-m);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let m=i.get(d.largestBatchId);m===null&&(m=Xs(),i=i.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const l=Xs(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,m)=>l.set(d,m)),!(l.size()>=s)););return ee.resolve(l)}Et(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Rr.get(s.largestBatchId).delete(r.key);this.Rr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new sS(n,r));let i=this.Rr.get(n);i===void 0&&(i=qe(),this.Rr.set(n,i)),this.Rr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(){this.sessionToken=Qt.EMPTY_BYTE_STRING}getSessionToken(e){return ee.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ee.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(){this.Vr=new Ot(Ft.mr),this.gr=new Ot(Ft.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,n){const r=new Ft(e,n);this.Vr=this.Vr.add(r),this.gr=this.gr.add(r)}yr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.wr(new Ft(e,n))}Sr(e,n){e.forEach(r=>this.removeReference(r,n))}br(e){const n=new Ee(new pt([])),r=new Ft(n,e),s=new Ft(n,e+1),i=[];return this.gr.forEachInRange([r,s],o=>{this.wr(o),i.push(o.key)}),i}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const n=new Ee(new pt([])),r=new Ft(n,e),s=new Ft(n,e+1);let i=qe();return this.gr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Ft(e,0),r=this.Vr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ft{constructor(e,n){this.key=e,this.Cr=n}static mr(e,n){return Ee.comparator(e.key,n.key)||$e(e.Cr,n.Cr)}static pr(e,n){return $e(e.Cr,n.Cr)||Ee.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Fr=1,this.Mr=new Ot(Ft.mr)}checkEmpty(e){return ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new rS(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Mr=this.Mr.add(new Ft(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ee.resolve(o)}lookupMutationBatch(e,n){return ee.resolve(this.Or(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Nr(r),i=s<0?0:s;return ee.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ee.resolve(this.mutationQueue.length===0?Hf:this.Fr-1)}getAllMutationBatches(e){return ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ft(n,0),s=new Ft(n,Number.POSITIVE_INFINITY),i=[];return this.Mr.forEachInRange([r,s],o=>{const l=this.Or(o.Cr);i.push(l)}),ee.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ot($e);return n.forEach(s=>{const i=new Ft(s,0),o=new Ft(s,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([i,o],l=>{r=r.add(l.Cr)})}),ee.resolve(this.Br(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Ee.isDocumentKey(i)||(i=i.child(""));const o=new Ft(new Ee(i),0);let l=new Ot($e);return this.Mr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(u.Cr)),!0)},o),ee.resolve(this.Br(l))}Br(e){const n=[];return e.forEach(r=>{const s=this.Or(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){st(this.Lr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.Mr;return ee.forEach(n.mutations,s=>{const i=new Ft(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Mr=r})}qn(e){}containsKey(e,n){const r=new Ft(n,0),s=this.Mr.firstAfterOrEqual(r);return ee.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ee.resolve()}Lr(e,n){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){const n=this.Nr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(e){this.kr=e,this.docs=function(){return new It(Ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.kr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ee.resolve(r?r.document.mutableCopy():rn.newInvalidDocument(n))}getEntries(e,n){let r=Wr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():rn.newInvalidDocument(s))}),ee.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Wr();const o=n.path,l=new Ee(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:m}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||vb(yb(m),r)<=0||(s.has(m.key)||wu(n,m))&&(i=i.insert(m.key,m.mutableCopy()))}return ee.resolve(i)}getAllFromCollectionGroup(e,n,r,s){Re()}qr(e,n){return ee.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new zS(this)}getSize(e){return ee.resolve(this.size)}}class zS extends VS{constructor(e){super(),this.Ir=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Ir.addEntry(e,s)):this.Ir.removeEntry(r)}),ee.waitFor(n)}getFromCache(e,n){return this.Ir.getEntry(e,n)}getAllFromCache(e,n){return this.Ir.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(e){this.persistence=e,this.Qr=new gi(n=>Kf(n),Qf),this.lastRemoteSnapshotVersion=Me.min(),this.highestTargetId=0,this.$r=0,this.Ur=new nm,this.targetCount=0,this.Kr=po.Un()}forEachTarget(e,n){return this.Qr.forEach((r,s)=>n(s)),ee.resolve()}getLastRemoteSnapshotVersion(e){return ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ee.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),ee.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.$r&&(this.$r=n),ee.resolve()}zn(e){this.Qr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Kr=new po(n),this.highestTargetId=n),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,n){return this.zn(n),this.targetCount+=1,ee.resolve()}updateTargetData(e,n){return this.zn(n),ee.resolve()}removeTargetData(e,n){return this.Qr.delete(n.target),this.Ur.br(n.targetId),this.targetCount-=1,ee.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Qr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Qr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),ee.waitFor(i).next(()=>s)}getTargetCount(e){return ee.resolve(this.targetCount)}getTargetData(e,n){const r=this.Qr.get(n)||null;return ee.resolve(r)}addMatchingKeys(e,n,r){return this.Ur.yr(n,r),ee.resolve()}removeMatchingKeys(e,n,r){this.Ur.Sr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),ee.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Ur.br(n),ee.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Ur.vr(n);return ee.resolve(r)}containsKey(e,n){return ee.resolve(this.Ur.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class px{constructor(e,n){this.Wr={},this.overlays={},this.Gr=new yu(0),this.zr=!1,this.zr=!0,this.jr=new US,this.referenceDelegate=e(this),this.Hr=new WS(this),this.indexManager=new CS,this.remoteDocumentCache=function(s){return new $S(s)}(r=>this.referenceDelegate.Jr(r)),this.serializer=new SS(n),this.Yr=new OS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new FS,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Wr[e.toKey()];return r||(r=new BS(n,this.referenceDelegate),this.Wr[e.toKey()]=r),r}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,n,r){fe("MemoryPersistence","Starting transaction:",e);const s=new HS(this.Gr.next());return this.referenceDelegate.Zr(),r(s).next(i=>this.referenceDelegate.Xr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}ei(e,n){return ee.or(Object.values(this.Wr).map(r=>()=>r.containsKey(e,n)))}}class HS extends xb{constructor(e){super(),this.currentSequenceNumber=e}}class rm{constructor(e){this.persistence=e,this.ti=new nm,this.ni=null}static ri(e){return new rm(e)}get ii(){if(this.ni)return this.ni;throw Re()}addReference(e,n,r){return this.ti.addReference(r,n),this.ii.delete(r.toString()),ee.resolve()}removeReference(e,n,r){return this.ti.removeReference(r,n),this.ii.add(r.toString()),ee.resolve()}markPotentiallyOrphaned(e,n){return this.ii.add(n.toString()),ee.resolve()}removeTarget(e,n){this.ti.br(n.targetId).forEach(s=>this.ii.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.ii.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Zr(){this.ni=new Set}Xr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ee.forEach(this.ii,r=>{const s=Ee.fromPath(r);return this.si(e,s).next(i=>{i||n.removeEntry(s,Me.min())})}).next(()=>(this.ni=null,n.apply(e)))}updateLimboDocument(e,n){return this.si(e,n).next(r=>{r?this.ii.delete(n.toString()):this.ii.add(n.toString())})}Jr(e){return 0}si(e,n){return ee.or([()=>ee.resolve(this.ti.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.ei(e,n)])}}class zc{constructor(e,n){this.persistence=e,this.oi=new gi(r=>Tb(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=DS(this,n)}static ri(e,n){return new zc(e,n)}Zr(){}Xr(e){return ee.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}nr(e){const n=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}sr(e){let n=0;return this.rr(e,r=>{n++}).next(()=>n)}rr(e,n){return ee.forEach(this.oi,(r,s)=>this.ar(e,r,s).next(i=>i?ee.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.qr(e,o=>this.ar(e,o,n).next(l=>{l||(r++,i.removeEntry(o,Me.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.oi.set(n,e.currentSequenceNumber),ee.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.oi.set(r,e.currentSequenceNumber),ee.resolve()}removeReference(e,n,r){return this.oi.set(r,e.currentSequenceNumber),ee.resolve()}updateLimboDocument(e,n){return this.oi.set(n,e.currentSequenceNumber),ee.resolve()}Jr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Zl(e.data.value)),n}ar(e,n,r){return ee.or([()=>this.persistence.ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.oi.get(n);return ee.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Hi=r,this.Ji=s}static Yi(e,n){let r=qe(),s=qe();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new sm(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return z1()?8:wb(on())>0?6:4}()}initialize(e,n){this.ns=e,this.indexManager=n,this.Zi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.rs(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ss(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new qS;return this._s(e,n,o).next(l=>{if(i.result=l,this.Xi)return this.us(e,n,o,l.size)})}).next(()=>i.result)}us(e,n,r,s){return r.documentReadCount<this.es?(Ci()<=He.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",Ai(n),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),ee.resolve()):(Ci()<=He.DEBUG&&fe("QueryEngine","Query:",Ai(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ts*s?(Ci()<=He.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",Ai(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,gr(n))):ee.resolve())}rs(e,n){if(Qg(n))return ee.resolve(null);let r=gr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Fc(n,null,"F"),r=gr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=qe(...i);return this.ns.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.cs(n,l);return this.ls(n,d,o,u.readTime)?this.rs(e,Fc(n,null,"F")):this.hs(e,d,n,u)}))})))}ss(e,n,r,s){return Qg(n)||s.isEqual(Me.min())?ee.resolve(null):this.ns.getDocuments(e,r).next(i=>{const o=this.cs(n,i);return this.ls(n,o,r,s)?ee.resolve(null):(Ci()<=He.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ai(n)),this.hs(e,o,n,gb(s,Ma)).next(l=>l))})}cs(e,n){let r=new Ot(G_(e));return n.forEach((s,i)=>{wu(e,i)&&(r=r.add(i))}),r}ls(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}_s(e,n,r){return Ci()<=He.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",Ai(n)),this.ns.getDocumentsMatchingQuery(e,n,As.min(),r)}hs(e,n,r,s){return this.ns.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const im="LocalStore",KS=3e8;class QS{constructor(e,n,r,s){this.persistence=e,this.Ps=n,this.serializer=s,this.Ts=new It($e),this.Is=new gi(i=>Kf(i),Qf),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(r)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LS(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ts))}}function YS(t,e,n,r){return new QS(t,e,n,r)}async function gx(t,e){const n=Le(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.As(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=qe();for(const d of s){o.push(d.batchId);for(const m of d.mutations)u=u.add(m.key)}for(const d of i){l.push(d.batchId);for(const m of d.mutations)u=u.add(m.key)}return n.localDocuments.getDocuments(r,u).next(d=>({Rs:d,removedBatchIds:o,addedBatchIds:l}))})})}function XS(t,e){const n=Le(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.ds.newChangeBuffer({trackRemovals:!0});return function(l,u,d,m){const g=d.batch,y=g.keys();let N=ee.resolve();return y.forEach(R=>{N=N.next(()=>m.getEntry(u,R)).next(j=>{const k=d.docVersions.get(R);st(k!==null),j.version.compareTo(k)<0&&(g.applyToRemoteDocument(j,d),j.isValidDocument()&&(j.setReadTime(d.commitVersion),m.addEntry(j)))})}),N.next(()=>l.mutationQueue.removeMutationBatch(u,g))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=qe();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function yx(t){const e=Le(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Hr.getLastRemoteSnapshotVersion(n))}function JS(t,e){const n=Le(t),r=e.snapshotVersion;let s=n.Ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.ds.newChangeBuffer({trackRemovals:!0});s=n.Ts;const l=[];e.targetChanges.forEach((m,g)=>{const y=s.get(g);if(!y)return;l.push(n.Hr.removeMatchingKeys(i,m.removedDocuments,g).next(()=>n.Hr.addMatchingKeys(i,m.addedDocuments,g)));let N=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?N=N.withResumeToken(Qt.EMPTY_BYTE_STRING,Me.min()).withLastLimboFreeSnapshotVersion(Me.min()):m.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(m.resumeToken,r)),s=s.insert(g,N),function(j,k,E){return j.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=KS?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(y,N,m)&&l.push(n.Hr.updateTargetData(i,N))});let u=Wr(),d=qe();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,m))}),l.push(ZS(i,o,e.documentUpdates).next(m=>{u=m.Vs,d=m.fs})),!r.isEqual(Me.min())){const m=n.Hr.getLastRemoteSnapshotVersion(i).next(g=>n.Hr.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(m)}return ee.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.Ts=s,i))}function ZS(t,e,n){let r=qe(),s=qe();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Wr();return n.forEach((l,u)=>{const d=i.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(Me.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):fe(im,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{Vs:o,fs:s}})}function eN(t,e){const n=Le(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Hf),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function tN(t,e){const n=Le(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Hr.getTargetData(r,e).next(i=>i?(s=i,ee.resolve(s)):n.Hr.allocateTargetId(r).next(o=>(s=new fs(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Hr.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ts.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ts=n.Ts.insert(r.targetId,r),n.Is.set(e,r.targetId)),r})}async function Mh(t,e,n){const r=Le(t),s=r.Ts.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!bo(o))throw o;fe(im,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ts=r.Ts.remove(e),r.Is.delete(s.target)}function l0(t,e,n){const r=Le(t);let s=Me.min(),i=qe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,m){const g=Le(u),y=g.Is.get(m);return y!==void 0?ee.resolve(g.Ts.get(y)):g.Hr.getTargetData(d,m)}(r,o,gr(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Hr.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.Ps.getDocumentsMatchingQuery(o,e,n?s:Me.min(),n?i:qe())).next(l=>(nN(r,$b(e),l),{documents:l,gs:i})))}function nN(t,e,n){let r=t.Es.get(e)||Me.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Es.set(e,r)}class c0{constructor(){this.activeTargetIds=Kb()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class rN{constructor(){this.ho=new c0,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,n,r){this.Po[e]=n}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new c0,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{To(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0="ConnectivityMonitor";class d0{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){fe(u0,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){fe(u0,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ll=null;function Lh(){return Ll===null?Ll=function(){return 268435456+Math.round(2147483648*Math.random())}():Ll++,"0x"+Ll.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xd="RestConnection",iN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class oN{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.po=n+"://"+e.host,this.yo=`projects/${r}/databases/${s}`,this.wo=this.databaseId.database===Mc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}So(e,n,r,s,i){const o=Lh(),l=this.bo(e,n.toUriEncodedString());fe(xd,`Sending RPC '${e}' ${o}:`,l,r);const u={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(u,s,i),this.vo(e,l,u,r).then(d=>(fe(xd,`Received RPC '${e}' ${o}: `,d),d),d=>{throw uo(xd,`RPC '${e}' ${o} failed with error: `,d,"url: ",l,"request:",r),d})}Co(e,n,r,s,i,o){return this.So(e,n,r,s,i)}Do(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+To}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}bo(e,n){const r=iN[e];return`${this.po}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const en="WebChannelConnection";class lN extends oN{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,n,r,s){const i=Lh();return new Promise((o,l)=>{const u=new w_;u.setWithCredentials(!0),u.listenOnce(E_.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Jl.NO_ERROR:const m=u.getResponseJson();fe(en,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(m)),o(m);break;case Jl.TIMEOUT:fe(en,`RPC '${e}' ${i} timed out`),l(new me(Z.DEADLINE_EXCEEDED,"Request time out"));break;case Jl.HTTP_ERROR:const g=u.getStatus();if(fe(en,`RPC '${e}' ${i} failed with status:`,g,"response text:",u.getResponseText()),g>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const N=y==null?void 0:y.error;if(N&&N.status&&N.message){const R=function(k){const E=k.toLowerCase().replace(/_/g,"-");return Object.values(Z).indexOf(E)>=0?E:Z.UNKNOWN}(N.status);l(new me(R,N.message))}else l(new me(Z.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new me(Z.UNAVAILABLE,"Connection failed."));break;default:Re()}}finally{fe(en,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);fe(en,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",d,r,15)})}Wo(e,n,r){const s=Lh(),i=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=b_(),l=I_(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Do(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const m=i.join("");fe(en,`Creating RPC '${e}' stream ${s}: ${m}`,u);const g=o.createWebChannel(m,u);let y=!1,N=!1;const R=new aN({Fo:k=>{N?fe(en,`Not sending because RPC '${e}' stream ${s} is closed:`,k):(y||(fe(en,`Opening RPC '${e}' stream ${s} transport.`),g.open(),y=!0),fe(en,`RPC '${e}' stream ${s} sending:`,k),g.send(k))},Mo:()=>g.close()}),j=(k,E,v)=>{k.listen(E,b=>{try{v(b)}catch(P){setTimeout(()=>{throw P},0)}})};return j(g,Xo.EventType.OPEN,()=>{N||(fe(en,`RPC '${e}' stream ${s} transport opened.`),R.Qo())}),j(g,Xo.EventType.CLOSE,()=>{N||(N=!0,fe(en,`RPC '${e}' stream ${s} transport closed`),R.Uo())}),j(g,Xo.EventType.ERROR,k=>{N||(N=!0,uo(en,`RPC '${e}' stream ${s} transport errored:`,k),R.Uo(new me(Z.UNAVAILABLE,"The operation could not be completed")))}),j(g,Xo.EventType.MESSAGE,k=>{var E;if(!N){const v=k.data[0];st(!!v);const b=v,P=(b==null?void 0:b.error)||((E=b[0])===null||E===void 0?void 0:E.error);if(P){fe(en,`RPC '${e}' stream ${s} received error:`,P);const L=P.status;let V=function(w){const _=Rt[w];if(_!==void 0)return sx(_)}(L),T=P.message;V===void 0&&(V=Z.INTERNAL,T="Unknown error status: "+L+" with message "+P.message),N=!0,R.Uo(new me(V,T)),g.close()}else fe(en,`RPC '${e}' stream ${s} received:`,v),R.Ko(v)}}),j(l,T_.STAT_EVENT,k=>{k.stat===bh.PROXY?fe(en,`RPC '${e}' stream ${s} detected buffering proxy`):k.stat===bh.NOPROXY&&fe(en,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.$o()},0),R}}function wd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bu(t){return new hS(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Ti=e,this.timerId=n,this.Go=r,this.zo=s,this.jo=i,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const n=Math.floor(this.Ho+this.e_()),r=Math.max(0,Date.now()-this.Yo),s=Math.max(0,n-r);s>0&&fe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ho} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,s,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h0="PersistentStream";class _x{constructor(e,n,r,s,i,o,l,u){this.Ti=e,this.n_=r,this.r_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new vx(e,n)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,n){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():n&&n.code===Z.RESOURCE_EXHAUSTED?(zr(n.toString()),zr("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):n&&n.code===Z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(n)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),n=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.i_===n&&this.V_(r,s)},r=>{e(()=>{const s=new me(Z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.m_(s)})})}V_(e,n){const r=this.R_(this.i_);this.stream=this.f_(e,n),this.stream.xo(()=>{r(()=>this.listener.xo())}),this.stream.No(()=>{r(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(s=>{r(()=>this.m_(s))}),this.stream.onMessage(s=>{r(()=>++this.__==1?this.g_(s):this.onNext(s))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return fe(h0,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return n=>{this.Ti.enqueueAndForget(()=>this.i_===e?n():(fe(h0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class cN extends _x{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}f_(e,n){return this.connection.Wo("Listen",e,n)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const n=pS(this.serializer,e),r=function(i){if(!("targetChange"in i))return Me.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Me.min():o.readTime?vr(o.readTime):Me.min()}(e);return this.listener.p_(n,r)}y_(e){const n={};n.database=Vh(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=kh(u)?{documents:vS(i,u)}:{query:_S(i,u).ht},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=ax(i,o.resumeToken);const d=Rh(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(Me.min())>0){l.readTime=$c(i,o.snapshotVersion.toTimestamp());const d=Rh(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=wS(this.serializer,e);r&&(n.labels=r),this.I_(n)}w_(e){const n={};n.database=Vh(this.serializer),n.removeTarget=e,this.I_(n)}}class uN extends _x{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,n){return this.connection.Wo("Write",e,n)}g_(e){return st(!!e.streamToken),this.lastStreamToken=e.streamToken,st(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){st(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const n=yS(e.writeResults,e.commitTime),r=vr(e.commitTime);return this.listener.v_(r,n)}C_(){const e={};e.database=Vh(this.serializer),this.I_(e)}b_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>gS(this.serializer,r))};this.I_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{}class hN extends dN{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.F_=!1}M_(){if(this.F_)throw new me(Z.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.So(e,jh(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new me(Z.UNKNOWN,i.toString())})}Co(e,n,r,s,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Co(e,jh(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new me(Z.UNKNOWN,o.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class fN{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(zr(n),this.N_=!1):fe("OnlineStateTracker",n)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ui="RemoteStore";class mN{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=i,this.z_.To(o=>{r.enqueueAndForget(async()=>{vi(this)&&(fe(ui,"Restarting streams for network reachability change."),await async function(u){const d=Le(u);d.W_.add(4),await Za(d),d.j_.set("Unknown"),d.W_.delete(4),await Su(d)}(this))})}),this.j_=new fN(r,s)}}async function Su(t){if(vi(t))for(const e of t.G_)await e(!0)}async function Za(t){for(const e of t.G_)await e(!1)}function xx(t,e){const n=Le(t);n.K_.has(e.targetId)||(n.K_.set(e.targetId,e),cm(n)?lm(n):No(n).c_()&&am(n,e))}function om(t,e){const n=Le(t),r=No(n);n.K_.delete(e),r.c_()&&wx(n,e),n.K_.size===0&&(r.c_()?r.P_():vi(n)&&n.j_.set("Unknown"))}function am(t,e){if(t.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Me.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}No(t).y_(e)}function wx(t,e){t.H_.Ne(e),No(t).w_(e)}function lm(t){t.H_=new lS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>t.K_.get(e)||null,it:()=>t.datastore.serializer.databaseId}),No(t).start(),t.j_.B_()}function cm(t){return vi(t)&&!No(t).u_()&&t.K_.size>0}function vi(t){return Le(t).W_.size===0}function Ex(t){t.H_=void 0}async function pN(t){t.j_.set("Online")}async function gN(t){t.K_.forEach((e,n)=>{am(t,e)})}async function yN(t,e){Ex(t),cm(t)?(t.j_.q_(e),lm(t)):t.j_.set("Unknown")}async function vN(t,e,n){if(t.j_.set("Online"),e instanceof ox&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.K_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.K_.delete(l),s.H_.removeTarget(l))}(t,e)}catch(r){fe(ui,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Wc(t,r)}else if(e instanceof nc?t.H_.We(e):e instanceof ix?t.H_.Ze(e):t.H_.je(e),!n.isEqual(Me.min()))try{const r=await yx(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.H_.ot(o);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const m=i.K_.get(d);m&&i.K_.set(d,m.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,d)=>{const m=i.K_.get(u);if(!m)return;i.K_.set(u,m.withResumeToken(Qt.EMPTY_BYTE_STRING,m.snapshotVersion)),wx(i,u);const g=new fs(m.target,u,d,m.sequenceNumber);am(i,g)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){fe(ui,"Failed to raise snapshot:",r),await Wc(t,r)}}async function Wc(t,e,n){if(!bo(e))throw e;t.W_.add(1),await Za(t),t.j_.set("Offline"),n||(n=()=>yx(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{fe(ui,"Retrying IndexedDB access"),await n(),t.W_.delete(1),await Su(t)})}function Tx(t,e){return e().catch(n=>Wc(t,n,e))}async function Nu(t){const e=Le(t),n=js(e);let r=e.U_.length>0?e.U_[e.U_.length-1].batchId:Hf;for(;_N(e);)try{const s=await eN(e.localStore,r);if(s===null){e.U_.length===0&&n.P_();break}r=s.batchId,xN(e,s)}catch(s){await Wc(e,s)}Ix(e)&&bx(e)}function _N(t){return vi(t)&&t.U_.length<10}function xN(t,e){t.U_.push(e);const n=js(t);n.c_()&&n.S_&&n.b_(e.mutations)}function Ix(t){return vi(t)&&!js(t).u_()&&t.U_.length>0}function bx(t){js(t).start()}async function wN(t){js(t).C_()}async function EN(t){const e=js(t);for(const n of t.U_)e.b_(n.mutations)}async function TN(t,e,n){const r=t.U_.shift(),s=Zf.from(r,e,n);await Tx(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Nu(t)}async function IN(t,e){e&&js(t).S_&&await async function(r,s){if(function(o){return oS(o)&&o!==Z.ABORTED}(s.code)){const i=r.U_.shift();js(r).h_(),await Tx(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Nu(r)}}(t,e),Ix(t)&&bx(t)}async function f0(t,e){const n=Le(t);n.asyncQueue.verifyOperationInProgress(),fe(ui,"RemoteStore received new credentials");const r=vi(n);n.W_.add(3),await Za(n),r&&n.j_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.W_.delete(3),await Su(n)}async function bN(t,e){const n=Le(t);e?(n.W_.delete(2),await Su(n)):e||(n.W_.add(2),await Za(n),n.j_.set("Unknown"))}function No(t){return t.J_||(t.J_=function(n,r,s){const i=Le(n);return i.M_(),new cN(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{xo:pN.bind(null,t),No:gN.bind(null,t),Lo:yN.bind(null,t),p_:vN.bind(null,t)}),t.G_.push(async e=>{e?(t.J_.h_(),cm(t)?lm(t):t.j_.set("Unknown")):(await t.J_.stop(),Ex(t))})),t.J_}function js(t){return t.Y_||(t.Y_=function(n,r,s){const i=Le(n);return i.M_(),new uN(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{xo:()=>Promise.resolve(),No:wN.bind(null,t),Lo:IN.bind(null,t),D_:EN.bind(null,t),v_:TN.bind(null,t)}),t.G_.push(async e=>{e?(t.Y_.h_(),await Nu(t)):(await t.Y_.stop(),t.U_.length>0&&(fe(ui,`Stopping write stream with ${t.U_.length} pending writes`),t.U_=[]))})),t.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Lr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new um(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(Z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function dm(t,e){if(zr("AsyncQueue",`${e}: ${t}`),bo(t))return new me(Z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{static emptySet(e){return new Yi(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Ee.comparator(n.key,r.key):(n,r)=>Ee.comparator(n.key,r.key),this.keyedMap=Jo(),this.sortedSet=new It(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Yi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Yi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{constructor(){this.Z_=new It(Ee.comparator)}track(e){const n=e.doc.key,r=this.Z_.get(n);r?e.type!==0&&r.type===3?this.Z_=this.Z_.insert(n,e):e.type===3&&r.type!==1?this.Z_=this.Z_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Z_=this.Z_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Z_=this.Z_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Z_=this.Z_.remove(n):e.type===1&&r.type===2?this.Z_=this.Z_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Z_=this.Z_.insert(n,{type:2,doc:e.doc}):Re():this.Z_=this.Z_.insert(n,e)}X_(){const e=[];return this.Z_.inorderTraversal((n,r)=>{e.push(r)}),e}}class go{constructor(e,n,r,s,i,o,l,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new go(e,n,Yi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}}class NN{constructor(){this.queries=p0(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(n,r){const s=Le(n),i=s.queries;s.queries=p0(),i.forEach((o,l)=>{for(const u of l.ta)u.onError(r)})})(this,new me(Z.ABORTED,"Firestore shutting down"))}}function p0(){return new gi(t=>q_(t),xu)}async function Sx(t,e){const n=Le(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.na()&&e.ra()&&(r=2):(i=new SN,r=e.ra()?0:1);try{switch(r){case 0:i.ea=await n.onListen(s,!0);break;case 1:i.ea=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=dm(o,`Initialization of query '${Ai(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.ta.push(e),e.sa(n.onlineState),i.ea&&e.oa(i.ea)&&hm(n)}async function Nx(t,e){const n=Le(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ta.indexOf(e);o>=0&&(i.ta.splice(o,1),i.ta.length===0?s=e.ra()?0:1:!i.na()&&e.ra()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function CN(t,e){const n=Le(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.ta)l.oa(s)&&(r=!0);o.ea=s}}r&&hm(n)}function AN(t,e,n){const r=Le(t),s=r.queries.get(e);if(s)for(const i of s.ta)i.onError(n);r.queries.delete(e)}function hm(t){t.ia.forEach(e=>{e.next()})}var Oh,g0;(g0=Oh||(Oh={}))._a="default",g0.Cache="cache";class Cx{constructor(e,n,r){this.query=e,this.aa=n,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=r||{}}oa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new go(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.ua?this.la(e)&&(this.aa.next(e),n=!0):this.ha(e,this.onlineState)&&(this.Pa(e),n=!0),this.ca=e,n}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let n=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),n=!0),n}ha(e,n){if(!e.fromCache||!this.ra())return!0;const r=n!=="Offline";return(!this.options.Ta||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}la(e){if(e.docChanges.length>0)return!0;const n=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Pa(e){e=go.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==Oh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(e){this.key=e}}class kx{constructor(e){this.key=e}}class kN{constructor(e,n){this.query=e,this.fa=n,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=qe(),this.mutatedKeys=qe(),this.ya=G_(e),this.wa=new Yi(this.ya)}get Sa(){return this.fa}ba(e,n){const r=n?n.Da:new m0,s=n?n.wa:this.wa;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((m,g)=>{const y=s.get(m),N=wu(this.query,g)?g:null,R=!!y&&this.mutatedKeys.has(y.key),j=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let k=!1;y&&N?y.data.isEqual(N.data)?R!==j&&(r.track({type:3,doc:N}),k=!0):this.va(y,N)||(r.track({type:2,doc:N}),k=!0,(u&&this.ya(N,u)>0||d&&this.ya(N,d)<0)&&(l=!0)):!y&&N?(r.track({type:0,doc:N}),k=!0):y&&!N&&(r.track({type:1,doc:y}),k=!0,(u||d)&&(l=!0)),k&&(N?(o=o.add(N),i=j?i.add(m):i.delete(m)):(o=o.delete(m),i=i.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),i=i.delete(m.key),r.track({type:1,doc:m})}return{wa:o,Da:r,ls:l,mutatedKeys:i}}va(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const o=e.Da.X_();o.sort((m,g)=>function(N,R){const j=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Re()}};return j(N)-j(R)}(m.type,g.type)||this.ya(m.doc,g.doc)),this.Ca(r),s=s!=null&&s;const l=n&&!s?this.Fa():[],u=this.pa.size===0&&this.current&&!s?1:0,d=u!==this.ga;return this.ga=u,o.length!==0||d?{snapshot:new go(this.query,e.wa,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ma:l}:{Ma:l}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new m0,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(n=>this.fa=this.fa.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.fa=this.fa.delete(n)),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=qe(),this.wa.forEach(r=>{this.xa(r.key)&&(this.pa=this.pa.add(r.key))});const n=[];return e.forEach(r=>{this.pa.has(r)||n.push(new kx(r))}),this.pa.forEach(r=>{e.has(r)||n.push(new Ax(r))}),n}Oa(e){this.fa=e.gs,this.pa=qe();const n=this.ba(e.documents);return this.applyChanges(n,!0)}Na(){return go.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const fm="SyncEngine";class PN{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class RN{constructor(e){this.key=e,this.Ba=!1}}class jN{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new gi(l=>q_(l),xu),this.qa=new Map,this.Qa=new Set,this.$a=new It(Ee.comparator),this.Ua=new Map,this.Ka=new nm,this.Wa={},this.Ga=new Map,this.za=po.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function DN(t,e,n=!0){const r=Mx(t);let s;const i=r.ka.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Na()):s=await Px(r,e,n,!0),s}async function VN(t,e){const n=Mx(t);await Px(n,e,!0,!1)}async function Px(t,e,n,r){const s=await tN(t.localStore,gr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await MN(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&xx(t.remoteStore,s),l}async function MN(t,e,n,r,s){t.Ha=(g,y,N)=>async function(j,k,E,v){let b=k.view.ba(E);b.ls&&(b=await l0(j.localStore,k.query,!1).then(({documents:T})=>k.view.ba(T,b)));const P=v&&v.targetChanges.get(k.targetId),L=v&&v.targetMismatches.get(k.targetId)!=null,V=k.view.applyChanges(b,j.isPrimaryClient,P,L);return v0(j,k.targetId,V.Ma),V.snapshot}(t,g,y,N);const i=await l0(t.localStore,e,!0),o=new kN(e,i.gs),l=o.ba(i.documents),u=Ja.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(l,t.isPrimaryClient,u);v0(t,n,d.Ma);const m=new PN(e,n,o);return t.ka.set(e,m),t.qa.has(n)?t.qa.get(n).push(e):t.qa.set(n,[e]),d.snapshot}async function LN(t,e,n){const r=Le(t),s=r.ka.get(e),i=r.qa.get(s.targetId);if(i.length>1)return r.qa.set(s.targetId,i.filter(o=>!xu(o,e))),void r.ka.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Mh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&om(r.remoteStore,s.targetId),Fh(r,s.targetId)}).catch(Io)):(Fh(r,s.targetId),await Mh(r.localStore,s.targetId,!0))}async function ON(t,e){const n=Le(t),r=n.ka.get(e),s=n.qa.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),om(n.remoteStore,r.targetId))}async function FN(t,e,n){const r=qN(t);try{const s=await function(o,l){const u=Le(o),d=Lt.now(),m=l.reduce((N,R)=>N.add(R.key),qe());let g,y;return u.persistence.runTransaction("Locally write mutations","readwrite",N=>{let R=Wr(),j=qe();return u.ds.getEntries(N,m).next(k=>{R=k,R.forEach((E,v)=>{v.isValidDocument()||(j=j.add(E))})}).next(()=>u.localDocuments.getOverlayedDocuments(N,R)).next(k=>{g=k;const E=[];for(const v of l){const b=tS(v,g.get(v.key).overlayedDocument);b!=null&&E.push(new yi(v.key,b,O_(b.value.mapValue),yr.exists(!0)))}return u.mutationQueue.addMutationBatch(N,d,E,l)}).next(k=>{y=k;const E=k.applyToLocalDocumentSet(g,j);return u.documentOverlayCache.saveOverlays(N,k.batchId,E)})}).then(()=>({batchId:y.batchId,changes:Q_(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let d=o.Wa[o.currentUser.toKey()];d||(d=new It($e)),d=d.insert(l,u),o.Wa[o.currentUser.toKey()]=d}(r,s.batchId,n),await el(r,s.changes),await Nu(r.remoteStore)}catch(s){const i=dm(s,"Failed to persist write");n.reject(i)}}async function Rx(t,e){const n=Le(t);try{const r=await JS(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Ua.get(i);o&&(st(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Ba=!0:s.modifiedDocuments.size>0?st(o.Ba):s.removedDocuments.size>0&&(st(o.Ba),o.Ba=!1))}),await el(n,r,e)}catch(r){await Io(r)}}function y0(t,e,n){const r=Le(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.ka.forEach((i,o)=>{const l=o.view.sa(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=Le(o);u.onlineState=l;let d=!1;u.queries.forEach((m,g)=>{for(const y of g.ta)y.sa(l)&&(d=!0)}),d&&hm(u)}(r.eventManager,e),s.length&&r.La.p_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function UN(t,e,n){const r=Le(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Ua.get(e),i=s&&s.key;if(i){let o=new It(Ee.comparator);o=o.insert(i,rn.newNoDocument(i,Me.min()));const l=qe().add(i),u=new Iu(Me.min(),new Map,new It($e),o,l);await Rx(r,u),r.$a=r.$a.remove(i),r.Ua.delete(e),mm(r)}else await Mh(r.localStore,e,!1).then(()=>Fh(r,e,n)).catch(Io)}async function BN(t,e){const n=Le(t),r=e.batch.batchId;try{const s=await XS(n.localStore,e);Dx(n,r,null),jx(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await el(n,s)}catch(s){await Io(s)}}async function $N(t,e,n){const r=Le(t);try{const s=await function(o,l){const u=Le(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return u.mutationQueue.lookupMutationBatch(d,l).next(g=>(st(g!==null),m=g.keys(),u.mutationQueue.removeMutationBatch(d,g))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,m,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>u.localDocuments.getDocuments(d,m))})}(r.localStore,e);Dx(r,e,n),jx(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await el(r,s)}catch(s){await Io(s)}}function jx(t,e){(t.Ga.get(e)||[]).forEach(n=>{n.resolve()}),t.Ga.delete(e)}function Dx(t,e,n){const r=Le(t);let s=r.Wa[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Wa[r.currentUser.toKey()]=s}}function Fh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.qa.get(e))t.ka.delete(r),n&&t.La.Ja(r,n);t.qa.delete(e),t.isPrimaryClient&&t.Ka.br(e).forEach(r=>{t.Ka.containsKey(r)||Vx(t,r)})}function Vx(t,e){t.Qa.delete(e.path.canonicalString());const n=t.$a.get(e);n!==null&&(om(t.remoteStore,n),t.$a=t.$a.remove(e),t.Ua.delete(n),mm(t))}function v0(t,e,n){for(const r of n)r instanceof Ax?(t.Ka.addReference(r.key,e),zN(t,r)):r instanceof kx?(fe(fm,"Document no longer in limbo: "+r.key),t.Ka.removeReference(r.key,e),t.Ka.containsKey(r.key)||Vx(t,r.key)):Re()}function zN(t,e){const n=e.key,r=n.path.canonicalString();t.$a.get(n)||t.Qa.has(r)||(fe(fm,"New document in limbo: "+n),t.Qa.add(r),mm(t))}function mm(t){for(;t.Qa.size>0&&t.$a.size<t.maxConcurrentLimboResolutions;){const e=t.Qa.values().next().value;t.Qa.delete(e);const n=new Ee(pt.fromString(e)),r=t.za.next();t.Ua.set(r,new RN(n)),t.$a=t.$a.insert(n,r),xx(t.remoteStore,new fs(gr(Yf(n.path)),r,"TargetPurposeLimboResolution",yu.ae))}}async function el(t,e,n){const r=Le(t),s=[],i=[],o=[];r.ka.isEmpty()||(r.ka.forEach((l,u)=>{o.push(r.Ha(u,e,n).then(d=>{var m;if((d||n)&&r.isPrimaryClient){const g=d?!d.fromCache:(m=n==null?void 0:n.targetChanges.get(u.targetId))===null||m===void 0?void 0:m.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(d){s.push(d);const g=sm.Yi(u.targetId,d);i.push(g)}}))}),await Promise.all(o),r.La.p_(s),await async function(u,d){const m=Le(u);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>ee.forEach(d,y=>ee.forEach(y.Hi,N=>m.persistence.referenceDelegate.addReference(g,y.targetId,N)).next(()=>ee.forEach(y.Ji,N=>m.persistence.referenceDelegate.removeReference(g,y.targetId,N)))))}catch(g){if(!bo(g))throw g;fe(im,"Failed to update sequence numbers: "+g)}for(const g of d){const y=g.targetId;if(!g.fromCache){const N=m.Ts.get(y),R=N.snapshotVersion,j=N.withLastLimboFreeSnapshotVersion(R);m.Ts=m.Ts.insert(y,j)}}}(r.localStore,i))}async function WN(t,e){const n=Le(t);if(!n.currentUser.isEqual(e)){fe(fm,"User change. New user:",e.toKey());const r=await gx(n.localStore,e);n.currentUser=e,function(i,o){i.Ga.forEach(l=>{l.forEach(u=>{u.reject(new me(Z.CANCELLED,o))})}),i.Ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await el(n,r.Rs)}}function HN(t,e){const n=Le(t),r=n.Ua.get(e);if(r&&r.Ba)return qe().add(r.key);{let s=qe();const i=n.qa.get(e);if(!i)return s;for(const o of i){const l=n.ka.get(o);s=s.unionWith(l.view.Sa)}return s}}function Mx(t){const e=Le(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Rx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=HN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=UN.bind(null,e),e.La.p_=CN.bind(null,e.eventManager),e.La.Ja=AN.bind(null,e.eventManager),e}function qN(t){const e=Le(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=BN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$N.bind(null,e),e}class Hc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=bu(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,n){return null}nu(e,n){return null}eu(e){return YS(this.persistence,new GS,e.initialUser,this.serializer)}Xa(e){return new px(rm.ri,this.serializer)}Za(e){return new rN}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hc.provider={build:()=>new Hc};class GN extends Hc{constructor(e){super(),this.cacheSizeBytes=e}tu(e,n){st(this.persistence.referenceDelegate instanceof zc);const r=this.persistence.referenceDelegate.garbageCollector;return new RS(r,e.asyncQueue,n)}Xa(e){const n=this.cacheSizeBytes!==void 0?gn.withCacheSize(this.cacheSizeBytes):gn.DEFAULT;return new px(r=>zc.ri(r,n),this.serializer)}}class Uh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>y0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=WN.bind(null,this.syncEngine),await bN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new NN}()}createDatastore(e){const n=bu(e.databaseInfo.databaseId),r=function(i){return new lN(i)}(e.databaseInfo);return function(i,o,l,u){return new hN(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new mN(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>y0(this.syncEngine,n,0),function(){return d0.D()?new d0:new sN}())}createSyncEngine(e,n){return function(s,i,o,l,u,d,m){const g=new jN(s,i,o,l,u,d);return m&&(g.ja=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Le(s);fe(ui,"RemoteStore shutting down."),i.W_.add(5),await Za(i),i.z_.shutdown(),i.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Uh.provider={build:()=>new Uh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):zr("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ds="FirestoreClient";class KN{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=tn.UNAUTHENTICATED,this.clientId=C_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{fe(Ds,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(fe(Ds,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Lr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=dm(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ed(t,e){t.asyncQueue.verifyOperationInProgress(),fe(Ds,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await gx(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function _0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await QN(t);fe(Ds,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>f0(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>f0(e.remoteStore,s)),t._onlineComponents=e}async function QN(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){fe(Ds,"Using user provided OfflineComponentProvider");try{await Ed(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===Z.FAILED_PRECONDITION||s.code===Z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;uo("Error using user provided cache. Falling back to memory cache: "+n),await Ed(t,new Hc)}}else fe(Ds,"Using default OfflineComponentProvider"),await Ed(t,new GN(void 0));return t._offlineComponents}async function Ox(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(fe(Ds,"Using user provided OnlineComponentProvider"),await _0(t,t._uninitializedComponentsProvider._online)):(fe(Ds,"Using default OnlineComponentProvider"),await _0(t,new Uh))),t._onlineComponents}function YN(t){return Ox(t).then(e=>e.syncEngine)}async function Fx(t){const e=await Ox(t),n=e.eventManager;return n.onListen=DN.bind(null,e.syncEngine),n.onUnlisten=LN.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=VN.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=ON.bind(null,e.syncEngine),n}function XN(t,e,n={}){const r=new Lr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const m=new Lx({next:y=>{m.su(),o.enqueueAndForget(()=>Nx(i,g));const N=y.docs.has(l);!N&&y.fromCache?d.reject(new me(Z.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&y.fromCache&&u&&u.source==="server"?d.reject(new me(Z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(y)},error:y=>d.reject(y)}),g=new Cx(Yf(l.path),m,{includeMetadataChanges:!0,Ta:!0});return Sx(i,g)}(await Fx(t),t.asyncQueue,e,n,r)),r.promise}function JN(t,e,n={}){const r=new Lr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const m=new Lx({next:y=>{m.su(),o.enqueueAndForget(()=>Nx(i,g)),y.fromCache&&u.source==="server"?d.reject(new me(Z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),g=new Cx(l,m,{includeMetadataChanges:!0,Ta:!0});return Sx(i,g)}(await Fx(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ux(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(t,e,n){if(!n)throw new me(Z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function ZN(t,e,n,r){if(e===!0&&r===!0)throw new me(Z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function w0(t){if(!Ee.isDocumentKey(t))throw new me(Z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function E0(t){if(Ee.isDocumentKey(t))throw new me(Z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Cu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Re()}function Vs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new me(Z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Cu(t);throw new me(Z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function eC(t,e){if(e<=0)throw new me(Z.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x="firestore.googleapis.com",T0=!0;class I0{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new me(Z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$x,this.ssl=T0}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:T0;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=mx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<kS)throw new me(Z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ZN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ux((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new me(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new me(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new me(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Au{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new I0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(Z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(Z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new I0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new ab;switch(r.type){case"firstParty":return new db(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new me(Z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=x0.get(n);r&&(fe("ComponentProvider","Removing Datastore"),x0.delete(n),r.terminate())}(this),Promise.resolve()}}function tC(t,e,n,r={}){var s;const i=(t=Vs(t,Au))._getSettings(),o=Object.assign(Object.assign({},i),{emulatorOptions:t._getEmulatorOptions()}),l=`${e}:${n}`;i.host!==$x&&i.host!==l&&uo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},i),{host:l,ssl:!1,emulatorOptions:r});if(!ai(u,o)&&(t._setSettings(u),r.mockUserToken)){let d,m;if(typeof r.mockUserToken=="string")d=r.mockUserToken,m=tn.MOCK_USER;else{d=M1(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new me(Z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new tn(g)}t._authCredentials=new lb(new S_(d,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Fs(this.firestore,e,this._query)}}class En{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ss(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new En(this.firestore,e,this._key)}}class Ss extends Fs{constructor(e,n,r){super(e,n,Yf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new En(this.firestore,null,new Ee(e))}withConverter(e){return new Ss(this.firestore,e,this._path)}}function di(t,e,...n){if(t=Tn(t),Bx("collection","path",e),t instanceof Au){const r=pt.fromString(e,...n);return E0(r),new Ss(t,null,r)}{if(!(t instanceof En||t instanceof Ss))throw new me(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(pt.fromString(e,...n));return E0(r),new Ss(t.firestore,null,r)}}function We(t,e,...n){if(t=Tn(t),arguments.length===1&&(e=C_.newId()),Bx("doc","path",e),t instanceof Au){const r=pt.fromString(e,...n);return w0(r),new En(t,null,new Ee(r))}{if(!(t instanceof En||t instanceof Ss))throw new me(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(pt.fromString(e,...n));return w0(r),new En(t.firestore,t instanceof Ss?t.converter:null,new Ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0="AsyncQueue";class S0{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new vx(this,"async_queue_retry"),this.Su=()=>{const r=wd();r&&fe(b0,"Visibility state changed to "+r.visibilityState),this.a_.t_()},this.bu=e;const n=wd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const n=wd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const n=new Lr;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!bo(e))throw e;fe(b0,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){const n=this.bu.then(()=>(this.pu=!0,e().catch(r=>{this.gu=r,this.pu=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw zr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.pu=!1,r))));return this.bu=n,n}enqueueAfterDelay(e,n,r){this.Du(),this.wu.indexOf(e)>-1&&(n=0);const s=um.createAndSchedule(this,e,n,r,i=>this.Fu(i));return this.fu.push(s),s}Du(){this.gu&&Re()}verifyOperationInProgress(){}async Mu(){let e;do e=this.bu,await e;while(e!==this.bu)}xu(e){for(const n of this.fu)if(n.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.fu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const n=this.fu.indexOf(e);this.fu.splice(n,1)}}class tl extends Au{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new S0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new S0(e),this._firestoreClient=void 0,await e}}}function pm(t,e){const n=typeof t=="object"?t:y_(),r=typeof t=="string"?t:Mc,s=zf(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=D1("firestore");i&&tC(s,...i)}return s}function gm(t){if(t._terminated)throw new me(Z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||nC(t),t._firestoreClient}function nC(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,d,m){return new Sb(l,u,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,Ux(m.experimentalLongPollingOptions),m.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new KN(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yo(Qt.fromBase64String(e))}catch(n){throw new me(Z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new yo(Qt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new me(Z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new me(Z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new me(Z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return $e(this._lat,e._lat)||$e(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=/^__.*__$/;class sC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new yi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Xa(e,this.data,n,this.fieldTransforms)}}function Wx(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Re()}}class xm{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Bu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new xm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ku({path:r,Qu:!1});return s.$u(e),s}Uu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ku({path:r,Qu:!1});return s.Bu(),s}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return qc(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(e.length===0)throw this.Wu("Document fields must not be empty");if(Wx(this.Lu)&&rC.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class iC{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||bu(e)}ju(e,n,r,s=!1){return new xm({Lu:e,methodName:n,zu:r,path:qt.emptyPath(),Qu:!1,Gu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hx(t){const e=t._freezeSettings(),n=bu(t._databaseId);return new iC(t._databaseId,!!e.ignoreUndefinedProperties,n)}function oC(t,e,n,r,s,i={}){const o=t.ju(i.merge||i.mergeFields?2:0,e,n,s);Kx("Data must be an object, but it was:",o,r);const l=qx(r,o);let u,d;if(i.merge)u=new er(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const m=[];for(const g of i.mergeFields){const y=lC(e,g,n);if(!o.contains(y))throw new me(Z.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);uC(m,y)||m.push(y)}u=new er(m),d=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,d=o.fieldTransforms;return new sC(new Un(l),u,d)}function aC(t,e,n,r=!1){return wm(n,t.ju(r?4:3,e))}function wm(t,e){if(Gx(t=Tn(t)))return Kx("Unsupported field value:",e,t),qx(t,e);if(t instanceof zx)return function(r,s){if(!Wx(s.Lu))throw s.Wu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Wu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Qu&&e.Lu!==4)throw e.Wu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let u=wm(l,s.Ku(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Tn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Qb(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Lt.fromDate(r);return{timestampValue:$c(s.serializer,i)}}if(r instanceof Lt){const i=new Lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:$c(s.serializer,i)}}if(r instanceof vm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof yo)return{bytesValue:ax(s.serializer,r._byteString)};if(r instanceof En){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Wu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:tm(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof _m)return function(o,l){return{mapValue:{fields:{[M_]:{stringValue:L_},[Lc]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw l.Wu("VectorValues must only contain numeric values.");return Xf(l.serializer,d)})}}}}}}(r,s);throw s.Wu(`Unsupported field value: ${Cu(r)}`)}(t,e)}function qx(t,e){const n={};return k_(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pi(t,(r,s)=>{const i=wm(s,e.qu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Gx(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Lt||t instanceof vm||t instanceof yo||t instanceof En||t instanceof zx||t instanceof _m)}function Kx(t,e,n){if(!Gx(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Cu(n);throw r==="an object"?e.Wu(t+" a custom object"):e.Wu(t+" "+r)}}function lC(t,e,n){if((e=Tn(e))instanceof ym)return e._internalPath;if(typeof e=="string")return Qx(t,e);throw qc("Field path arguments must be of type string or ",t,!1,void 0,n)}const cC=new RegExp("[~\\*/\\[\\]]");function Qx(t,e,n){if(e.search(cC)>=0)throw qc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ym(...e.split("."))._internalPath}catch{throw qc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function qc(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new me(Z.INVALID_ARGUMENT,l+t+u)}function uC(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yx{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new En(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new dC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ku("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class dC extends Yx{data(){return super.data()}}function ku(t,e){return typeof e=="string"?Qx(t,e):e instanceof ym?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hC(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new me(Z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Em{}class Tm extends Em{}function ur(t,e,...n){let r=[];e instanceof Em&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof Im).length,l=i.filter(u=>u instanceof Pu).length;if(o>1||o>0&&l>0)throw new me(Z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Pu extends Tm{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Pu(e,n,r)}_apply(e){const n=this._parse(e);return Xx(e._query,n),new Fs(e.firestore,e.converter,Ph(e._query,n))}_parse(e){const n=Hx(e.firestore);return function(i,o,l,u,d,m,g){let y;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new me(Z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){C0(g,m);const R=[];for(const j of g)R.push(N0(u,i,j));y={arrayValue:{values:R}}}else y=N0(u,i,g)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||C0(g,m),y=aC(l,o,g,m==="in"||m==="not-in");return Dt.create(d,m,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ma(t,e,n){const r=e,s=ku("where",t);return Pu._create(s,r,n)}class Im extends Em{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Im(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:or.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)Xx(o,u),o=Ph(o,u)}(e._query,n),new Fs(e.firestore,e.converter,Ph(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class bm extends Tm{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new bm(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new me(Z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new me(Z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ua(i,o)}(e._query,this._field,this._direction);return new Fs(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new So(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Td(t,e="asc"){const n=e,r=ku("orderBy",t);return bm._create(r,n)}class Sm extends Tm{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Sm(e,n,r)}_apply(e){return new Fs(e.firestore,e.converter,Fc(e._query,this._limit,this._limitType))}}function Nr(t){return eC("limit",t),Sm._create("limit",t,"F")}function N0(t,e,n){if(typeof(n=Tn(n))=="string"){if(n==="")throw new me(Z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!H_(e)&&n.indexOf("/")!==-1)throw new me(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(pt.fromString(n));if(!Ee.isDocumentKey(r))throw new me(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return zg(t,new Ee(r))}if(n instanceof En)return zg(t,n._key);throw new me(Z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Cu(n)}.`)}function C0(t,e){if(!Array.isArray(t)||t.length===0)throw new me(Z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Xx(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new me(Z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(Z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class fC{convertValue(e,n="none"){switch(Rs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return At(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ps(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Re()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return pi(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[Lc].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>At(o.doubleValue));return new _m(i)}convertGeoPoint(e){return new vm(At(e.latitude),At(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=_u(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(La(e));default:return null}}convertTimestamp(e){const n=ks(e);return new Lt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=pt.fromString(e);st(fx(r));const s=new Oa(r.get(1),r.get(3)),i=new Ee(r.popFirst(5));return s.isEqual(n)||zr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mC(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Jx extends Yx{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new rc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ku("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class rc extends Jx{data(e={}){return super.data(e)}}class pC{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new ea(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new rc(this._firestore,this._userDataWriter,r.key,r,new ea(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new me(Z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new rc(s._firestore,s._userDataWriter,l.doc.key,l.doc,new ea(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new rc(s._firestore,s._userDataWriter,l.doc.key,l.doc,new ea(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,m=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),m=o.indexOf(l.doc.key)),{type:gC(l.type),doc:u,oldIndex:d,newIndex:m}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function gC(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(t){t=Vs(t,En);const e=Vs(t.firestore,tl);return XN(gm(e),t._key).then(n=>vC(e,t,n))}class Zx extends fC{constructor(e){super(),this.firestore=e}convertBytes(e){return new yo(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new En(this.firestore,null,n)}}function dr(t){t=Vs(t,Fs);const e=Vs(t.firestore,tl),n=gm(e),r=new Zx(e);return hC(t._query),JN(n,t._query).then(s=>new pC(e,r,t,s))}function tt(t,e,n){t=Vs(t,En);const r=Vs(t.firestore,tl),s=mC(t.converter,e);return ew(r,[oC(Hx(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,yr.none())])}function yC(t){return ew(Vs(t.firestore,tl),[new Jf(t._key,yr.none())])}function ew(t,e){return function(r,s){const i=new Lr;return r.asyncQueue.enqueueAndForget(async()=>FN(await YN(r),s,i)),i.promise}(gm(t),e)}function vC(t,e,n){const r=n.docs.get(e._key),s=new Zx(t);return new Jx(t,s,e._key,r,new ea(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){To=s})(Eo),co(new li("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new tl(new cb(r.getProvider("auth-internal")),new hb(o,r.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new me(Z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Oa(d.options.projectId,m)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Is(Pg,Rg,e),Is(Pg,Rg,"esm2017")})();function tw({children:t,className:e=""}){return c.jsx("div",{className:`bg-gray-900 text-gray-100 min-h-screen p-6 ${e}`,children:t})}const pa=t=>c.jsx("input",{...t,className:"border border-gray-600 bg-gray-700 text-white rounded px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-400"}),un=({children:t,className:e="",...n})=>c.jsx("button",{...n,className:`px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 ${e}`,children:t}),A0=({children:t,className:e="",...n})=>c.jsx("select",{...n,className:`border border-gray-600 bg-gray-800 text-white rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 ${e}`,style:{backgroundColor:"#1f2937",color:"#f9fafb",WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23FFFFFF%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right 0.7rem top 50%",backgroundSize:"0.65rem auto",paddingRight:"2rem"},children:to.Children.map(t,r=>r&&(r.type==="option"?to.cloneElement(r,{className:"bg-gray-800 text-white"}):r))});function _C(t,e,n){const r=t.filter(k=>k.active),o=[...[...r.map(k=>({...k,isBench:!1,score:n(k)}))].sort(()=>Math.random()-.5)].sort((k,E)=>E.score-k.score),l=Math.floor(r.length/e),u=Math.max(2,l-l%2),d=Array.from({length:u},()=>[]),m=u*e,g=o.slice(0,m);for(let k=0;k<g.length;k++){const E=Math.floor(k/u);let v;E%2===0?v=k%u:v=u-1-k%u,d[v].push(g[k])}const y=o.slice(m);y.forEach(k=>{k.isBench=!0}),y.forEach(k=>{const E=d.map(b=>b.reduce((P,L)=>P+L.score,0)),v=E.indexOf(Math.min(...E));d[v].push(k)});const N=k=>{if(!k||k.length===0)return 0;const E=k.filter(L=>L&&L.isBench===!1),v=k.filter(L=>L&&L.isBench===!0);if(E.length===0)return 0;const b=E.reduce((L,V)=>L+V.score,0)/E.length,P=v.length>0?v.reduce((L,V)=>L+V.score,0)/v.length:0;return b*.9+P*.1};for(let k=0;k<30;k++){const E=d.map(N),v=E.reduce((_,S)=>_+S,0)/E.length,b=E.reduce((_,S)=>_+Math.pow(S-v,2),0)/E.length,P=Math.sqrt(b);if(P<.05)break;const L=E.indexOf(Math.max(...E)),V=E.indexOf(Math.min(...E));if(L===V)break;let T=!1;const p=d[L].filter(_=>_&&!_.isBench),w=d[V].filter(_=>_&&!_.isBench);for(let _=0;_<p.length&&!T;_++)for(let S=0;S<w.length&&!T;S++){const C=d[L].indexOf(p[_]),I=d[V].indexOf(w[S]),ce=d[L][C];d[L][C]=d[V][I],d[V][I]=ce;const Be=d.map(N),q=Be.reduce((ne,$)=>ne+$,0)/Be.length,X=Be.reduce((ne,$)=>ne+Math.pow($-q,2),0)/Be.length;if(Math.sqrt(X)<P)T=!0;else{const ne=d[L][C];d[L][C]=d[V][I],d[V][I]=ne}}if(!T){const _=d[L].filter(C=>C&&C.isBench),S=d[V].filter(C=>C&&C.isBench);for(let C=0;C<_.length&&!T;C++)for(let I=0;I<S.length&&!T;I++){const ce=d[L].indexOf(_[C]),Be=d[V].indexOf(S[I]),q=d[L][ce];d[L][ce]=d[V][Be],d[V][Be]=q;const X=d.map(N),W=X.reduce((Y,J)=>Y+J,0)/X.length,ne=X.reduce((Y,J)=>Y+Math.pow(J-W,2),0)/X.length;if(Math.sqrt(ne)<P)T=!0;else{const Y=d[L][ce];d[L][ce]=d[V][Be],d[V][Be]=Y}}}if(!T)break}return d.forEach(k=>{k.sort((E,v)=>v.score-E.score),k.forEach((E,v)=>{E.isBench=v>=e})}),((k,E)=>{const v=k.map(P=>({team:P,strength:E(P)}));v.sort((P,L)=>L.strength-P.strength);const b=[];if(v.length===4){const P=Math.abs(v[0].strength-v[1].strength)+Math.abs(v[2].strength-v[3].strength),L=Math.abs(v[0].strength-v[2].strength)+Math.abs(v[1].strength-v[3].strength),V=Math.abs(v[0].strength-v[3].strength)+Math.abs(v[1].strength-v[2].strength);P<=L&&P<=V?(b.push([v[0].team,v[1].team]),b.push([v[2].team,v[3].team])):L<=P&&L<=V?(b.push([v[0].team,v[2].team]),b.push([v[1].team,v[3].team])):(b.push([v[0].team,v[3].team]),b.push([v[1].team,v[2].team]))}else{const P=[...v];for(;P.length>=2;){const L=P.shift();let V=0,T=Math.abs(L.strength-P[0].strength);for(let w=1;w<P.length;w++){const _=Math.abs(L.strength-P[w].strength);_<T&&(T=_,V=w)}const p=P.splice(V,1)[0];b.push([L.team,p.team])}}return{teams:k,matchups:b}})(d,N)}function xC({title:t,titleId:e,...n},r){return U.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?U.createElement("title",{id:e},t):null,U.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"}))}const wC=U.forwardRef(xC);function nw({text:t,position:e="top"}){var s,i;const[n,r]=U.useState(!1);return U.useEffect(()=>{let o;return n&&window.innerWidth<768&&(o=setTimeout(()=>{r(!1)},3e3)),()=>clearTimeout(o)},[n]),c.jsxs("div",{className:"relative group inline-block",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onClick:()=>r(!0),children:[c.jsx(wC,{className:"w-4 h-4 text-blue-400 cursor-pointer inline"}),c.jsx("div",{className:`fixed z-[1000] w-64 bg-black text-white text-sm px-3 py-2 rounded shadow-lg ${n?"block":"hidden"}`,style:{left:n?((s=window.event)==null?void 0:s.clientX)+10:0,top:n?((i=window.event)==null?void 0:i.clientY)-10:0},children:t})]})}function EC({title:t,titleId:e,...n},r){return U.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?U.createElement("title",{id:e},t):null,U.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 9a.75.75 0 0 0-1.5 0v2.25H9a.75.75 0 0 0 0 1.5h2.25V15a.75.75 0 0 0 1.5 0v-2.25H15a.75.75 0 0 0 0-1.5h-2.25V9Z",clipRule:"evenodd"}))}const TC=U.forwardRef(EC),rw={scoring:"Ability to score consistently and create shots.",defense:"On-ball defense, help-side positioning, effort.",rebounding:"Positioning and effort on offensive/defensive glass.",playmaking:"Court vision, passing, and decision-making.",stamina:"Endurance to stay active and impactful.",physicality:"Strength, toughness, and ability to play through contact.",xfactor:"Intangibles — leadership, clutch play, and hustle."},jr={snowflake:{name:"Flake",icon:"❄️",description:"For a player that doesn't show up to play",isNegative:!0},toiletPaper:{name:"Soft",icon:"🧻",description:"For a player who plays soft",isNegative:!0},hog:{name:"Ball Hog",icon:"🐷",description:"For a player who hogs the ball",isNegative:!0},brickLayer:{name:"Brick Layer",icon:"🧱",description:"For the player who takes the most questionable shot attempts",isNegative:!0},bullseye:{name:"Sharp Shooter",icon:"🎯",description:"Player who shows great shooting skills",isNegative:!1},general:{name:"General",icon:"🎖️",description:"For the best on-court leader and communicator",isNegative:!1},warrior:{name:"Warrior",icon:"⚔️",description:"For the player who plays through pain and never backs down from contact",isNegative:!1},clutchGene:{name:"Clutch",icon:"🧬",description:"For the player who consistently performs in pressure moments",isNegative:!1},motor:{name:"Motor",icon:"⚡",description:"Player who shows the most hustle",isNegative:!1},infinityGauntlet:{name:"Has It All",icon:"🧤",description:"The best all-around player that can do it all",isNegative:!1}},k0=(t,e={})=>{if(!t||typeof t!="object")return e;const n={};Object.keys(jr).forEach(s=>{n[s]={}}),Object.values(t).forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,o])=>{!i||!o||typeof i!="string"||typeof o!="string"||jr[i]&&(n[i][o]||(n[i][o]=0),n[i][o]++)})});const r={...e};return Object.entries(n).forEach(([s,i])=>{const o=e[s];let l=0,u=null;if(Object.entries(i).forEach(([d,m])=>{m>l&&(l=m,u=d)}),!o)u&&l>=5&&(r[s]={playerName:u,votes:l});else{const d=i[o.playerName]||0;r[s]={...o,votes:d},u&&u!==o.playerName&&l>d&&(r[s]={playerName:u,votes:l})}}),r},sc=to.memo(function({playerName:e,currentBelts:n,size:r}){const[s,i]=U.useState(null),o=Object.entries(n).filter(([y,N])=>(N==null?void 0:N.playerName)===e).map(([y,N])=>({beltId:y,...jr[y]}));if(o.length===0)return null;const l={small:{container:"w-5 h-5",icon:"text-xs",gap:"gap-0.5"},normal:{container:"w-7 h-7",icon:"text-sm",gap:"gap-1"}},u=l[r]||l.normal,d=y=>{i(s===y?null:y)},m=y=>{i(y)},g=()=>{i(null)};return c.jsx("div",{className:`flex items-center ${u.gap} ml-2`,children:o.map(y=>c.jsxs("div",{className:"relative inline-block",children:[c.jsx("div",{className:`${u.container} rounded-full flex items-center justify-center cursor-pointer transition-all duration-200 hover:scale-110 border ${y.isNegative?"bg-red-900 bg-opacity-20 border-red-500 hover:bg-opacity-30":"bg-green-900 bg-opacity-20 border-green-500 hover:bg-opacity-30"}`,onClick:()=>d(y.beltId),onMouseEnter:()=>m(y.beltId),onMouseLeave:g,role:"button",tabIndex:0,children:c.jsx("span",{className:u.icon,children:y.icon})}),s===y.beltId&&c.jsxs("div",{className:`absolute z-50 px-2 py-1 text-xs font-medium text-white rounded shadow-lg pointer-events-none
                            ${y.isNegative?"bg-red-800":"bg-green-800"}
                            bottom-full left-1/2 transform -translate-x-1/2 mb-1 whitespace-nowrap
                        `,children:[y.name,c.jsx("div",{className:`absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 
                                border-l-4 border-r-4 border-transparent
                                ${y.isNegative?"border-t-4 border-t-red-800":"border-t-4 border-t-green-800"}
                            `})]})]},y.beltId))})},(t,e)=>t.playerName===e.playerName&&t.size===e.size&&JSON.stringify(t.currentBelts)===JSON.stringify(e.currentBelts)),Xi={gamesPlayed:{name:"Vet",description:"Total Games Played",tiers:{bronze:{threshold:50,name:"Up-and-Comer",color:"text-amber-600",bgGradient:"from-amber-900 to-amber-700",borderColor:"border-amber-600",glowColor:"shadow-amber-500/50"},silver:{threshold:100,name:"Seasoned Vet",color:"text-slate-300",bgGradient:"from-slate-700 to-slate-500",borderColor:"border-slate-400",glowColor:"shadow-slate-400/50"},gold:{threshold:200,name:"Gold Legend",color:"text-yellow-300",bgGradient:"from-yellow-700 to-yellow-500",borderColor:"border-yellow-400",glowColor:"shadow-yellow-400/50"},amethyst:{threshold:500,name:"Court Master",color:"text-purple-300",bgGradient:"from-purple-800 to-purple-600",borderColor:"border-purple-400",glowColor:"shadow-purple-400/50"}}},wins:{name:"Winner",description:"Total games won",tiers:{bronze:{threshold:25,name:"Rising Star",color:"text-amber-600",bgGradient:"from-amber-900 to-amber-700",borderColor:"border-amber-600",glowColor:"shadow-amber-500/50"},silver:{threshold:50,name:"Champion",color:"text-slate-300",bgGradient:"from-slate-700 to-slate-500",borderColor:"border-slate-400",glowColor:"shadow-slate-400/50"},gold:{threshold:100,name:"Elite Winner",color:"text-yellow-300",bgGradient:"from-yellow-700 to-yellow-500",borderColor:"border-yellow-400",glowColor:"shadow-yellow-400/50"},amethyst:{threshold:250,name:"Victory Lord",color:"text-purple-300",bgGradient:"from-purple-800 to-purple-600",borderColor:"border-purple-400",glowColor:"shadow-purple-400/50"}}},mvps:{name:"MVP",description:"Most Valuable Player awards",tiers:{bronze:{threshold:10,name:"Clutch Player",color:"text-amber-600",bgGradient:"from-amber-900 to-amber-700",borderColor:"border-amber-600",glowColor:"shadow-amber-500/50"},silver:{threshold:25,name:"Team Carry",color:"text-slate-300",bgGradient:"from-slate-700 to-slate-500",borderColor:"border-slate-400",glowColor:"shadow-slate-400/50"},gold:{threshold:50,name:"MVP Elite",color:"text-yellow-300",bgGradient:"from-yellow-700 to-yellow-500",borderColor:"border-yellow-400",glowColor:"shadow-yellow-400/50"},amethyst:{threshold:100,name:"GOAT",color:"text-purple-300",bgGradient:"from-purple-800 to-purple-600",borderColor:"border-purple-400",glowColor:"shadow-purple-400/50"}}},winStreaks:{name:"Win Streak",description:"Longest consecutive wins",tiers:{bronze:{threshold:5,name:"Hot Streak",color:"text-amber-600",bgGradient:"from-amber-900 to-amber-700",borderColor:"border-amber-600",glowColor:"shadow-amber-500/50"},silver:{threshold:10,name:"On Fire",color:"text-slate-300",bgGradient:"from-slate-700 to-slate-500",borderColor:"border-slate-400",glowColor:"shadow-slate-400/50"},gold:{threshold:15,name:"Unstoppable",color:"text-yellow-300",bgGradient:"from-yellow-700 to-yellow-500",borderColor:"border-yellow-400",glowColor:"shadow-yellow-400/50"},amethyst:{threshold:25,name:"Dominator",color:"text-purple-300",bgGradient:"from-purple-800 to-purple-600",borderColor:"border-purple-400",glowColor:"shadow-purple-400/50"}}}},Nm=(t,e={},n=[])=>{const r=e[t]||{_w:0,_l:0,MVPs:0},s={gamesPlayed:(r._w||0)+(r._l||0),wins:r._w||0,mvps:r.MVPs||0,winStreaks:0};return n&&n.length>0&&(s.winStreaks=IC(t,n)),s},IC=(t,e)=>{if(!e||e.length===0)return 0;const n=[...e].sort((s,i)=>new Date(i.date)-new Date(s.date));let r=0;for(const s of n){let i=[],o=[],l=0,u=0;Array.isArray(s.teams)&&s.teams.length>=2?(i=s.teams[0].map(y=>{const N=typeof y=="string"?y:y.name;return N?N.trim().toLowerCase():""}),o=s.teams[1].map(y=>{const N=typeof y=="string"?y:y.name;return N?N.trim().toLowerCase():""})):s.teamA&&s.teamB&&(i=s.teamA.map(y=>{const N=typeof y=="string"?y:y.name;return N?N.trim().toLowerCase():""}),o=s.teamB.map(y=>{const N=typeof y=="string"?y:y.name;return N?N.trim().toLowerCase():""})),s.score&&(l=parseInt(s.score.a)||0,u=parseInt(s.score.b)||0);const d=t?t.trim().toLowerCase():"",m=i.includes(d),g=o.includes(d);if(m||g)if(m&&l>u||g&&u>l)r++;else break;else break}return r},Gc=(t,e={},n=[])=>{const r=Nm(t,e,n),s={};return Object.entries(Xi).forEach(([i,o])=>{const l=r[i]||0;let u=null;Object.entries(o.tiers).forEach(([d,m])=>{l>=m.threshold&&(u={...m,tierId:d})}),u&&(s[i]={...u,categoryName:o.name,currentValue:l})}),s},bC=(t,e={},n=[])=>{const r=Nm(t,e,n),s={};return Object.entries(Xi).forEach(([i,o])=>{const l=r[i]||0,u=Object.entries(o.tiers);let d=null,m=null;for(const[g,y]of u)if(l>=y.threshold)m={...y,tierId:g};else if(!d){d={...y,tierId:g};break}s[i]={categoryName:o.name,currentValue:l,currentTier:m,nextTier:d,progressPercent:d?Math.min(l/d.threshold*100,100):100}}),s},sw=({tier:t="bronze",size:e=24})=>{const n={bronze:{primary:"#CD7F32",secondary:"#A0522D",accent:"#DEB887",ribbon:"#8B4513"},silver:{primary:"#C0C0C0",secondary:"#A8A8A8",accent:"#E5E5E5",ribbon:"#708090"},gold:{primary:"#FFD700",secondary:"#DAA520",accent:"#FFF8DC",ribbon:"#B8860B"},amethyst:{primary:"#9966CC",secondary:"#7B68EE",accent:"#DDA0DD",ribbon:"#663399"}},r=n[t]||n.bronze;return c.jsxs("svg",{width:e,height:e,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("path",{d:"M14 28 L18 42 L24 38 L30 42 L34 28",fill:r.ribbon,stroke:r.secondary,strokeWidth:"1"}),c.jsx("circle",{cx:"24",cy:"20",r:"14",fill:r.secondary,stroke:r.primary,strokeWidth:"2"}),c.jsx("circle",{cx:"24",cy:"20",r:"11",fill:r.primary}),c.jsx("circle",{cx:"24",cy:"20",r:"8",fill:r.accent,opacity:"0.7"}),c.jsxs("g",{transform:"translate(24, 20)",children:[c.jsx("path",{d:"M-4 -6 L4 -6 L3 2 L-3 2 Z",fill:r.secondary}),c.jsx("path",{d:"M-6 -4 Q-7 -4 -7 -2 Q-7 0 -6 0 L-4 0",fill:"none",stroke:r.secondary,strokeWidth:"1"}),c.jsx("path",{d:"M6 -4 Q7 -4 7 -2 Q7 0 6 0 L4 0",fill:"none",stroke:r.secondary,strokeWidth:"1"}),c.jsx("rect",{x:"-3",y:"2",width:"6",height:"2",fill:r.secondary}),c.jsx("rect",{x:"-4",y:"4",width:"8",height:"1",fill:r.secondary})]}),c.jsx("ellipse",{cx:"20",cy:"16",rx:"3",ry:"6",fill:"white",opacity:"0.3"})]})},iw=({tier:t="bronze",size:e=24})=>{const n={bronze:{primary:"#CD7F32",secondary:"#A0522D",accent:"#DEB887"},silver:{primary:"#C0C0C0",secondary:"#A8A8A8",accent:"#E5E5E5"},gold:{primary:"#FFD700",secondary:"#DAA520",accent:"#FFF8DC"},amethyst:{primary:"#9966CC",secondary:"#7B68EE",accent:"#DDA0DD"}},r=n[t]||n.bronze,i={bronze:1,silver:2,gold:3,amethyst:4}[t]||1;return c.jsxs("svg",{width:e,height:e,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("path",{d:"M24 4 L38 12 L38 28 L24 44 L10 28 L10 12 Z",fill:r.primary,stroke:r.secondary,strokeWidth:"2"}),c.jsx("path",{d:"M24 8 L34 14 L34 26 L24 38 L14 26 L14 14 Z",fill:r.accent,opacity:"0.3"}),c.jsxs("g",{transform:"translate(24, 24)",children:[Array.from({length:i},(o,l)=>{const u=(l-(i-1)/2)*4;return c.jsx("g",{transform:`translate(0, ${u})`,children:c.jsx("path",{d:"M-8 -2 L0 6 L8 -2 L6 -4 L0 2 L-6 -4 Z",fill:r.secondary,stroke:r.accent,strokeWidth:"0.5"})},l)}),t==="amethyst"&&c.jsx("path",{d:"M0 -12 L2 -8 L6 -8 L3 -5 L4 -1 L0 -3 L-4 -1 L-3 -5 L-6 -8 L-2 -8 Z",fill:r.accent,opacity:"0.9"})]}),c.jsx("ellipse",{cx:"20",cy:"16",rx:"4",ry:"8",fill:"white",opacity:"0.2"})]})},ow=({tier:t="bronze",size:e=24})=>{const n={bronze:{primary:"#CD7F32",secondary:"#A0522D",accent:"#DEB887",glow:"#FFE4B5"},silver:{primary:"#C0C0C0",secondary:"#A8A8A8",accent:"#E5E5E5",glow:"#F8F8FF"},gold:{primary:"#FFD700",secondary:"#DAA520",accent:"#FFF8DC",glow:"#FFFFE0"},amethyst:{primary:"#9966CC",secondary:"#7B68EE",accent:"#DDA0DD",glow:"#E6E6FA"}},r=n[t]||n.bronze,s=(i,o,l,u)=>{let d="";const g=Math.PI*2/5;for(let y=0;y<5*2;y++){const N=y*g/2-Math.PI/2,R=y%2===0?l:u,j=i+Math.cos(N)*R,k=o+Math.sin(N)*R;y===0?d+=`M ${j} ${k}`:d+=` L ${j} ${k}`}return d+=" Z",d};return c.jsxs("svg",{width:e,height:e,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[c.jsxs("defs",{children:[c.jsxs("filter",{id:`glow-${t}`,x:"-20%",y:"-20%",width:"140%",height:"140%",children:[c.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),c.jsxs("feMerge",{children:[c.jsx("feMergeNode",{in:"coloredBlur"}),c.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),c.jsxs("radialGradient",{id:`starGradient-${t}`,cx:"50%",cy:"30%",r:"70%",children:[c.jsx("stop",{offset:"0%",stopColor:r.accent}),c.jsx("stop",{offset:"70%",stopColor:r.primary}),c.jsx("stop",{offset:"100%",stopColor:r.secondary})]})]}),c.jsx("path",{d:s(24,24,18,9),fill:`url(#starGradient-${t})`,stroke:r.secondary,strokeWidth:"1.5",filter:`url(#glow-${t})`}),c.jsx("path",{d:s(24,24,12,6),fill:r.accent,opacity:"0.6"}),c.jsx("circle",{cx:"24",cy:"24",r:t==="bronze"?"3":t==="silver"?"3.5":t==="gold"?"4":"4.5",fill:r.primary,stroke:r.accent,strokeWidth:"1"}),c.jsx("text",{x:"24",y:"26",textAnchor:"middle",fontSize:"6",fontWeight:"bold",fill:r.secondary,children:"MVP"}),t==="silver"&&c.jsxs("g",{children:[c.jsx("circle",{cx:"24",cy:"6",r:"1",fill:r.accent}),c.jsx("circle",{cx:"39",cy:"17",r:"1",fill:r.accent}),c.jsx("circle",{cx:"33",cy:"38",r:"1",fill:r.accent}),c.jsx("circle",{cx:"15",cy:"38",r:"1",fill:r.accent}),c.jsx("circle",{cx:"9",cy:"17",r:"1",fill:r.accent})]}),t==="gold"&&c.jsxs("g",{children:[c.jsx("g",{transform:"translate(24, 6)",children:c.jsx("path",{d:"M0 -2 L1 0 L0 2 L-1 0 Z",fill:r.accent,opacity:"0.8"})}),c.jsx("g",{transform:"translate(39, 17)",children:c.jsx("path",{d:"M0 -2 L1 0 L0 2 L-1 0 Z",fill:r.accent,opacity:"0.8"})}),c.jsx("g",{transform:"translate(33, 38)",children:c.jsx("path",{d:"M0 -2 L1 0 L0 2 L-1 0 Z",fill:r.accent,opacity:"0.8"})}),c.jsx("g",{transform:"translate(15, 38)",children:c.jsx("path",{d:"M0 -2 L1 0 L0 2 L-1 0 Z",fill:r.accent,opacity:"0.8"})}),c.jsx("g",{transform:"translate(9, 17)",children:c.jsx("path",{d:"M0 -2 L1 0 L0 2 L-1 0 Z",fill:r.accent,opacity:"0.8"})})]}),t==="amethyst"&&c.jsxs("g",{children:[c.jsx("path",{d:"M18 8 L21 4 L24 6 L27 4 L30 8 L27 10 L21 10 Z",fill:r.accent,stroke:r.secondary,strokeWidth:"0.5",opacity:"0.9"}),c.jsxs("g",{transform:"translate(24, 6)",children:[c.jsx("path",{d:"M0 -3 L1.5 0 L0 3 L-1.5 0 Z",fill:r.accent}),c.jsx("path",{d:"M-3 0 L0 -1.5 L3 0 L0 1.5 Z",fill:r.accent})]}),c.jsx("g",{transform:"translate(39, 17)",children:c.jsx("path",{d:"M0 -2 L1 0 L0 2 L-1 0 Z",fill:r.accent})}),c.jsx("g",{transform:"translate(33, 38)",children:c.jsx("path",{d:"M0 -2 L1 0 L0 2 L-1 0 Z",fill:r.accent})}),c.jsx("g",{transform:"translate(15, 38)",children:c.jsx("path",{d:"M0 -2 L1 0 L0 2 L-1 0 Z",fill:r.accent})}),c.jsx("g",{transform:"translate(9, 17)",children:c.jsx("path",{d:"M0 -2 L1 0 L0 2 L-1 0 Z",fill:r.accent})})]})]})},aw=({tier:t="bronze",size:e=24})=>{const n={bronze:{outer:"#FF4500",middle:"#FF6B35",inner:"#FFD700",center:"#FFFF99"},silver:{outer:"#DC143C",middle:"#FF4500",inner:"#FFD700",center:"#FFFFFF"},gold:{outer:"#B22222",middle:"#FF0000",inner:"#FFD700",center:"#FFFFFF"},amethyst:{outer:"#4B0082",middle:"#9932CC",inner:"#00BFFF",center:"#F0F8FF"}},r=n[t]||n.bronze,i={bronze:"5",silver:"10",gold:"15",amethyst:"25"}[t]||"5";return c.jsxs("svg",{width:e,height:e,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("defs",{children:c.jsxs("radialGradient",{id:`flameGradient-${t}`,cx:"50%",cy:"80%",r:"70%",children:[c.jsx("stop",{offset:"0%",stopColor:r.center}),c.jsx("stop",{offset:"30%",stopColor:r.inner}),c.jsx("stop",{offset:"70%",stopColor:r.middle}),c.jsx("stop",{offset:"100%",stopColor:r.outer})]})}),c.jsx("path",{d:`M24 4\r
                   C26 6, 28 10, 26 14\r
                   C28 12, 32 14, 34 18\r
                   C36 22, 34 26, 32 28\r
                   C34 30, 36 34, 34 38\r
                   C32 42, 28 44, 24 44\r
                   C20 44, 16 42, 14 38\r
                   C12 34, 14 30, 16 28\r
                   C14 26, 12 22, 14 18\r
                   C16 14, 20 12, 22 14\r
                   C20 10, 22 6, 24 4 Z`,fill:`url(#flameGradient-${t})`}),c.jsx("path",{d:`M24 8\r
                   C25 10, 26 12, 25 14\r
                   C27 13, 29 15, 30 18\r
                   C31 21, 30 24, 29 26\r
                   C30 28, 31 31, 30 34\r
                   C29 37, 27 39, 24 40\r
                   C21 39, 19 37, 18 34\r
                   C17 31, 18 28, 19 26\r
                   C18 24, 17 21, 18 18\r
                   C19 15, 21 13, 23 14\r
                   C22 12, 23 10, 24 8 Z`,fill:r.inner,opacity:"0.7"}),c.jsx("ellipse",{cx:"24",cy:"30",rx:"8",ry:"10",fill:r.center,opacity:"0.8"}),c.jsx("circle",{cx:"24",cy:"30",r:"6",fill:r.center,stroke:r.outer,strokeWidth:"1",opacity:"0.9"}),c.jsx("text",{x:"24",y:"33",textAnchor:"middle",fontSize:i.length>1?"6":"8",fontWeight:"bold",fill:r.outer,children:i}),c.jsxs("g",{opacity:"0.6",children:[c.jsx("path",{d:`M20 12\r
                       C18 10, 16 8, 18 6\r
                       C20 4, 22 8, 20 12 Z`,fill:r.middle}),c.jsx("path",{d:`M28 12\r
                       C30 8, 32 4, 30 6\r
                       C28 8, 30 10, 28 12 Z`,fill:r.middle}),c.jsx("path",{d:`M24 8\r
                       C22 6, 22 2, 24 4\r
                       C26 2, 26 6, 24 8 Z`,fill:r.inner})]}),t==="gold"&&c.jsxs("g",{children:[c.jsx("circle",{cx:"18",cy:"16",r:"0.8",fill:r.center,opacity:"0.8"}),c.jsx("circle",{cx:"30",cy:"14",r:"0.8",fill:r.center,opacity:"0.8"}),c.jsx("circle",{cx:"16",cy:"26",r:"0.6",fill:r.inner,opacity:"0.7"}),c.jsx("circle",{cx:"32",cy:"24",r:"0.6",fill:r.inner,opacity:"0.7"})]}),t==="amethyst"&&c.jsxs("g",{children:[c.jsx("circle",{cx:"18",cy:"16",r:"1",fill:r.center,opacity:"0.9",children:c.jsx("animate",{attributeName:"opacity",values:"0.9;0.4;0.9",dur:"2s",repeatCount:"indefinite"})}),c.jsx("circle",{cx:"30",cy:"14",r:"1",fill:r.center,opacity:"0.9",children:c.jsx("animate",{attributeName:"opacity",values:"0.4;0.9;0.4",dur:"2s",repeatCount:"indefinite"})}),c.jsx("circle",{cx:"14",cy:"28",r:"0.8",fill:r.inner,opacity:"0.8",children:c.jsx("animate",{attributeName:"opacity",values:"0.8;0.3;0.8",dur:"1.5s",repeatCount:"indefinite"})}),c.jsx("circle",{cx:"34",cy:"26",r:"0.8",fill:r.inner,opacity:"0.8",children:c.jsx("animate",{attributeName:"opacity",values:"0.3;0.8;0.3",dur:"1.5s",repeatCount:"indefinite"})}),c.jsx("circle",{cx:"24",cy:"6",r:"2",fill:r.center,opacity:"0.5",children:c.jsx("animate",{attributeName:"opacity",values:"0.5;0.8;0.5",dur:"3s",repeatCount:"indefinite"})})]})]})},SC={gamesPlayed:iw,wins:sw,mvps:ow,winStreaks:aw},Bh=to.memo(function({badge:e,categoryId:n,size:r="normal",showTooltip:s=!0,className:i=""}){const[o,l]=U.useState(!1);U.useEffect(()=>{let g;return o&&(g=setTimeout(()=>l(!1),3e3)),()=>clearTimeout(g)},[o]);const u={xs:{container:"w-5 h-5",iconSize:16},small:{container:"w-7 h-7",iconSize:20},normal:{container:"w-10 h-10",iconSize:28},large:{container:"w-14 h-14",iconSize:40}},d=u[r]||u.normal,m=SC[n];return c.jsxs("div",{className:`relative group ${i}`,children:[c.jsxs("div",{className:`
                    ${d.container} 
                    rounded-lg bg-gradient-to-br ${e.bgGradient}
                    border-2 ${e.borderColor}
                    flex items-center justify-center cursor-pointer
                    transform transition-all duration-300
                    hover:scale-110 hover:${e.glowColor}
                    shadow-lg hover:shadow-xl relative overflow-hidden
                `,onClick:g=>{g.stopPropagation(),l(!o)},children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),c.jsx("div",{className:"relative z-10",children:m?c.jsx(m,{tier:e.tierId,size:d.iconSize}):c.jsx("span",{className:"text-lg",children:"🏅"})})]}),s&&c.jsxs("div",{className:`absolute z-50 px-3 py-2 text-xs font-medium text-white rounded-lg shadow-lg
                    bg-gray-900 border border-gray-600
                    bottom-full left-1/2 transform -translate-x-1/2 mb-2 whitespace-nowrap
                    transition-opacity duration-300 ${o?"opacity-100 pointer-events-auto":"opacity-0 group-hover:opacity-100 pointer-events-none"}`,children:[c.jsx("div",{className:"flex items-center",children:c.jsxs("div",{children:[c.jsx("div",{className:`font-semibold ${e.color}`,children:e.name}),c.jsxs("div",{className:"text-gray-300",children:[e.currentValue," ",e.categoryName.toLowerCase()]})]})}),c.jsx("div",{className:`absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 \r
                        border-l-4 border-r-4 border-transparent border-t-4 border-t-gray-900`})]})]})});function NC({badges:t,maxDisplay:e=3,size:n="small"}){const r=Object.entries(t);if(r.length===0)return null;const s={amethyst:4,gold:3,silver:2,bronze:1},i=r.sort(([,u],[,d])=>(s[d.tierId]||0)-(s[u.tierId]||0)),o=e?i.slice(0,e):i,l=e&&i.length>e;return c.jsxs("div",{className:`flex items-center ${n==="xs"?"gap-0.5":"gap-1"} ml-1`,children:[o.map(([u,d])=>c.jsx(Bh,{badge:d,categoryId:u,size:n},`${u}-${d.tierId}`)),l&&c.jsxs("div",{className:`
                    ${n==="xs"?"w-3 h-3 text-[10px]":n==="small"?"w-5 h-5 text-xs":"w-7 h-7 text-sm"} 
                    rounded-md flex items-center justify-center 
                    bg-gray-700 bg-opacity-50 border border-gray-600
                    text-gray-400 font-medium
                `,children:["+",i.length-e]})]})}function ic({playerName:t,leaderboard:e={},matchHistory:n=[],size:r="normal",maxDisplay:s=3}){const i=Gc(t,e,n);return c.jsx(NC,{badges:i,maxDisplay:s,size:r})}function CC({players:t,newRating:e,setNewRating:n,handleRatingSubmit:r,handleDeletePlayer:s,openEditModal:i,isAdmin:o,user:l,toastMessage:u,setToastMessage:d,currentBelts:m={},leaderboard:g={},matchHistory:y=[],onPlayerClick:N}){var $;const[R,j]=U.useState("name"),[k,E]=U.useState("asc"),v=Y=>Y.charAt(0).toUpperCase()+Y.slice(1),[b,P]=U.useState(!1),[L,V]=U.useState(null),T=()=>{const Y={...e};r(),setTimeout(()=>{n(Y),ne(!1)},10)},p=Y=>{R===Y?E(k==="asc"?"desc":"asc"):(j(Y),E("asc"))},w=Y=>{var K;const J=Be[Y],oe=(K=J.submissions)==null?void 0:K.find(Ue=>Ue.submittedBy===(l==null?void 0:l.email));n({name:J.name,scoring:(oe==null?void 0:oe.scoring)??J.scoring??5,defense:(oe==null?void 0:oe.defense)??J.defense??5,rebounding:(oe==null?void 0:oe.rebounding)??J.rebounding??5,playmaking:(oe==null?void 0:oe.playmaking)??J.playmaking??5,stamina:(oe==null?void 0:oe.stamina)??J.stamina??5,physicality:(oe==null?void 0:oe.physicality)??J.physicality??5,xfactor:(oe==null?void 0:oe.xfactor)??J.xfactor??5}),V(Y),P(!0)},_=()=>{P(!1)},S=()=>{var oe;const Y=Math.min(L+1,Be.length-1);V(Y);const J=Be[Y];if(J){const K=(oe=J.submissions)==null?void 0:oe.find(Ue=>Ue.submittedBy===(l==null?void 0:l.email));n({name:J.name,scoring:(K==null?void 0:K.scoring)??J.scoring??5,defense:(K==null?void 0:K.defense)??J.defense??5,rebounding:(K==null?void 0:K.rebounding)??J.rebounding??5,playmaking:(K==null?void 0:K.playmaking)??J.playmaking??5,stamina:(K==null?void 0:K.stamina)??J.stamina??5,physicality:(K==null?void 0:K.physicality)??J.physicality??5,xfactor:(K==null?void 0:K.xfactor)??J.xfactor??5}),ne(!1)}},C=()=>{var oe;const Y=Math.max(L-1,0);V(Y);const J=Be[Y];if(J){const K=(oe=J.submissions)==null?void 0:oe.find(Ue=>Ue.submittedBy===(l==null?void 0:l.email));n({name:J.name,scoring:(K==null?void 0:K.scoring)??J.scoring??5,defense:(K==null?void 0:K.defense)??J.defense??5,rebounding:(K==null?void 0:K.rebounding)??J.rebounding??5,playmaking:(K==null?void 0:K.playmaking)??J.playmaking??5,stamina:(K==null?void 0:K.stamina)??J.stamina??5,physicality:(K==null?void 0:K.physicality)??J.physicality??5,xfactor:(K==null?void 0:K.xfactor)??J.xfactor??5}),ne(!1)}},I=Y=>((Y.scoring||5)*.25+(Y.defense||5)*.2+(Y.rebounding||5)*.15+(Y.playmaking||5)*.15+(Y.stamina||5)*.1+(Y.physicality||5)*.1+(Y.xfactor||5)*.05).toFixed(2),ce=Y=>Y/10*100,[Be,q]=U.useState([]),X=U.useRef(),[W,ne]=U.useState(!1);return U.useEffect(()=>{function Y(J){b&&X.current&&!X.current.contains(J.target)&&(W?confirm("You have unsaved changes. Are you sure you want to close?")&&P(!1):P(!1))}return document.addEventListener("mousedown",Y),()=>document.removeEventListener("mousedown",Y)},[b,W]),U.useEffect(()=>{b&&ne(!0)},[e]),U.useEffect(()=>{const Y=[...t].sort((J,oe)=>{if(R==="name"){const K=J.name.localeCompare(oe.name);return k==="asc"?K:-K}else if(R==="rating"){const K=parseFloat(I(J)),Ue=parseFloat(I(oe));return k==="asc"?K-Ue:Ue-K}return 0});q(Y)},[t,R,k]),c.jsxs("div",{className:"space-y-1",children:[c.jsx("div",{className:"flex justify-end items-center mb-4",children:c.jsxs("button",{onClick:()=>i({name:"",scoring:5,defense:5,rebounding:5,playmaking:5,stamina:5,physicality:5,xfactor:5},!1),className:"text-sm text-blue-400 hover:text-blue-300 transition-colors flex items-center",children:["Add Player",c.jsx(TC,{className:"ml-1 w-5 h-5"})]})}),c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsxs("button",{onClick:()=>p("name"),className:`text-sm font-medium px-2 py-1 rounded transition-colors ${R==="name"?"text-blue-400":"text-gray-300 hover:text-gray-100"}`,children:["Name ",R==="name"&&(k==="asc"?"↑":"↓")]}),c.jsxs("button",{onClick:()=>p("rating"),className:`text-sm font-medium px-2 py-1 rounded transition-colors ${R==="rating"?"text-blue-400":"text-gray-300 hover:text-gray-100"}`,children:["Rating ",R==="rating"&&(k==="asc"?"↑":"↓")]})]}),c.jsx("div",{className:"space-y-1",children:Be.map((Y,J)=>{var D,de;const oe=I(Y),K=(D=Y.submissions)==null?void 0:D.find(ge=>ge.submittedBy===(l==null?void 0:l.email)),Ue=J%2===0?"bg-gray-800":"bg-gray-800/50";return c.jsxs("div",{className:`${Ue} rounded p-2 cursor-pointer hover:bg-gray-700 transition-colors`,onClick:()=>N&&N(Y),children:[c.jsxs("div",{className:"flex justify-between items-center mb-0.5",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-base text-white",children:Y.name}),c.jsx(sc,{playerName:Y.name,currentBelts:m}),c.jsx(ic,{playerName:Y.name,leaderboard:g,matchHistory:y,size:"small",maxDisplay:2})]}),c.jsx("span",{className:"text-base font-medium text-blue-400",children:oe})]}),c.jsxs("div",{className:"mb-1",children:[c.jsxs("div",{className:"text-xs text-gray-400",children:["Ratings: ",((de=Y.submissions)==null?void 0:de.length)||0]}),c.jsx("div",{className:"mt-0.5 bg-gray-700 h-1 rounded w-full",children:c.jsx("div",{className:"bg-blue-500 h-1 rounded",style:{width:`${ce(parseFloat(oe))}%`}})})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{onClick:ge=>{ge.stopPropagation(),w(J)},className:"px-2 py-1 text-xs text-white bg-blue-600 rounded hover:bg-blue-700 mr-2",children:"Rate"}),c.jsx("div",{className:`flex items-center px-2 py-0.5 rounded-md text-xs ${K?"bg-green-900 bg-opacity-30 text-green-400":"bg-yellow-900 bg-opacity-30 text-yellow-400"}`,children:K?c.jsxs(c.Fragment,{children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-2.5 w-2.5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),c.jsx("span",{children:"Rated"})]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-2.5 w-2.5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),c.jsx("span",{children:"Not rated"})]})}),o&&c.jsxs("div",{className:"flex space-x-1 ml-auto",children:[c.jsx(un,{onClick:ge=>{ge.stopPropagation();const xe={name:Y.name,scoring:Y.scoring||5,defense:Y.defense||5,rebounding:Y.rebounding||5,playmaking:Y.playmaking||5,stamina:Y.stamina||5,physicality:Y.physicality||5,xfactor:Y.xfactor||5,active:Y.active!==void 0?Y.active:!0};i(xe,!0)},className:"px-2 py-1 text-xs bg-yellow-600 hover:bg-yellow-700",children:"Edit"}),c.jsx(un,{onClick:ge=>{ge.stopPropagation(),confirm(`Are you sure you want to delete ${Y.name}? This will permanently remove all player data including ratings, match history, and statistics. This action cannot be undone.`)&&s(Y.name)},className:"px-2 py-1 text-xs bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]},Y.name)})}),b&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:c.jsxs("div",{ref:X,className:"bg-gray-800 p-4 rounded-lg w-full max-w-sm max-h-[90vh] overflow-y-auto shadow-lg relative",children:[c.jsx("button",{onClick:_,className:"absolute top-2 right-2 text-gray-400 hover:text-white text-xl font-bold",children:"✕"}),c.jsxs("h2",{className:"text-xl font-bold mb-4 text-white pr-8",children:["Rate: ",($=Be[L])==null?void 0:$.name]}),Object.entries(e).map(([Y,J])=>Y==="name"?null:c.jsxs("div",{className:"mb-2",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("label",{className:"text-sm font-semibold text-white flex items-center",children:[v(Y),c.jsx("span",{className:"ml-2",children:c.jsx(nw,{text:rw[Y]})})]}),c.jsx("span",{className:"text-sm",children:J})]}),c.jsx("input",{type:"range",min:"1",max:"10",step:"1",value:J,onChange:oe=>n({...e,[Y]:parseInt(oe.target.value)}),className:"w-full mt-1 accent-blue-500"})]},Y)),c.jsxs("div",{className:"flex justify-between items-center mt-4",children:[c.jsx("button",{className:"text-white text-lg disabled:text-gray-500 p-1",onClick:C,disabled:L===0,children:"⬅️"}),c.jsx(un,{onClick:T,className:"bg-blue-600 hover:bg-blue-700 py-1 px-3 text-sm",children:"Submit Rating"}),c.jsx("button",{className:"text-white text-lg disabled:text-gray-500 p-1",onClick:S,disabled:L===Be.length-1,children:"➡️"})]})]})})]})}function AC({players:t=[],teams:e=[],setTeams:n,matchups:r=[],setMatchups:s,mvpVotes:i=[],setMvpVotes:o,scores:l=[],setScores:u,teamSize:d,setTeamSize:m,generateBalancedTeams:g,handlePlayerActiveToggle:y,handleBatchPlayerActiveToggle:N,weightings:R,saveMatchResults:j,archiveCompletedMatches:k,hasGeneratedTeams:E,setHasGeneratedTeams:v,isRematch:b=()=>!1,getPreviousResults:P=()=>[],hasPendingMatchups:L=!1,playerOVRs:V={},calculatePlayerScore:T,currentBelts:p={},leaderboard:w={},matchHistory:_=[],onPlayerClick:S}){const[C,I]=U.useState(!1),[ce,Be]=U.useState(!1),[q,X]=U.useState([[],[]]),[W,ne]=U.useState(!1),$=U.useRef(null),[Y,J]=U.useState("active"),[oe,K]=U.useState("desc"),[Ue,D]=U.useState(!1);U.useEffect(()=>{if(r.length>0){const O=l.some(G=>!G.processed&&(!G.a||!G.b||G.a===""||G.b===""));ne(O)}else ne(!1)},[r,l]);const de=O=>{if(!O)return"Team";const G=O.trim().replace(/\s+/g," "),Q=G.split(" ");if(Q.length<=1)return G;const he=Q[0];let Ve=Q[Q.length-1][0]||"";return`${he} ${Ve}.`},ge=(O,G)=>{if(!O||!Array.isArray(O)||O.length===0)return null;const Q=O.filter(Ve=>Ve&&typeof Ve=="object"&&Ve.name);if(Q.length===0)return null;const he=Q.filter(Ve=>!Ve.isBench),ke=he.length>0?he:Q;return ke.reduce((Ve,Ce)=>{if(!Ve)return Ce;let Qe=0,an=0;try{Qe=G?G(Ve):_e(Ve),an=G?G(Ce):_e(Ce)}catch(mn){console.error("Error calculating player score:",mn),Qe=_e(Ve),an=_e(Ce)}return an>Qe?Ce:Ve},ke[0])},xe=(O,G)=>{if(!O||O.length===0)return"Team";if(O.length===1)return O[0].name||"Player";const Q=ge(O,G);return Q?de(Q.name):"Team"},ve=(O,G,Q)=>{const he=[...l];he[O]||(he[O]={a:"",b:""}),he[O]={...he[O],[G]:Q,processed:!1},u(he)},Te=(O,G)=>{const Q=[...i];Q[O]=G,o(Q)},Ne=O=>{Y===O?K(oe==="asc"?"desc":"asc"):(J(O),K("desc"))},Pe=()=>{const O=!Ue;D(O);const G=t.map(Q=>({name:Q.name,active:O}));N?N(G):t.forEach(Q=>{y(Q.name,O)})},_e=O=>{const{scoring:G=5,defense:Q=5,rebounding:he=5,playmaking:ke=5,stamina:Ve=5,physicality:Ce=5,xfactor:Qe=5}=O,an=G*R.scoring+Q*R.defense+he*R.rebounding+ke*R.playmaking+Ve*R.stamina+Ce*R.physicality+Qe*R.xfactor;return Math.min(an,10)},Ie=O=>!O||O.length===0?0:O.reduce((Q,he)=>Q+_e(he),0)/O.length;U.useMemo(()=>e.map(O=>Ie(O)),[e,T]);const Oe=U.useMemo(()=>[...t].sort((O,G)=>{if(O.active!==G.active)return O.active?-1:1;let Q,he;switch(Y){case"name":Q=O.name.toLowerCase(),he=G.name.toLowerCase();break;case"ovr":Q=V[O.name]||_e(O),he=V[G.name]||_e(G);break;default:Q=O.name.toLowerCase(),he=G.name.toLowerCase()}return typeof Q=="string"?oe==="asc"?Q.localeCompare(he):he.localeCompare(Q):oe==="asc"?Q-he:he-Q}),[t,Y,oe,V]),Ge=t.filter(O=>O.active).length,[De,at]=U.useState([]),Ke=O=>O/10*100;U.useEffect(()=>{function O(G){$.current&&!$.current.contains(G.target)&&I(!1)}return document.addEventListener("mousedown",O),()=>{document.removeEventListener("mousedown",O)}},[]),U.useEffect(()=>{const O=t.every(Q=>Q.active),G=t.every(Q=>!Q.active);O?D(!0):G&&D(!1)},[t]),U.useEffect(()=>{const O=Math.floor(Ge/d),G=Math.max(2,O);X(Array.from({length:G},()=>[]))},[d,Ge]);const _t=(O,G)=>{let Q=!1;const he=q.map((ke,Ve)=>ke.some(Ce=>Ce.name===O.name)?(Q=!0,ke.filter(Ce=>Ce.name!==O.name)):ke);Q||(he[G].filter(ke=>!ke.isBench).length>=d?O.isBench=!0:O.isBench=!1,he[G]=[...he[G],O]),X(he)};U.useEffect(()=>{if(e&&e.length>0){const O=e.map((G,Q)=>{const he=Ie(G);return{teamIndex:Q,strength:he,players:G}});at(O.sort((G,Q)=>Q.strength-G.strength))}},[e]);const bt=()=>{if(L&&confirm&&!confirm("You have unsaved match results. Creating new teams will discard these results. Continue?"))return;const O=[];for(let G=0;G<q.length-1;G+=2)O.push([q[G],q[G+1]||[]]);n(q),s(O),o(Array(O.length).fill("")),u(Array(O.length).fill({a:"",b:""})),Be(!1),v(!0)},be=()=>{const O=q.flat().map(G=>G.name);return Oe.filter(G=>G.active&&!O.includes(G.name))},nt=()=>{const O=be().length,G=q.filter(Q=>Q.filter(he=>!he.isBench).length===d).length;return O===0&&G>=q.length-1};return c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("label",{className:"text-sm text-gray-400",children:"Team Size:"}),c.jsx(A0,{value:d,onChange:O=>m(parseInt(O.target.value)),children:[1,2,3,4,5].map(O=>c.jsxs("option",{value:O,children:[O,"v",O]},O))}),c.jsxs("div",{className:"relative",ref:$,children:[c.jsxs("button",{onClick:()=>I(!C),className:"text-sm text-blue-400 hover:text-blue-300 transition-colors flex items-center",children:["Generate Teams",c.jsx("svg",{className:"ml-1 w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),C&&c.jsx("div",{className:"absolute mt-2 w-48 bg-gray-800 rounded shadow-lg z-10",children:c.jsxs("ul",{className:"py-1",children:[c.jsx("li",{children:c.jsx("button",{onClick:()=>{g(),I(!1),Be(!1)},className:"block px-4 py-2 text-sm text-white hover:bg-gray-700 w-full text-left",children:"Balanced Randomize"})}),c.jsx("li",{children:c.jsx("button",{onClick:()=>{Be(!0),I(!1)},className:"block px-4 py-2 text-sm text-white hover:bg-gray-700 w-full text-left",children:"Choose Teams"})})]})})]})]}),ce&&c.jsxs("div",{className:"space-y-4 border border-gray-700 rounded p-4",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h3",{className:"text-md font-medium text-white",children:"Choose Teams"}),c.jsx("button",{onClick:()=>Be(!1),className:"text-gray-400 hover:text-white",children:"✕"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:q.map((O,G)=>{const Q=[{border:"border-blue-500",text:"text-blue-400",bg:"bg-blue-600",hover:"bg-blue-500"},{border:"border-green-500",text:"text-green-400",bg:"bg-green-600",hover:"bg-green-500"},{border:"border-purple-500",text:"text-purple-400",bg:"bg-purple-600",hover:"bg-purple-500"},{border:"border-yellow-500",text:"text-yellow-400",bg:"bg-yellow-600",hover:"bg-yellow-500"},{border:"border-red-500",text:"text-red-400",bg:"bg-red-600",hover:"bg-red-500"},{border:"border-pink-500",text:"text-pink-400",bg:"bg-pink-600",hover:"bg-pink-500"}],he=G%Q.length,ke=Q[he];return c.jsxs("div",{className:`border ${ke.border} rounded-lg p-3 bg-gray-800`,children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsxs("h3",{className:`font-medium ${ke.text}`,children:["Team ",G+1]}),c.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${O.filter(Ve=>!Ve.isBench).length===d?"bg-green-900 text-green-400":"bg-yellow-900 text-yellow-400"}`,children:[O.filter(Ve=>!Ve.isBench).length,"/",d," players"]})]}),c.jsxs("div",{className:"space-y-2 min-h-20 mb-3",children:[O.filter(Ve=>!Ve.isBench).map((Ve,Ce)=>c.jsxs("div",{className:"flex justify-between items-center bg-gray-700 rounded px-2 py-1",children:[c.jsx("span",{className:"text-sm text-white",children:Ve.name}),c.jsx("button",{onClick:()=>{const Qe=[...q];Qe[G]=O.filter((an,mn)=>mn!==O.indexOf(Ve)),X(Qe)},className:"text-red-400 hover:text-red-300 text-xs",children:"Remove"})]},Ce)),O.filter(Ve=>Ve.isBench).map((Ve,Ce)=>c.jsxs("div",{className:"flex justify-between items-center bg-gray-600 rounded px-2 py-1 border-l-2 border-yellow-500",children:[c.jsxs("span",{className:"text-sm text-gray-300",children:[c.jsx("span",{className:"text-yellow-500 text-xs mr-1",children:"Bench:"}),Ve.name]}),c.jsx("button",{onClick:()=>{const Qe=[...q];Qe[G]=O.filter((an,mn)=>mn!==O.indexOf(Ve)),X(Qe)},className:"text-red-400 hover:text-red-300 text-xs",children:"Remove"})]},Ce)),O.length===0&&c.jsx("div",{className:"text-sm text-gray-500 italic",children:"No players selected"})]})]},G)})}),c.jsxs("div",{className:"mt-4",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"Available Players"}),be().length===0?c.jsx("div",{className:"text-sm text-gray-500 italic text-center py-4",children:"All active players assigned"}):c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2",children:be().map(O=>c.jsxs("div",{className:"bg-gray-800 rounded p-2",children:[c.jsx("div",{className:"text-sm text-white mb-1",children:O.name}),c.jsx("div",{className:"flex flex-wrap gap-1",children:q.map((G,Q)=>{const he=G.filter(Qe=>!Qe.isBench).length>=d,ke=[{bg:"bg-blue-600",hover:"bg-blue-500"},{bg:"bg-green-600",hover:"bg-green-500"},{bg:"bg-purple-600",hover:"bg-purple-500"},{bg:"bg-yellow-600",hover:"bg-yellow-500"},{bg:"bg-red-600",hover:"bg-red-500"},{bg:"bg-pink-600",hover:"bg-pink-500"}],Ve=Q%ke.length,Ce=ke[Ve];return c.jsx("button",{onClick:()=>_t(O,Q),className:`text-xs px-2 py-1 rounded ${he?"bg-amber-600 hover:bg-amber-500":`${Ce.bg} hover:${Ce.hover}`}`,children:he?`Bench ${Q+1}`:`Team ${Q+1}`},Q)})})]},O.name))})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-4",children:[c.jsx("button",{onClick:()=>{const O=Math.floor(Ge/d),G=Math.max(2,O);X(Array.from({length:G},()=>[]))},className:"px-3 py-1 text-sm text-gray-300 hover:text-white border border-gray-700 rounded",children:"Reset"}),c.jsx("button",{onClick:bt,disabled:!nt(),className:`px-3 py-1 text-sm text-white rounded ${nt()?"bg-blue-600 hover:bg-blue-500":"bg-gray-600 cursor-not-allowed opacity-50"}`,children:"Create Matchups"})]})]}),E&&e.length>0&&!ce&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex justify-between items-center",children:c.jsx("h2",{className:"text-sm font-medium text-gray-300 uppercase tracking-wider mb-3",children:"Teams"})}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:e.map((O,G)=>{const Q=Ie(O).toFixed(1),he=O.length===1?`Player ${G+1}`:xe(O,T||_e);return c.jsxs("div",{className:"border border-gray-800 p-3 rounded",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-xs text-gray-400",children:O.length===1?he:`Team ${he}`}),c.jsx("div",{className:"flex flex-col items-end",children:c.jsxs("span",{className:"text-xs text-blue-400",children:["Strength: ",Q]})})]}),c.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:O.filter(ke=>!ke.isBench).map(ke=>c.jsxs("div",{className:"bg-gray-800 text-gray-100 px-3 py-1 rounded-md text-xs font-medium border border-gray-600 flex items-center",children:[c.jsx("span",{children:ke.name}),c.jsx(sc,{playerName:ke.name,currentBelts:p,size:"xs"}),c.jsx(ic,{playerName:ke.name,leaderboard:w,matchHistory:_,size:"xs",maxDisplay:1})]},ke.name))}),O.some(ke=>ke.isBench)&&c.jsxs("div",{className:"mt-1",children:[c.jsx("span",{className:"text-xs text-yellow-500 mb-1",children:"Bench: "}),c.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:O.filter(ke=>ke.isBench).map(ke=>c.jsxs("div",{className:"bg-gray-800 text-yellow-500 px-3 py-1 rounded-md text-xs font-sm border border-gray-600 flex items-center",children:[c.jsx("span",{children:ke.name}),c.jsx(sc,{playerName:ke.name,currentBelts:p,size:"xs"}),c.jsx(ic,{playerName:ke.name,leaderboard:w,matchHistory:_,size:"xs",maxDisplay:1})]},ke.name))})]})]},G)})})]}),E&&r.length>0&&!ce&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-sm font-medium text-gray-300 uppercase tracking-wider mb-3",children:"Matchups"}),W&&c.jsxs("div",{className:"text-yellow-400 text-xs flex items-center",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Unsaved match results"]})]}),r.map(([O,G],Q)=>{var an,mn,ln,Kr,_i,Qr,Us,Bs,Hn,Yr,jn,Dn;const he=O.length===1?O[0].name:xe(O,T||_e),ke=G.length===1?G[0].name:xe(G,T||_e),Ve=Ie(O).toFixed(1),Ce=Ie(G).toFixed(1),Qe=!((an=l[Q])!=null&&an.processed)&&(!((mn=l[Q])!=null&&mn.a)||!((ln=l[Q])!=null&&ln.b)||((Kr=l[Q])==null?void 0:Kr.a)===""||((_i=l[Q])==null?void 0:_i.b)==="");return c.jsxs("div",{className:`border ${Qe?"border-yellow-600":"border-gray-800"} p-3 rounded`,children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsxs("span",{className:"text-xs text-gray-400",children:["Match ",Q+1]}),Qe&&c.jsx("span",{className:"text-xs text-yellow-400",children:"Results not saved"})]}),!((Qr=l[Q])!=null&&Qr.processed)&&c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-lg font-medium text-white",children:O.length===1?he:`Team ${he}`}),c.jsxs("span",{className:"text-xs text-blue-400 ml-2",children:["(Str: ",Ve,")"]})]}),c.jsx("span",{className:"mx-4 text-gray-500",children:"vs"}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-lg font-medium text-white",children:G.length===1?ke:`Team ${ke}`}),c.jsxs("span",{className:"text-xs text-blue-400 ml-2",children:["(Str: ",Ce,")"]})]})]}),!((Us=l[Q])!=null&&Us.processed)&&c.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[c.jsx("label",{className:"text-xs text-gray-400",children:"MVP:"}),O.length===1&&G.length===1?(()=>{var xi,wi;const Pt=O[0],Vn=G[0],Er=V[Pt.name]||_e(Pt),Mn=V[Vn.name]||_e(Vn),Tr=parseInt((xi=l[Q])==null?void 0:xi.a)||0,yt=parseInt((wi=l[Q])==null?void 0:wi.b)||0;let In=null,Ln="";if(Math.abs(Er-Mn)<=1?Ln="Neither player eligible for MVP (OVR within 1 point)":Er<Mn?(In=Pt.name,Ln=`${Pt.name} eligible for MVP if wins (${Er.toFixed(1)} vs ${Mn.toFixed(1)})`):(In=Vn.name,Ln=`${Vn.name} eligible for MVP if wins (${Mn.toFixed(1)} vs ${Er.toFixed(1)})`),In&&Tr&&yt&&Tr!==yt){const qn=In===Pt.name&&Tr>yt||In===Vn.name&&yt>Tr;qn&&i[Q]!==In?setTimeout(()=>Te(Q,In),0):!qn&&i[Q]&&setTimeout(()=>Te(Q,""),0)}return c.jsx("div",{className:"flex-grow",children:c.jsx("div",{className:`px-3 py-2 rounded text-sm ${In?"bg-blue-900 bg-opacity-30 text-blue-400":"bg-gray-700 text-gray-400"}`,children:Ln})})})():c.jsxs(A0,{value:i[Q]||"",onChange:Pt=>Te(Q,Pt.target.value),className:"flex-grow",children:[c.jsx("option",{value:"",children:"-- Select MVP --"}),[...O,...G].map(Pt=>c.jsx("option",{value:Pt.name,children:Pt.name},Pt.name))]})]}),c.jsx("div",{className:"flex items-center justify-between",children:(Bs=l[Q])!=null&&Bs.processed?c.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 w-full",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"text-center flex-1",children:[c.jsx("div",{className:"text-sm text-gray-300 mb-1",children:O.length===1?he:`Team ${he}`}),c.jsx("div",{className:"text-3xl font-bold text-white",children:((Hn=l[Q])==null?void 0:Hn.a)||0})]}),c.jsx("div",{className:"text-gray-500 font-medium px-4",children:"VS"}),c.jsxs("div",{className:"text-center flex-1",children:[c.jsx("div",{className:"text-sm text-gray-300 mb-1",children:G.length===1?ke:`Team ${ke}`}),c.jsx("div",{className:"text-3xl font-bold text-white",children:((Yr=l[Q])==null?void 0:Yr.b)||0})]})]}),i[Q]&&c.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-600 text-center",children:[c.jsx("span",{className:"text-sm text-gray-400",children:"MVP: "}),c.jsx("span",{className:"text-yellow-400 font-medium",children:i[Q]})]})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("label",{className:"text-xs text-gray-400",children:"Score:"}),c.jsx("input",{type:"number",placeholder:O.length===1?he:`Team ${he}`,className:`border-b ${Qe?"border-yellow-600":"border-gray-700"} bg-transparent rounded-none px-2 py-1 w-20 text-sm text-white focus:outline-none focus:border-blue-500`,value:((jn=l[Q])==null?void 0:jn.a)||"",onChange:Pt=>ve(Q,"a",Pt.target.value)}),c.jsx("span",{className:"text-xs text-gray-400",children:"vs"}),c.jsx("input",{type:"number",placeholder:G.length===1?ke:`Team ${ke}`,className:`border-b ${Qe?"border-yellow-600":"border-gray-700"} bg-transparent rounded-none px-2 py-1 w-20 text-sm text-white focus:outline-none focus:border-blue-500`,value:((Dn=l[Q])==null?void 0:Dn.b)||"",onChange:Pt=>ve(Q,"b",Pt.target.value)})]}),c.jsx("button",{onClick:()=>j(Q),className:"px-3 py-1.5 text-sm text-white bg-green-600 rounded-md hover:bg-green-500 font-medium transition-colors",children:"Save Result"})]})})]},Q)}),W&&c.jsx("div",{className:"bg-yellow-800 bg-opacity-20 border border-yellow-700 rounded p-3 mt-2",children:c.jsx("p",{className:"text-yellow-400 text-sm",children:"Make sure to save match results before leaving this tab or generating new teams."})})]}),Oe.length>0&&!ce&&c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-sm font-medium text-gray-300 uppercase tracking-wider",children:"Player List"}),c.jsxs("div",{className:"text-xs text-gray-400",children:["Active Players: ",c.jsx("span",{className:"text-gray-400",children:Ge})]})]}),c.jsxs("div",{className:"flex items-center mb-2 border-b border-gray-800 pb-2",children:[c.jsx("div",{className:"w-8 flex-shrink-0",children:c.jsx("input",{type:"checkbox",checked:Ue,onChange:Pe,className:"form-checkbox h-4 w-4 text-blue-600"})}),c.jsxs("div",{className:"flex-grow flex justify-between items-center ml-3",children:[c.jsxs("button",{onClick:()=>Ne("name"),className:`text-xs font-medium flex items-center ${Y==="name"?"text-blue-400":"text-gray-400 hover:text-gray-200"}`,children:["Name",Y==="Name"&&c.jsx("span",{className:"ml-1",children:oe==="asc"?"↑":"↓"})]}),c.jsxs("button",{onClick:()=>Ne("ovr"),className:`text-xs font-medium flex items-center ${Y==="ovr"?"text-blue-400":"text-gray-400 hover:text-gray-200"}`,children:["OVR",Y==="ovr"&&c.jsx("span",{className:"ml-1",children:oe==="asc"?"↑":"↓"})]})]})]}),Oe.map(O=>{const G=V[O.name]||_e(O),Q=Ke(G);return c.jsxs("div",{className:"flex items-center border-b border-gray-800 py-2 cursor-pointer hover:bg-gray-700 transition-colors",onClick:()=>S&&S(O),children:[c.jsx("div",{className:"w-8 flex-shrink-0",children:c.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-blue-600",checked:O.active,onChange:he=>{y(O.name,he.target.checked);const ke=t.map(Qe=>Qe.name===O.name?{...Qe,active:he.target.checked}:Qe),Ve=ke.every(Qe=>Qe.active),Ce=ke.every(Qe=>!Qe.active);Ve&&!Ue?D(!0):(Ce&&Ue||!Ve&&!Ce)&&D(!1)}})}),c.jsxs("div",{className:"flex-grow ml-3",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{className:"flex items-center text-sm text-white",children:[c.jsx("span",{children:O.name}),c.jsx(sc,{playerName:O.name,currentBelts:p,size:"xs"}),c.jsx(ic,{playerName:O.name,leaderboard:w,matchHistory:_,size:"xs",maxDisplay:10})]}),c.jsx("div",{className:"text-sm font-medium text-blue-400",children:G.toFixed(1)})]}),c.jsx("div",{className:"flex items-center mt-1",children:c.jsx("div",{className:"bg-gray-800 h-1 rounded flex-grow",children:c.jsx("div",{className:"bg-blue-500 h-1 rounded",style:{width:`${Q}%`}})})})]})]},O.name)})]})]})}function kC({leaderboard:t,resetLeaderboardData:e,isAdmin:n,matchHistory:r,players:s,playerOVRs:i,onUpdateLeaderboard:o}){const[l,u]=U.useState("ovr"),[d,m]=U.useState("desc"),[g,y]=U.useState(0),[N,R]=U.useState(null),[j,k]=U.useState({wins:0,losses:0,mvps:0}),E=q=>{if(!q)return"Unknown";const X=q.trim().split(" ");if(X.length<=1)return q;const W=X[0],ne=X[X.length-1][0];return`${W} ${ne}.`},[v,b]=U.useState("all"),[P,L]=U.useState({}),V=q=>q.teamSize?q.teamSize:!q||!q.teams?0:Array.isArray(q.teams)&&q.teams.length>=1?q.teams[0].filter(X=>!X.isBench).length:q.teamA?q.teamA.filter(X=>!X.isBench).length:0,T=(q,X)=>{if(!q||q.length===0)return[];if(X==="all")return q;const W=parseInt(X.split("v")[0]);return isNaN(W)?q:q.filter(ne=>V(ne)===W)},p=q=>{var $,Y;if(!r||r.length===0)return[];let X;v==="all"?X=r:X=T(r,v);const W=[...X].sort((J,oe)=>new Date(oe.date)-new Date(J.date)),ne=[];for(const J of W){let oe=[],K=[];if(J.teams&&Array.isArray(J.teams)&&J.teams.length>=2)oe=J.teams[0].map(D=>D.name),K=J.teams[1].map(D=>D.name);else if(J.teamA&&J.teamB)oe=J.teamA.map(D=>D.name),K=J.teamB.map(D=>D.name);else continue;const Ue=oe.includes(q)?"A":K.includes(q)?"B":null;if(Ue){const D=parseInt(($=J.score)==null?void 0:$.a)||0,de=parseInt((Y=J.score)==null?void 0:Y.b)||0,ge=Ue==="A"&&D>de||Ue==="B"&&de>D,xe=J.mvp===q;if(ne.push({won:ge,isMVP:xe}),ne.length>=10)break}}return ne},w=q=>{const X=p(q);if(X.length<2)return 0;const W=X.slice(0,2),ne=X.slice(2,4);if(W.length<2||ne.length<2)return 0;const $=W.filter(K=>K.won).length,Y=ne.filter(K=>K.won).length;if($>Y)return 2;if($<Y)return 1;const J=W.filter(K=>K.isMVP).length,oe=ne.filter(K=>K.isMVP).length;return J>oe?2:J<oe?-1:0},S=[...Object.entries(P||{}).map(([q,X])=>{const W=s.find(Ue=>Ue.name===q)||{},ne=p(q),$=ne.filter(Ue=>Ue.won).length,Y=ne.length-$,J=(X._w||0)+(X._l||0),oe=ne.length;let K;return oe<J&&J<=10?K=`${X._w||0}-${X._l||0}`:K=$+Y>0?`${$}-${Y}`:"0-0",{name:q,ovr:i[q]||5,trend:w(q),wins:X._w||0,losses:X._l||0,mvps:X.MVPs||0,pct:X._w+X._l>0?(X._w/(X._w+X._l)*100).toFixed(1):"0.0",last10Record:K,scoring:W.scoring||5,defense:W.defense||5,rebounding:W.rebounding||5,playmaking:W.playmaking||5,stamina:W.stamina||5,physicality:W.physicality||5,xfactor:W.xfactor||5}})].sort((q,X)=>{let W=q[l],ne=X[l];if(l==="name")return d==="asc"?W.localeCompare(ne):ne.localeCompare(W);if(l==="last10Record"){const[$]=W.split("-").map(Number),[Y]=ne.split("-").map(Number);return d==="asc"?$-Y:Y-$}return typeof W=="string"&&(W=parseFloat(W)),typeof ne=="string"&&(ne=parseFloat(ne)),d==="asc"?W-ne:ne-W}),C=q=>{l===q?m(d==="asc"?"desc":"asc"):(u(q),m("desc"))},I=q=>{R(q.name),k({wins:q.wins,losses:q.losses,mvps:q.mvps})},ce=()=>{R(null),k({wins:0,losses:0,mvps:0})},Be=()=>{if(o){const q={...t};q[N]||(q[N]={_w:0,_l:0,MVPs:0}),q[N]._w=parseInt(j.wins)||0,q[N]._l=parseInt(j.losses)||0,q[N].MVPs=parseInt(j.mvps)||0,o(q)}R(null),k({wins:0,losses:0,mvps:0})};return U.useEffect(()=>{if(!r||r.length===0||!t){L(t||{});return}if(v==="all"){L(t);return}const q=T(r,v);if(q.length===0){L({});return}const X={};q.forEach(W=>{let ne=[],$=[],Y=0,J=0,oe="";W.teams&&Array.isArray(W.teams)?(ne=W.teams[0].map(D=>D.name),$=W.teams[1].map(D=>D.name)):W.teamA&&W.teamB&&(ne=W.teamA.map(D=>D.name),$=W.teamB.map(D=>D.name)),W.score&&(Y=parseInt(W.score.a)||0,J=parseInt(W.score.b)||0),oe=W.mvp||"";const K=Y>J?ne:$,Ue=Y>J?$:ne;[...ne,...$].forEach(D=>{X[D]||(X[D]={_w:0,_l:0,MVPs:0}),K.includes(D)?X[D]._w+=1:Ue.includes(D)&&(X[D]._l+=1),D===oe&&(X[D].MVPs+=1)})}),L(X)},[v,r,t]),c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex justify-between items-center",children:n&&c.jsx(un,{onClick:e,className:"bg-red-600",children:"Reset Stats"})}),c.jsxs("div",{className:"flex items-center mb-4 overflow-x-auto scrollbar-hide pb-2 justify-center",children:[c.jsxs("div",{className:"text-center px-3",children:[c.jsx("button",{onClick:()=>b("all"),className:`transition-colors ${v==="all"?"text-blue-400 font-semibold":"text-gray-400 hover:text-gray-300"}`,children:"All"}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(r==null?void 0:r.length)||0})]}),c.jsx("span",{className:"text-gray-600",children:"|"}),c.jsxs("div",{className:"text-center px-3",children:[c.jsx("button",{onClick:()=>b("5v5"),className:`transition-colors ${v==="5v5"?"text-blue-400 font-semibold":"text-gray-400 hover:text-gray-300"}`,children:"5v5"}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(r==null?void 0:r.filter(q=>V(q)===5).length)||0})]}),c.jsx("span",{className:"text-gray-600",children:"|"}),c.jsxs("div",{className:"text-center px-3",children:[c.jsx("button",{onClick:()=>b("4v4"),className:`transition-colors ${v==="4v4"?"text-blue-400 font-semibold":"text-gray-400 hover:text-gray-300"}`,children:"4v4"}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(r==null?void 0:r.filter(q=>V(q)===4).length)||0})]}),c.jsx("span",{className:"text-gray-600",children:"|"}),c.jsxs("div",{className:"text-center px-3",children:[c.jsx("button",{onClick:()=>b("3v3"),className:`transition-colors ${v==="3v3"?"text-blue-400 font-semibold":"text-gray-400 hover:text-gray-300"}`,children:"3v3"}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(r==null?void 0:r.filter(q=>V(q)===3).length)||0})]}),c.jsx("span",{className:"text-gray-600",children:"|"}),c.jsxs("div",{className:"text-center px-3",children:[c.jsx("button",{onClick:()=>b("2v2"),className:`transition-colors ${v==="2v2"?"text-blue-400 font-semibold":"text-gray-400 hover:text-gray-300"}`,children:"2v2"}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(r==null?void 0:r.filter(q=>V(q)===2).length)||0})]}),c.jsx("span",{className:"text-gray-600",children:"|"}),c.jsxs("div",{className:"text-center px-3",children:[c.jsx("button",{onClick:()=>b("1v1"),className:`transition-colors ${v==="1v1"?"text-blue-400 font-semibold":"text-gray-400 hover:text-gray-300"}`,children:"1v1"}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(r==null?void 0:r.filter(q=>V(q)===1).length)||0})]})]}),Object.keys(t||{}).length===0?c.jsx("p",{className:"text-gray-400 text-center py-8",children:"No leaderboard data available yet."}):c.jsx("div",{className:"relative",children:c.jsx("div",{id:"stats-table-container",className:"overflow-x-auto scrollbar-hide pb-2",style:{scrollBehavior:"smooth"},children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-700",children:[c.jsx("thead",{className:"bg-gray-800 sticky top-0 z-10",children:c.jsxs("tr",{children:[c.jsxs("th",{className:"px-2 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider sticky left-0 bg-gray-800 cursor-pointer border-r border-gray-700",onClick:()=>C("name"),children:["Player ",l==="name"&&(d==="asc"?"▲":"▼")]}),c.jsx("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer min-w-[10px] whitespace-nowrap border-r border-gray-700",onClick:()=>C("ovr"),children:c.jsxs("div",{className:"flex items-center justify-center",children:[c.jsx("span",{children:"OVR"}),c.jsx("span",{className:"text-[9px] font-normal opacity-70 ml-1",children:"(+/-)"}),l==="ovr"&&c.jsx("span",{className:"ml-1",children:d==="asc"?"▲":"▼"})]})}),c.jsxs("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer border-r border-gray-700",onClick:()=>C("wins"),children:["W ",l==="wins"&&(d==="asc"?"▲":"▼")]}),c.jsxs("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer border-r border-gray-700",onClick:()=>C("losses"),children:["L ",l==="losses"&&(d==="asc"?"▲":"▼")]}),c.jsxs("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer border-r border-gray-700",onClick:()=>C("pct"),children:["W% ",l==="pct"&&(d==="asc"?"▲":"▼")]}),c.jsxs("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer border-r border-gray-700",onClick:()=>C("mvps"),children:["MVP ",l==="mvps"&&(d==="asc"?"▲":"▼")]}),c.jsxs("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer border-r border-gray-700",onClick:()=>C("last10Record"),children:["L10 ",l==="last10Record"&&(d==="asc"?"▲":"▼")]}),c.jsxs("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer border-r border-gray-700",onClick:()=>C("scoring"),children:["SCR ",l==="scoring"&&(d==="asc"?"▲":"▼")]}),c.jsxs("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer border-r border-gray-700",onClick:()=>C("defense"),children:["DEF ",l==="defense"&&(d==="asc"?"▲":"▼")]}),c.jsxs("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer border-r border-gray-700",onClick:()=>C("rebounding"),children:["REB ",l==="rebounding"&&(d==="asc"?"▲":"▼")]}),c.jsxs("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer border-r border-gray-700",onClick:()=>C("playmaking"),children:["PLY ",l==="playmaking"&&(d==="asc"?"▲":"▼")]}),c.jsxs("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer border-r border-gray-700",onClick:()=>C("stamina"),children:["STM ",l==="stamina"&&(d==="asc"?"▲":"▼")]}),c.jsxs("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer border-r border-gray-700",onClick:()=>C("physicality"),children:["PHY ",l==="physicality"&&(d==="asc"?"▲":"▼")]}),c.jsxs("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer border-r border-gray-700",onClick:()=>C("xfactor"),children:["X-F ",l==="xfactor"&&(d==="asc"?"▲":"▼")]}),n&&c.jsx("th",{className:"px-1 py-3 text-center text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-700 bg-gray-900",children:S.map((q,X)=>c.jsxs("tr",{className:X%2===0?"bg-gray-900":"bg-gray-800",children:[c.jsx("td",{className:"px-2 py-3 whitespace-nowrap text-sm font-medium text-white sticky left-0 z-5 bg-inherit text-center border-r border-gray-700",children:E(q.name)}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-white text-center border-r border-gray-700",children:c.jsxs("div",{className:"flex justify-center",children:[c.jsx("span",{className:"w-7",children:q.ovr}),q.trend!==0&&c.jsx("span",{className:`text-xs ${q.trend>0?"text-green-400":q.trend<0?"text-red-400":""}`,children:q.trend>0?`+${q.trend}`:q.trend})]})}),N===q.name?c.jsxs(c.Fragment,{children:[c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-center border-r border-gray-700",children:c.jsx(pa,{type:"number",value:j.wins,onChange:W=>k({...j,wins:W.target.value}),className:"w-12 bg-gray-700 border-gray-600 text-center"})}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-center border-r border-gray-700",children:c.jsx(pa,{type:"number",value:j.losses,onChange:W=>k({...j,losses:W.target.value}),className:"w-12 bg-gray-700 border-gray-600 text-center"})}),c.jsxs("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-blue-400 text-center border-r border-gray-700",children:[(parseInt(j.wins)/(parseInt(j.wins)+parseInt(j.losses))*100||0).toFixed(1),"%"]}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-center border-r border-gray-700",children:c.jsx(pa,{type:"number",value:j.mvps,onChange:W=>k({...j,mvps:W.target.value}),className:"w-12 bg-gray-700 border-gray-600 text-center"})}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-gray-300 text-center border-r border-gray-700",children:q.last10Record})]}):c.jsxs(c.Fragment,{children:[c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-green-400 text-center border-r border-gray-700",children:q.wins}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-red-400 text-center border-r border-gray-700",children:q.losses}),c.jsxs("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-blue-400 text-center border-r border-gray-700",children:[q.pct,"%"]}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-yellow-400 text-center border-r border-gray-700",children:q.mvps}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-gray-300 text-center border-r border-gray-700",children:q.last10Record})]}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-gray-300 text-center border-r border-gray-700",children:q.scoring}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-gray-300 text-center border-r border-gray-700",children:q.defense}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-gray-300 text-center border-r border-gray-700",children:q.rebounding}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-gray-300 text-center border-r border-gray-700",children:q.playmaking}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-gray-300 text-center border-r border-gray-700",children:q.stamina}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-gray-300 text-center border-r border-gray-700",children:q.physicality}),c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-gray-300 text-center border-r border-gray-700",children:q.xfactor}),n&&c.jsx("td",{className:"px-1 py-3 whitespace-nowrap text-sm text-center",children:N===q.name?c.jsxs("div",{className:"flex gap-2",children:[c.jsx(un,{onClick:Be,className:"bg-green-600 hover:bg-green-700 py-1 px-2 text-xs",children:"Save"}),c.jsx(un,{onClick:ce,className:"bg-gray-600 hover:bg-gray-700 py-1 px-2 text-xs",children:"Cancel"})]}):c.jsx(un,{onClick:()=>I(q),className:"bg-blue-600 hover:bg-blue-700 py-1 px-2 text-xs",children:"Edit"})})]},q.name))})]})})})]})}function PC({player:t,onSave:e,onClose:n}){const[r,s]=U.useState({name:"",scoring:5,defense:5,rebounding:5,playmaking:5,stamina:5,physicality:5,xfactor:5,active:!0}),[i,o]=U.useState("");U.useEffect(()=>{t&&(s({name:t.name||"",scoring:t.scoring||5,defense:t.defense||5,rebounding:t.rebounding||5,playmaking:t.playmaking||5,stamina:t.stamina||5,physicality:t.physicality||5,xfactor:t.xfactor||5,active:t.active!==void 0?t.active:!0}),o(t.name||""))},[t]);const l=(g,y)=>{if(s(N=>({...N,[g]:g==="name"?y:Number(y)})),g!=="name"){const N=document.querySelector('input[type="text"]');N&&N.blur()}},u=()=>{if(!r.name.trim()){alert("Player name cannot be empty");return}e(r,i)},d=g=>g.charAt(0).toUpperCase()+g.slice(1),m=!!i;return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:c.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg w-full max-w-md max-h-[90vh] overflow-y-auto",children:[c.jsx("h2",{className:"text-xl font-bold mb-4 text-white",children:m?`Edit ${i}`:"Add New Player"}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name"}),c.jsx("input",{type:"text",value:r.name,onChange:g=>l("name",g.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Player Name"})]}),["scoring","defense","rebounding","playmaking","stamina","physicality","xfactor"].map(g=>c.jsxs("div",{className:"mb-3",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("label",{className:"text-sm font-medium text-gray-300 flex items-center",children:[d(g),c.jsx("span",{className:"ml-2",children:c.jsx(nw,{text:rw[g]})})]}),c.jsx("span",{className:"text-sm text-gray-400",children:r[g]})]}),c.jsx("input",{type:"range",min:"1",max:"10",step:"1",value:r[g],onChange:y=>l(g,y.target.value),className:"w-full mt-1 accent-blue-500"})]},g)),c.jsxs("div",{className:"flex items-center justify-between mt-6",children:[c.jsx(un,{onClick:n,className:"bg-gray-600 hover:bg-gray-700",children:"Cancel"}),c.jsx(un,{onClick:u,className:"bg-blue-600 hover:bg-blue-700",children:"Save"})]})]})})}var RC="firebase",jC="11.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Is(RC,jC,"app");function Cm(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function lw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const DC=lw,cw=new Qa("auth","Firebase",lw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc=new Bf("@firebase/auth");function VC(t,...e){Kc.logLevel<=He.WARN&&Kc.warn(`Auth (${Eo}): ${t}`,...e)}function oc(t,...e){Kc.logLevel<=He.ERROR&&Kc.error(`Auth (${Eo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(t,...e){throw km(t,...e)}function sr(t,...e){return km(t,...e)}function Am(t,e,n){const r=Object.assign(Object.assign({},DC()),{[e]:n});return new Qa("auth","Firebase",r).create(e,{appName:t.name})}function ti(t){return Am(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function MC(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&wr(t,"argument-error"),Am(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function km(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return cw.create(t,...e)}function je(t,e,...n){if(!t)throw km(e,...n)}function Dr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw oc(e),new Error(e)}function Hr(t,e){t||Dr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function LC(){return P0()==="http:"||P0()==="https:"}function P0(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(LC()||U1()||"connection"in navigator)?navigator.onLine:!0}function FC(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,n){this.shortDelay=e,this.longDelay=n,Hr(n>e,"Short delay should be less than long delay!"),this.isMobile=L1()||B1()}get(){return OC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(t,e){Hr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Dr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Dr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Dr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],$C=new nl(3e4,6e4);function Rm(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Co(t,e,n,r,s={}){return dw(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Ya(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return F1()||(d.referrerPolicy="no-referrer"),uw.fetch()(await hw(t,t.config.apiHost,n,l),d)})}async function dw(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},UC),e);try{const s=new WC(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Ol(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ol(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Ol(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Ol(t,"user-disabled",o);const m=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Am(t,m,d);wr(t,m)}}catch(s){if(s instanceof Gr)throw s;wr(t,"network-request-failed",{message:String(s)})}}async function zC(t,e,n,r,s={}){const i=await Co(t,e,n,r,s);return"mfaPendingCredential"in i&&wr(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function hw(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?Pm(t.config,s):`${t.config.apiScheme}://${s}`;return BC.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class WC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(sr(this.auth,"network-request-failed")),$C.get())})}}function Ol(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=sr(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HC(t,e){return Co(t,"POST","/v1/accounts:delete",e)}async function Qc(t,e){return Co(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ga(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function qC(t,e=!1){const n=Tn(t),r=await n.getIdToken(e),s=jm(r);je(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:ga(Id(s.auth_time)),issuedAtTime:ga(Id(s.iat)),expirationTime:ga(Id(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Id(t){return Number(t)*1e3}function jm(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return oc("JWT malformed, contained fewer than 3 sections"),null;try{const s=u_(n);return s?JSON.parse(s):(oc("Failed to decode base64 JWT payload"),null)}catch(s){return oc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function R0(t){const e=jm(t);return je(e,"internal-error"),je(typeof e.exp<"u","internal-error"),je(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function za(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Gr&&GC(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function GC({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ga(this.lastLoginAt),this.creationTime=ga(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yc(t){var e;const n=t.auth,r=await t.getIdToken(),s=await za(t,Qc(n,{idToken:r}));je(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?fw(i.providerUserInfo):[],l=YC(t.providerData,o),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),m=u?d:!1,g={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new zh(i.createdAt,i.lastLoginAt),isAnonymous:m};Object.assign(t,g)}async function QC(t){const e=Tn(t);await Yc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function YC(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function fw(t){return t.map(e=>{var{providerId:n}=e,r=Cm(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XC(t,e){const n=await dw(t,{},async()=>{const r=Ya({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await hw(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",uw.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function JC(t,e){return Co(t,"POST","/v2/accounts:revokeToken",Rm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){je(e.idToken,"internal-error"),je(typeof e.idToken<"u","internal-error"),je(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):R0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){je(e.length!==0,"internal-error");const n=R0(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(je(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await XC(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Ji;return r&&(je(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(je(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(je(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ji,this.toJSON())}_performRefresh(){return Dr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(t,e){je(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class tr{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Cm(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new KC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new zh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await za(this,this.stsTokenManager.getToken(this.auth,e));return je(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return qC(this,e)}reload(){return QC(this)}_assign(e){this!==e&&(je(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new tr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){je(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Yc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Zn(this.auth.app))return Promise.reject(ti(this.auth));const e=await this.getIdToken();return await za(this,HC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,u,d,m;const g=(r=n.displayName)!==null&&r!==void 0?r:void 0,y=(s=n.email)!==null&&s!==void 0?s:void 0,N=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,R=(o=n.photoURL)!==null&&o!==void 0?o:void 0,j=(l=n.tenantId)!==null&&l!==void 0?l:void 0,k=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,E=(d=n.createdAt)!==null&&d!==void 0?d:void 0,v=(m=n.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:b,emailVerified:P,isAnonymous:L,providerData:V,stsTokenManager:T}=n;je(b&&T,e,"internal-error");const p=Ji.fromJSON(this.name,T);je(typeof b=="string",e,"internal-error"),rs(g,e.name),rs(y,e.name),je(typeof P=="boolean",e,"internal-error"),je(typeof L=="boolean",e,"internal-error"),rs(N,e.name),rs(R,e.name),rs(j,e.name),rs(k,e.name),rs(E,e.name),rs(v,e.name);const w=new tr({uid:b,auth:e,email:y,emailVerified:P,displayName:g,isAnonymous:L,photoURL:R,phoneNumber:N,tenantId:j,stsTokenManager:p,createdAt:E,lastLoginAt:v});return V&&Array.isArray(V)&&(w.providerData=V.map(_=>Object.assign({},_))),k&&(w._redirectEventId=k),w}static async _fromIdTokenResponse(e,n,r=!1){const s=new Ji;s.updateFromServerResponse(n);const i=new tr({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Yc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];je(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?fw(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Ji;l.updateFromIdToken(r);const u=new tr({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new zh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j0=new Map;function Vr(t){Hr(t instanceof Function,"Expected a class definition");let e=j0.get(t);return e?(Hr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,j0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}mw.type="NONE";const D0=mw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ac(t,e,n){return`firebase:${t}:${e}:${n}`}class Zi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=ac(this.userKey,s.apiKey,i),this.fullPersistenceKey=ac("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Qc(this.auth,{idToken:e}).catch(()=>{});return n?tr._fromGetAccountInfoResponse(this.auth,n,e):null}return tr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Zi(Vr(D0),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Vr(D0);const o=ac(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const m=await d._get(o);if(m){let g;if(typeof m=="string"){const y=await Qc(e,{idToken:m}).catch(()=>{});if(!y)break;g=await tr._fromGetAccountInfoResponse(e,y,m)}else g=tr._fromJSON(e,m);d!==i&&(l=g),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Zi(i,e,r):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Zi(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(vw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(pw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(xw(e))return"Blackberry";if(ww(e))return"Webos";if(gw(e))return"Safari";if((e.includes("chrome/")||yw(e))&&!e.includes("edge/"))return"Chrome";if(_w(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function pw(t=on()){return/firefox\//i.test(t)}function gw(t=on()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function yw(t=on()){return/crios\//i.test(t)}function vw(t=on()){return/iemobile/i.test(t)}function _w(t=on()){return/android/i.test(t)}function xw(t=on()){return/blackberry/i.test(t)}function ww(t=on()){return/webos/i.test(t)}function Dm(t=on()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ZC(t=on()){var e;return Dm(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function eA(){return $1()&&document.documentMode===10}function Ew(t=on()){return Dm(t)||_w(t)||ww(t)||xw(t)||/windows phone/i.test(t)||vw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tw(t,e=[]){let n;switch(t){case"Browser":n=V0(on());break;case"Worker":n=`${V0(on())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Eo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nA(t,e={}){return Co(t,"GET","/v2/passwordPolicy",Rm(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA=6;class sA{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:rA,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new M0(this),this.idTokenSubscription=new M0(this),this.beforeStateQueue=new tA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Vr(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Zi.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Qc(this,{idToken:e}),r=await tr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Zn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return je(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Yc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=FC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Zn(this.app))return Promise.reject(ti(this));const n=e?Tn(e):null;return n&&je(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&je(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Zn(this.app)?Promise.reject(ti(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Zn(this.app)?Promise.reject(ti(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await nA(this),n=new sA(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qa("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await JC(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Vr(e)||this._popupRedirectResolver;je(n,this,"argument-error"),this.redirectPersistenceManager=await Zi.create(this,[Vr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(je(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return je(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Tw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if(Zn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&VC(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Ru(t){return Tn(t)}class M0{constructor(e){this.auth=e,this.observer=null,this.addObserver=Y1(n=>this.observer=n)}get next(){return je(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function oA(t){Vm=t}function aA(t){return Vm.loadJS(t)}function lA(){return Vm.gapiScript}function cA(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uA(t,e){const n=zf(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(ai(i,e??{}))return s;wr(s,"already-initialized")}return n.initialize({options:e})}function dA(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Vr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function hA(t,e,n){const r=Ru(t);je(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Iw(e),{host:o,port:l}=fA(e),u=l===null?"":`:${l}`,d={url:`${i}//${o}${u}/`},m=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){je(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),je(ai(d,r.config.emulator)&&ai(m,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=m,r.settings.appVerificationDisabledForTesting=!0,mA()}function Iw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function fA(t){const e=Iw(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:L0(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:L0(o)}}}function L0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function mA(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Dr("not implemented")}_getIdTokenResponse(e){return Dr("not implemented")}_linkToIdToken(e,n){return Dr("not implemented")}_getReauthenticationResolver(e){return Dr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eo(t,e){return zC(t,"POST","/v1/accounts:signInWithIdp",Rm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA="http://localhost";class hi extends bw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new hi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):wr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Cm(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new hi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return eo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,eo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,eo(e,n)}buildRequest(){const e={requestUri:pA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ya(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl extends Mm{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls extends rl{constructor(){super("facebook.com")}static credential(e){return hi._fromParams({providerId:ls.PROVIDER_ID,signInMethod:ls.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ls.credentialFromTaggedObject(e)}static credentialFromError(e){return ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ls.credential(e.oauthAccessToken)}catch{return null}}}ls.FACEBOOK_SIGN_IN_METHOD="facebook.com";ls.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr extends rl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return hi._fromParams({providerId:kr.PROVIDER_ID,signInMethod:kr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return kr.credentialFromTaggedObject(e)}static credentialFromError(e){return kr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return kr.credential(n,r)}catch{return null}}}kr.GOOGLE_SIGN_IN_METHOD="google.com";kr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs extends rl{constructor(){super("github.com")}static credential(e){return hi._fromParams({providerId:cs.PROVIDER_ID,signInMethod:cs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cs.credentialFromTaggedObject(e)}static credentialFromError(e){return cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return cs.credential(e.oauthAccessToken)}catch{return null}}}cs.GITHUB_SIGN_IN_METHOD="github.com";cs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us extends rl{constructor(){super("twitter.com")}static credential(e,n){return hi._fromParams({providerId:us.PROVIDER_ID,signInMethod:us.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return us.credentialFromTaggedObject(e)}static credentialFromError(e){return us.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return us.credential(n,r)}catch{return null}}}us.TWITTER_SIGN_IN_METHOD="twitter.com";us.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await tr._fromIdTokenResponse(e,r,s),o=O0(r);return new vo({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=O0(r);return new vo({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function O0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc extends Gr{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Xc.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Xc(e,n,r,s)}}function Sw(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Xc._fromErrorAndOperation(t,i,e,r):i})}async function gA(t,e,n=!1){const r=await za(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return vo._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yA(t,e,n=!1){const{auth:r}=t;if(Zn(r.app))return Promise.reject(ti(r));const s="reauthenticate";try{const i=await za(t,Sw(r,s,e,t),n);je(i.idToken,r,"internal-error");const o=jm(i.idToken);je(o,r,"internal-error");const{sub:l}=o;return je(t.uid===l,r,"user-mismatch"),vo._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&wr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vA(t,e,n=!1){if(Zn(t.app))return Promise.reject(ti(t));const r="signIn",s=await Sw(t,r,e),i=await vo._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function _A(t,e,n,r){return Tn(t).onIdTokenChanged(e,n,r)}function xA(t,e,n){return Tn(t).beforeAuthStateChanged(e,n)}function wA(t,e,n,r){return Tn(t).onAuthStateChanged(e,n,r)}function EA(t){return Tn(t).signOut()}const Jc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Jc,"1"),this.storage.removeItem(Jc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA=1e3,IA=10;class Cw extends Nw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ew(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);eA()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,IA):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},TA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Cw.type="LOCAL";const bA=Cw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw extends Nw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Aw.type="SESSION";const kw=Aw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SA(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new ju(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async d=>d(n.origin,i)),u=await SA(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ju.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lm(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const d=Lm("",20);s.port1.start();const m=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(g){const y=g;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(m),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(y.data.response);break;default:clearTimeout(m),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _r(){return window}function CA(t){_r().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(){return typeof _r().WorkerGlobalScope<"u"&&typeof _r().importScripts=="function"}async function AA(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function kA(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function PA(){return Pw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw="firebaseLocalStorageDb",RA=1,Zc="firebaseLocalStorage",jw="fbase_key";class sl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Du(t,e){return t.transaction([Zc],e?"readwrite":"readonly").objectStore(Zc)}function jA(){const t=indexedDB.deleteDatabase(Rw);return new sl(t).toPromise()}function Wh(){const t=indexedDB.open(Rw,RA);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Zc,{keyPath:jw})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Zc)?e(r):(r.close(),await jA(),e(await Wh()))})})}async function F0(t,e,n){const r=Du(t,!0).put({[jw]:e,value:n});return new sl(r).toPromise()}async function DA(t,e){const n=Du(t,!1).get(e),r=await new sl(n).toPromise();return r===void 0?null:r.value}function U0(t,e){const n=Du(t,!0).delete(e);return new sl(n).toPromise()}const VA=800,MA=3;class Dw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Wh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>MA)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Pw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ju._getInstance(PA()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await AA(),!this.activeServiceWorker)return;this.sender=new NA(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||kA()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Wh();return await F0(e,Jc,"1"),await U0(e,Jc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>F0(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>DA(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>U0(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Du(s,!1).getAll();return new sl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),VA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Dw.type="LOCAL";const LA=Dw;new nl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vw(t,e){return e?Vr(e):(je(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om extends bw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return eo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return eo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return eo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function OA(t){return vA(t.auth,new Om(t),t.bypassAuthState)}function FA(t){const{auth:e,user:n}=t;return je(n,e,"internal-error"),yA(n,new Om(t),t.bypassAuthState)}async function UA(t){const{auth:e,user:n}=t;return je(n,e,"internal-error"),gA(n,new Om(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return OA;case"linkViaPopup":case"linkViaRedirect":return UA;case"reauthViaPopup":case"reauthViaRedirect":return FA;default:wr(this.auth,"internal-error")}}resolve(e){Hr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Hr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BA=new nl(2e3,1e4);async function $A(t,e,n){if(Zn(t.app))return Promise.reject(sr(t,"operation-not-supported-in-this-environment"));const r=Ru(t);MC(t,e,Mm);const s=Vw(r,n);return new Js(r,"signInViaPopup",e,s).executeNotNull()}class Js extends Mw{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Js.currentPopupAction&&Js.currentPopupAction.cancel(),Js.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return je(e,this.auth,"internal-error"),e}async onExecution(){Hr(this.filter.length===1,"Popup operations only handle one event");const e=Lm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(sr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(sr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Js.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(sr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,BA.get())};e()}}Js.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zA="pendingRedirect",lc=new Map;class WA extends Mw{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=lc.get(this.auth._key());if(!e){try{const r=await HA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}lc.set(this.auth._key(),e)}return this.bypassAuthState||lc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function HA(t,e){const n=KA(e),r=GA(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function qA(t,e){lc.set(t._key(),e)}function GA(t){return Vr(t._redirectPersistence)}function KA(t){return ac(zA,t.config.apiKey,t.name)}async function QA(t,e,n=!1){if(Zn(t.app))return Promise.reject(ti(t));const r=Ru(t),s=Vw(r,e),o=await new WA(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YA=10*60*1e3;class XA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!JA(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Lw(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(sr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=YA&&this.cachedEventUids.clear(),this.cachedEventUids.has(B0(e))}saveEventToCache(e){this.cachedEventUids.add(B0(e)),this.lastProcessedEventTime=Date.now()}}function B0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Lw({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function JA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Lw(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZA(t,e={}){return Co(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,tk=/^https?/;async function nk(t){if(t.config.emulator)return;const{authorizedDomains:e}=await ZA(t);for(const n of e)try{if(rk(n))return}catch{}wr(t,"unauthorized-domain")}function rk(t){const e=$h(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!tk.test(n))return!1;if(ek.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sk=new nl(3e4,6e4);function $0(){const t=_r().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function ik(t){return new Promise((e,n)=>{var r,s,i;function o(){$0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{$0(),n(sr(t,"network-request-failed"))},timeout:sk.get()})}if(!((s=(r=_r().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=_r().gapi)===null||i===void 0)&&i.load)o();else{const l=cA("iframefcb");return _r()[l]=()=>{gapi.load?o():n(sr(t,"network-request-failed"))},aA(`${lA()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw cc=null,e})}let cc=null;function ok(t){return cc=cc||ik(t),cc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak=new nl(5e3,15e3),lk="__/auth/iframe",ck="emulator/auth/iframe",uk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function hk(t){const e=t.config;je(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Pm(e,ck):`https://${t.config.authDomain}/${lk}`,r={apiKey:e.apiKey,appName:t.name,v:Eo},s=dk.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Ya(r).slice(1)}`}async function fk(t){const e=await ok(t),n=_r().gapi;return je(n,t,"internal-error"),e.open({where:document.body,url:hk(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:uk,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=sr(t,"network-request-failed"),l=_r().setTimeout(()=>{i(o)},ak.get());function u(){_r().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},pk=500,gk=600,yk="_blank",vk="http://localhost";class z0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _k(t,e,n,r=pk,s=gk){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},mk),{width:r.toString(),height:s.toString(),top:i,left:o}),d=on().toLowerCase();n&&(l=yw(d)?yk:n),pw(d)&&(e=e||vk,u.scrollbars="yes");const m=Object.entries(u).reduce((y,[N,R])=>`${y}${N}=${R},`,"");if(ZC(d)&&l!=="_self")return xk(e||"",l),new z0(null);const g=window.open(e||"",l,m);je(g,t,"popup-blocked");try{g.focus()}catch{}return new z0(g)}function xk(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk="__/auth/handler",Ek="emulator/auth/handler",Tk=encodeURIComponent("fac");async function W0(t,e,n,r,s,i){je(t.config.authDomain,t,"auth-domain-config-required"),je(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Eo,eventId:s};if(e instanceof Mm){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Q1(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,g]of Object.entries({}))o[m]=g}if(e instanceof rl){const m=e.getScopes().filter(g=>g!=="");m.length>0&&(o.scopes=m.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const m of Object.keys(l))l[m]===void 0&&delete l[m];const u=await t._getAppCheckToken(),d=u?`#${Tk}=${encodeURIComponent(u)}`:"";return`${Ik(t)}?${Ya(l).slice(1)}${d}`}function Ik({config:t}){return t.emulator?Pm(t,Ek):`https://${t.authDomain}/${wk}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bd="webStorageSupport";class bk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=kw,this._completeRedirectFn=QA,this._overrideRedirectResult=qA}async _openPopup(e,n,r,s){var i;Hr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await W0(e,n,r,$h(),s);return _k(e,o,Lm())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await W0(e,n,r,$h(),s);return CA(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Hr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await fk(e),r=new XA(e);return n.register("authEvent",s=>(je(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(bd,{type:bd},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[bd];o!==void 0&&n(!!o),wr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=nk(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Ew()||gw()||Dm()}}const Sk=bk;var H0="@firebase/auth",q0="1.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){je(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ck(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Ak(t){co(new li("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;je(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Tw(t)},d=new iA(r,s,i,u);return dA(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),co(new li("auth-internal",e=>{const n=Ru(e.getProvider("auth").getImmediate());return(r=>new Nk(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Is(H0,q0,Ck(t)),Is(H0,q0,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk=5*60,Pk=f_("authIdTokenMaxAge")||kk;let G0=null;const Rk=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Pk)return;const s=n==null?void 0:n.token;G0!==s&&(G0=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function jk(t=y_()){const e=zf(t,"auth");if(e.isInitialized())return e.getImmediate();const n=uA(t,{popupRedirectResolver:Sk,persistence:[LA,bA,kw]}),r=f_("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=Rk(i.toString());xA(n,o,()=>o(n.currentUser)),_A(n,l=>o(l))}}const s=d_("auth");return s&&hA(n,`http://${s}`),n}function Dk(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}oA({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=sr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Dk().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Ak("Browser");const Vk={apiKey:"AIzaSyCOGeIQoPX7kNVIHUipxBlJIAYissB2AqM",authDomain:"bball-team-generator.firebaseapp.com",projectId:"bball-team-generator",storageBucket:"bball-team-generator.firebasestorage.app",messagingSenderId:"698253006350",appId:"1:698253006350:web:ddb9e7e799c034b61c8e5f",measurementId:"G-41WKPGWFMK"},Ow=Sg().length?Sg()[0]:g_(Vk),Hh=jk(Ow);pm(Ow);const Qn=async(t,e,n,r,s,i=!1)=>{if(!t||!e)return console.warn("logActivity: Missing db or leagueId, skipping activity logging"),!0;try{console.log("Logging activity:",n,"with details:",r);const o=s?{uid:s.uid||"unknown",displayName:s.displayName||"",email:s.email||""}:{uid:"unknown",displayName:"Unknown User",email:""};let l={...r};if(["player_rating_updated","player_rating_added","player_rating_changed"].includes(n)){const d=r.playerName||r.name||r.player||"Unknown Player";l.playerName=d,l.name=d,l.player=d,console.log("Enhanced player name in log details:",d)}const u={action:n,details:l,userId:o.uid,userName:o.displayName||o.email||"Anonymous",timestamp:new Date,undoable:!!i};console.log("Final log entry before saving:",u);try{const d=di(t,"leagues",e,"logs"),m=We(d);return await tt(m,u),console.log("Activity logged successfully:",n),!0}catch(d){return console.error("Firestore error logging activity:",d),!1}}catch(o){return console.error("Unexpected error in logActivity:",o),!1}},Sr=pm();function Mk({user:t,onSelectLeague:e}){const[n,r]=U.useState([]),[s,i]=U.useState(""),[o,l]=U.useState(""),[u,d]=U.useState(""),[m,g]=U.useState(""),[y,N]=U.useState(!0);U.useEffect(()=>{if(!t){r([]),N(!1);return}(async()=>{try{N(!0);const v=We(Sr,"users",t.uid),b=await rt(v);if(!b.exists()){await tt(v,{email:t.email,displayName:t.displayName,photoURL:t.photoURL,leagues:[]}),r([]),N(!1);return}const L=b.data().leagues||[];if(L.length===0){r([]),N(!1);return}const V=await Promise.all(L.map(async p=>{const w=We(Sr,"leagues",p),_=await rt(w);return _.exists()?{id:p,..._.data()}:null}));r(V.filter(p=>p!==null));const T=localStorage.getItem("lastUsedLeagueId");T&&V.some(p=>(p==null?void 0:p.id)===T)&&e(T)}catch(v){console.error("Error fetching leagues:",v),d("Failed to load your leagues. Please try again.")}finally{N(!1)}})()},[t,e]);const R=async()=>{if(!t){d("You must be logged in to create a league");return}if(!s.trim()){d("Please enter a league name");return}try{N(!0);const E=Math.random().toString(36).substring(2,8).toUpperCase(),v=di(Sr,"leagues"),b=We(v);await tt(b,{name:s.trim(),inviteCode:E,createdAt:new Date,createdBy:t.uid,members:[t.uid],admins:[t.uid]});const P=We(Sr,"users",t.uid),L=await rt(P);if(L.exists()){const V=L.data(),T=[...V.leagues||[],b.id];await tt(P,{...V,leagues:T});const p=We(Sr,"leagues",b.id,"sets","default");await tt(p,{players:[],teams:[],matchups:[],scores:[],mvpVotes:[],leaderboard:{},matchHistory:[]});const w={id:b.id,name:s.trim(),inviteCode:E};r([...n,w]),i(""),g("League created successfully!"),e(b.id),localStorage.setItem("lastUsedLeagueId",b.id)}}catch(E){console.error("Error creating league:",E),d("Failed to create league. Please try again.")}finally{N(!1)}},j=async()=>{if(!t){d("You must be logged in to join a league");return}if(!o.trim()){d("Please enter an invite code");return}try{N(!0);const E=di(Sr,"leagues"),v=ur(E,ma("inviteCode","==",o.trim().toUpperCase())),b=await dr(v);if(b.empty){d("Invalid invite code. Please check and try again.");return}const P=b.docs[0],L=P.data(),V=P.id;if(L.members.includes(t.uid)){d("You are already a member of this league");return}await tt(We(Sr,"leagues",V),{...L,members:[...L.members,t.uid]});const T=We(Sr,"users",t.uid),p=await rt(T);if(p.exists()){const w=p.data(),_=w.leagues||[];if(!_.includes(V)){const C=[..._,V];await tt(T,{...w,leagues:C})}const S={id:V,name:L.name,inviteCode:L.inviteCode};r([...n,S]),l(""),g("Successfully joined the league!"),await Qn(Sr,V,"user_joined_league",{userId:t.uid,userName:t.displayName||t.email,leagueName:L.name,inviteCode:L.inviteCode},t,!1),e(V),localStorage.setItem("lastUsedLeagueId",V)}}catch(E){console.error("Error joining league:",E),d("Failed to join league. Please try again.")}finally{N(!1)}},k=E=>{e(E),localStorage.setItem("lastUsedLeagueId",E)};return c.jsxs(tw,{className:"bg-gray-900",children:[m&&c.jsx("div",{className:"bg-green-800 text-green-100 p-4 rounded mb-6",children:m}),u&&c.jsx("div",{className:"bg-red-800 text-red-100 p-4 rounded mb-6",children:u}),m&&c.jsx("div",{className:"bg-green-800 text-green-100 p-4 rounded mb-6",children:m}),u&&c.jsx("div",{className:"bg-red-800 text-red-100 p-4 rounded mb-6",children:u}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg",children:[c.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Create New League"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-gray-300 mb-2",children:"League Name"}),c.jsx(pa,{type:"text",value:s,onChange:E=>i(E.target.value),placeholder:"Enter league name",disabled:!t||y})]}),c.jsx(un,{onClick:R,className:`w-full ${t?"bg-blue-600":"bg-gray-600"}`,disabled:!t||y,children:y?"Creating...":"Create League"})]})]}),c.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg",children:[c.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Join League"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-gray-300 mb-2",children:"Invite Code"}),c.jsx(pa,{type:"text",value:o,onChange:E=>l(E.target.value),placeholder:"Enter invite code",disabled:!t||y})]}),c.jsx(un,{onClick:j,className:`w-full ${t?"bg-green-600":"bg-gray-600"}`,disabled:!t||y,children:y?"Joining...":"Join League"})]})]})]}),c.jsxs("div",{className:"mt-8",children:[c.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Your Leagues"}),y?c.jsx("div",{className:"text-gray-400",children:"Loading your leagues..."}):n.length===0?c.jsx("div",{className:"text-gray-400 p-4 bg-gray-800 rounded-lg",children:t?"You haven't joined any leagues yet.":"Sign in to see your leagues."}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map(E=>c.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg hover:bg-gray-700 cursor-pointer transition",onClick:()=>k(E.id),children:[c.jsx("h3",{className:"text-lg font-medium text-white",children:E.name}),c.jsxs("div",{className:"text-sm text-gray-400 mt-2",children:["Invite Code: ",c.jsx("span",{className:"text-gray-300",children:E.inviteCode})]})]},E.id))})]})]})}function K0({user:t,currentLeague:e,handleBackToLeagues:n}){const[r,s]=U.useState(!1),i=U.useRef(null),o=()=>{s(!r)},l=d=>{d.stopPropagation(),e!=null&&e.inviteCode&&navigator.clipboard.writeText(e.inviteCode).then(()=>{alert("Invite code copied to clipboard!")}).catch(m=>{console.error("Failed to copy: ",m)})},u=d=>{d.stopPropagation(),EA(Hh)};return U.useEffect(()=>{const d=m=>{i.current&&!i.current.contains(m.target)&&s(!1)};return document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[]),t?c.jsxs("div",{className:"relative",ref:i,children:[c.jsx("button",{onClick:o,className:"w-8 h-8 flex items-center justify-center rounded-md bg-gray-700 hover:bg-gray-600 transition-colors","aria-label":"User menu",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-200",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})}),r&&c.jsxs("div",{className:"absolute right-0 mt-1 w-60 bg-gray-800 rounded-md shadow-lg z-50 border border-gray-700",children:[c.jsxs("div",{className:"py-1.5 px-2 border-b border-gray-700",children:[c.jsx("p",{className:"text-gray-200 font-medium truncate text-sm",children:t.displayName}),c.jsx("p",{className:"text-gray-400 text-xs truncate",children:t.email})]}),e&&c.jsxs("div",{className:"py-1.5 px-2 border-b border-gray-700",children:[c.jsx("p",{className:"text-gray-300 text-xs font-medium",children:"Current League"}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("p",{className:"text-white text-sm",children:e.name}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-gray-400 text-xs mr-1 truncate",children:e.inviteCode}),c.jsx("button",{onClick:l,className:"text-blue-400 hover:text-blue-300",title:"Copy invite code",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]})]}),c.jsxs("div",{className:"py-0.5",children:[e&&c.jsxs("button",{onClick:d=>{d.stopPropagation(),n(),s(!1)},className:"w-full text-left px-2 py-1 text-gray-300 hover:bg-gray-700 rounded flex items-center text-xs",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 17l-5-5m0 0l5-5m-5 5h12"})}),"Back to Leagues"]}),c.jsxs("button",{onClick:u,className:"w-full text-left px-2 py-1 text-gray-300 hover:bg-gray-700 rounded flex items-center text-xs",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Log out"]})]})]})]}):null}function Lk({isOpen:t,onClose:e,onConfirm:n,title:r,message:s,confirmText:i="Confirm",cancelText:o="Cancel",isDestructive:l=!1}){const u=U.useRef(null);return U.useEffect(()=>{const d=m=>{u.current&&!u.current.contains(m.target)&&e()};return t&&document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[t,e]),U.useEffect(()=>{const d=m=>{m.key==="Escape"&&e()};return t&&document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}},[t,e]),t?c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:c.jsxs("div",{ref:u,className:"bg-gray-800 rounded-lg p-6 w-full max-w-md shadow-xl border border-gray-700",children:[c.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:r}),c.jsx("p",{className:"text-gray-300 mb-6",children:s}),c.jsxs("div",{className:"flex justify-end space-x-4",children:[c.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 transition-colors",children:o}),c.jsx("button",{onClick:n,className:`px-4 py-2 ${l?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"} text-white rounded transition-colors`,children:i})]})]})}):null}function Ok({isOpen:t,onClose:e,matchResults:n,teams:r}){const[s,i]=U.useState(!1),o=U.useRef(null),l=U.useRef(null),u=_=>_.teams?{teamA:_.teams[0]||[],teamB:_.teams[1]||[]}:_.teamA?{teamA:_.teamA||[],teamB:_.teamB||[]}:{teamA:[],teamB:[]},d=(_,S)=>!_||_.length===0?`Team ${S}`:_.length===1?_[0].name||`Team ${S}`:`Team ${S}`;U.useEffect(()=>(t?setTimeout(()=>{i(!0),m()},100):i(!1),()=>{o.current&&clearInterval(o.current)}),[t]);const m=()=>{if(!l.current)return;o.current&&clearInterval(o.current);const _=["#FFD700","#FF0000","#0000FF","#00FF00","#FFFFFF","#FFA500","#9400D3"],S=l.current,C=()=>{const I=document.createElement("div"),ce=Math.floor(Math.random()*10)+5;I.style.position="absolute",I.style.width=ce+"px",I.style.height=ce+"px",I.style.backgroundColor=_[Math.floor(Math.random()*_.length)],I.style.borderRadius=Math.random()>.5?"50%":"0",I.style.left=Math.random()*100+"%",I.style.top="-20px",I.style.opacity=Math.random()*.7+.3,I.style.transform=`rotate(${Math.random()*360}deg)`,I.style.zIndex="999",I.style.transition=`all ${Math.random()*3+2}s ease-out`,S.appendChild(I),setTimeout(()=>{I.style.top="100%",I.style.left=`${parseInt(I.style.left)+(Math.random()*40-20)}%`,I.style.transform=`rotate(${Math.random()*720}deg)`,I.style.opacity="0"},10),setTimeout(()=>{I.parentNode===S&&S.removeChild(I)},5e3)};for(let I=0;I<50;I++)C();o.current=setInterval(()=>{for(let I=0;I<5;I++)C()},300),setTimeout(()=>{o.current&&(clearInterval(o.current),o.current=null)},4e3)};if(!t||!n||n.length===0)return null;let g=0,y=0;n.forEach(_=>{var I,ce;const S=parseInt((I=_.score)==null?void 0:I.a)||0,C=parseInt((ce=_.score)==null?void 0:ce.b)||0;S>C?g++:C>S&&y++});const N=g>y,R=y>g,j=g===y,k=n[0],{teamA:E,teamB:v}=u(k),b=d(E,"A"),P=d(v,"B"),L=n.reduce((_,S)=>{var C;return _+(parseInt((C=S.score)==null?void 0:C.a)||0)},0),V=n.reduce((_,S)=>{var C;return _+(parseInt((C=S.score)==null?void 0:C.b)||0)},0),T={};n.forEach(_=>{_.mvp&&(T[_.mvp]=(T[_.mvp]||0)+1)});const p=Math.max(...Object.values(T),0),w=Object.keys(T).filter(_=>T[_]===p);return c.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70",children:[c.jsx("div",{ref:l,className:"absolute inset-0 overflow-hidden pointer-events-none"}),c.jsxs("div",{className:`w-full max-w-sm bg-gray-800 rounded-lg shadow-2xl overflow-hidden transform transition-all duration-500 ${s?"scale-100 opacity-100":"scale-95 opacity-0"}`,style:{maxHeight:"85vh"},children:[c.jsxs("div",{className:"bg-gradient-to-r from-yellow-600 via-yellow-500 to-yellow-600 p-3 text-center relative overflow-hidden",children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-1 drop-shadow-lg relative z-10",children:j?"It's a Tie!":"Match Complete!"}),!j&&c.jsxs("div",{className:"text-lg font-bold text-white mb-2 relative z-10",children:[N?b:P," Wins!"]}),c.jsx("div",{className:"text-sm text-white opacity-80 relative z-10",children:j?"Evenly matched!":"Congratulations to the winners!"})]}),c.jsxs("div",{className:"p-3 space-y-3",children:[c.jsxs("div",{className:"bg-gray-700 rounded-lg p-2",children:[c.jsx("h3",{className:"text-sm font-semibold text-white mb-2",children:"Match Results"}),c.jsxs("div",{className:"flex justify-around items-center text-center",children:[c.jsxs("div",{className:`p-2 rounded-lg ${N?"bg-green-900 bg-opacity-40 ring-1 ring-green-500":"bg-gray-800"}`,children:[c.jsx("div",{className:"text-xs font-bold text-white",children:b}),c.jsx("div",{className:"text-xl font-bold text-white",children:g}),c.jsxs("div",{className:"text-xs text-gray-300",children:["Win",g!==1?"s":""]})]}),c.jsx("div",{className:"text-sm font-bold text-gray-500",children:"VS"}),c.jsxs("div",{className:`p-2 rounded-lg ${R?"bg-green-900 bg-opacity-40 ring-1 ring-green-500":"bg-gray-800"}`,children:[c.jsx("div",{className:"text-xs font-bold text-white",children:P}),c.jsx("div",{className:"text-xl font-bold text-white",children:y}),c.jsxs("div",{className:"text-xs text-gray-300",children:["Win",y!==1?"s":""]})]})]})]}),c.jsxs("div",{className:"bg-gray-700 rounded-lg p-2",children:[c.jsx("h3",{className:"text-sm font-semibold text-white mb-2",children:"Match Details"}),c.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:n.map((_,S)=>{var ce,Be,q,X,W,ne;const{teamA:C,teamB:I}=u(_);return c.jsxs("div",{className:"flex justify-between items-center bg-gray-800 p-1 rounded text-xs",children:[c.jsxs("span",{className:"text-white",children:["Game ",S+1,":"]}),c.jsxs("span",{className:"text-white",children:[c.jsx("span",{className:parseInt((ce=_.score)==null?void 0:ce.a)>parseInt((Be=_.score)==null?void 0:Be.b)?"text-green-400":"text-white",children:((q=_.score)==null?void 0:q.a)||0}),c.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),c.jsx("span",{className:parseInt((X=_.score)==null?void 0:X.b)>parseInt((W=_.score)==null?void 0:W.a)?"text-green-400":"text-white",children:((ne=_.score)==null?void 0:ne.b)||0})]}),_.mvp&&c.jsxs("span",{className:"text-yellow-400 text-xs",children:["MVP: ",_.mvp]})]},S)})}),c.jsxs("div",{className:"mt-1 text-xs text-gray-400",children:["Total: ",b," ",L," - ",V," ",P]})]}),w.length>0&&c.jsxs("div",{className:"bg-gray-700 rounded-lg p-2",children:[c.jsxs("h3",{className:"text-sm font-semibold text-white mb-2",children:["Series MVP",w.length>1?"s":""]}),c.jsx("div",{className:"flex flex-wrap justify-center gap-1",children:w.map((_,S)=>c.jsxs("div",{className:"bg-yellow-900 bg-opacity-30 border border-yellow-700 rounded p-1 text-center",children:[c.jsx("div",{className:"text-yellow-400 text-sm",children:"🏅"}),c.jsx("div",{className:"text-white text-xs",children:_}),c.jsxs("div",{className:"text-yellow-400 text-xs",children:[T[_]," MVP"]})]},S))})]}),c.jsx("div",{className:"pt-2",children:c.jsx(un,{onClick:e,className:"w-full bg-blue-600 hover:bg-blue-700 py-2",children:"Continue"})})]})]}),c.jsx("style",{jsx:"true",children:`
                @keyframes pulse {
                    0%, 100% { transform: scale(1); opacity: 0.8; }
                    50% { transform: scale(1.1); opacity: 1; }
                }
            `})]})}class Fk extends to.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,n){console.error("Error caught by boundary:",e,n),this.setState({error:e,errorInfo:n})}render(){return this.state.hasError?c.jsxs("div",{className:"p-4 bg-red-900 text-white rounded-lg m-4",children:[c.jsx("h2",{className:"text-xl font-bold mb-2",children:"Something went wrong."}),c.jsxs("details",{className:"whitespace-pre-wrap",children:[c.jsx("summary",{className:"cursor-pointer mb-2",children:"Click for details"}),this.state.error&&this.state.error.toString(),c.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]}),c.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"mt-4 px-4 py-2 bg-blue-600 rounded hover:bg-blue-700",children:"Try again"})]}):this.props.children}}function Uk({currentLeagueId:t,currentSet:e,isAdmin:n,db:r,user:s,updatePlayers:i,setToastMessage:o,updateMatchHistory:l}){const[u,d]=U.useState([]),[m,g]=U.useState(!0),[y,N]=U.useState("all"),[R,j]=U.useState(null),[k,E]=U.useState(!1),[v,b]=U.useState(null),[P,L]=U.useState(1),[V]=U.useState(10),[T,p]=U.useState(0),[w,_]=U.useState(!0),S=(D,de)=>{if(D.length!==de.length)return!1;for(let ge=0;ge<D.length;ge++)if(D[ge]!==de[ge])return!1;return!0},C=async(D=1,de=!1)=>{g(!0);try{const ge=di(r,"leagues",t,"logs");let xe=[Td("timestamp","desc")];if(y==="players"){const ve=["player_added","player_updated","player_deleted","player_rating_changed","player_rating_updated","player_rating_added"];xe.push(ma("action","in",ve)),xe.push(Nr(V*D));const Te=ur(ge,...xe),Ne=await dr(Te),Pe=[];Ne.forEach(Oe=>{var De;const Ge={id:Oe.id,...Oe.data()};(De=Ge.details)!=null&&De.fromMatch||Pe.push(Ge)});const _e=ur(ge,...xe.slice(0,-1),Nr(V*D+1)),Ie=await dr(_e);_(Ie.docs.length>Pe.length),d(Pe),p(Pe.length)}else if(y==="matches"){xe.push(ma("action","==","match_result_saved")),xe.push(Nr(V*D));const ve=ur(ge,...xe),Te=await dr(ve),Ne=[];Te.forEach(Ie=>{Ne.push({id:Ie.id,...Ie.data()})});const Pe=ur(ge,...xe.slice(0,-1),Nr(V*D+1)),_e=await dr(Pe);_(_e.docs.length>Ne.length),d(Ne),p(Ne.length)}else if(y==="admin"){const ve=["leaderboard_reset","log_deleted","schema_initialized","user_joined_league"];xe.push(ma("action","in",ve)),xe.push(Nr(V*D));const Te=ur(ge,...xe),Ne=await dr(Te),Pe=[];Ne.forEach(Oe=>{Pe.push({id:Oe.id,...Oe.data()})});const _e=ur(ge,...xe.slice(0,-1),Nr(V*D+1)),Ie=await dr(_e);_(Ie.docs.length>Pe.length),d(Pe),p(Pe.length)}else{const ve=["match_completed","teams_generated","rematch_created"];let Te=[],Ne=V*D*2,Pe=!0;for(;Te.length<V*D&&Pe;){xe=[Td("timestamp","desc"),Nr(Ne)];const _e=ur(ge,...xe),Ie=await dr(_e),Oe=[];if(Ie.forEach(Ge=>{const De={id:Ge.id,...Ge.data()};ve.includes(De.action)||Oe.push(De)}),Te=Oe,Ie.docs.length<Ne?Pe=!1:Ne*=2,Ne>1e4)break}if(d(Te),Pe&&Te.length>=V*D){const _e=ur(ge,Td("timestamp","desc"),Nr(Ne+50)),Ie=await dr(_e),Oe=[];Ie.forEach(Ge=>{const De={id:Ge.id,...Ge.data()};ve.includes(De.action)||Oe.push(De)}),_(Oe.length>Te.length)}else _(!1);p(Te.length)}de&&L(1)}catch(ge){console.error("Error fetching logs:",ge)}finally{g(!1)}};U.useEffect(()=>{t&&C(1,!0)},[t,e,y]);const I=async D=>{var de,ge,xe,ve,Te;if(!(!t||!n))try{const Ne=We(r,"leagues",t,"logs",D),Pe=await rt(Ne);if(!Pe.exists()){console.error("Log entry not found");return}const _e=Pe.data(),Ie=((de=_e.details)==null?void 0:de.playerName)||((ge=_e.details)==null?void 0:ge.name)||((xe=_e.details)==null?void 0:xe.player);let Oe={logId:D,deletedAction:_e.action,message:"Log entry was deleted"};["player_added","player_updated","player_deleted","player_rating_changed","player_rating_updated","player_rating_added"].includes(_e.action)&&Ie&&(Oe.playerName=Ie,Oe.message="Rating change was reversed"),["match_result_saved","match_completed"].includes(_e.action)&&(Oe.scoreA=(ve=_e.details)==null?void 0:ve.scoreA,Oe.scoreB=(Te=_e.details)==null?void 0:Te.scoreB,Oe.message="Match result was deleted"),_e.action==="player_added"&&Ie?await q(Ie):["player_rating_changed","player_rating_updated","player_rating_added"].includes(_e.action)?await Be(_e):["match_result_saved","match_completed"].includes(_e.action)&&await ce(_e),await yC(Ne);const Ge=We(di(r,"leagues",t,"logs"));await tt(Ge,{action:"log_deleted",details:Oe,userId:(s==null?void 0:s.uid)||"unknown",userName:(s==null?void 0:s.displayName)||(s==null?void 0:s.email)||"Admin",timestamp:new Date,undoable:!1}),d(u.filter(De=>De.id!==D)),j(null),o("Log entry deleted and action reversed"),setTimeout(()=>o(""),3e3)}catch(Ne){console.error("Error deleting log:",Ne),o("Error deleting log: "+Ne.message),setTimeout(()=>o(""),3e3)}},ce=async D=>{var _t,bt;if(!D.details){console.error("Cannot reverse match result: missing details");return}const de=We(r,"leagues",t,"sets",e),ge=await rt(de);if(!ge.exists()){console.error("Set data not found");return}const xe=ge.data();let ve={...xe.leaderboard};const Te=D.details.teamA||((_t=D.details.teams)==null?void 0:_t[0])||[],Ne=D.details.teamB||((bt=D.details.teams)==null?void 0:bt[1])||[],Pe=parseInt(D.details.scoreA)||0,_e=parseInt(D.details.scoreB)||0,Ie=D.details.mvp,Oe=Pe>_e,Ge=Oe?Te:Ne,De=Oe?Ne:Te;Ge&&Ge.length>0&&Ge.forEach(be=>{typeof be=="string"&&ve[be]?ve[be]._w=Math.max(0,(ve[be]._w||0)-1):be.name&&ve[be.name]&&(ve[be.name]._w=Math.max(0,(ve[be.name]._w||0)-1))}),De&&De.length>0&&De.forEach(be=>{typeof be=="string"&&ve[be]?ve[be]._l=Math.max(0,(ve[be]._l||0)-1):be.name&&ve[be.name]&&(ve[be.name]._l=Math.max(0,(ve[be.name]._l||0)-1))}),Ie&&ve[Ie]&&(ve[Ie].MVPs=Math.max(0,(ve[Ie].MVPs||0)-1));let at=[...xe.matchHistory||[]];const Ke=at.findIndex(be=>{let nt=[],O=[];Array.isArray(be.teams)&&be.teams.length>=2?(nt=be.teams[0].map(Ce=>typeof Ce=="string"?Ce:Ce.name),O=be.teams[1].map(Ce=>typeof Ce=="string"?Ce:Ce.name)):be.teamA&&be.teamB&&(nt=be.teamA.map(Ce=>typeof Ce=="string"?Ce:Ce.name),O=be.teamB.map(Ce=>typeof Ce=="string"?Ce:Ce.name));const G=Te.map(Ce=>Ce),Q=Ne.map(Ce=>Ce),he=S(nt.sort(),G.sort())&&S(O.sort(),Q.sort())||S(nt.sort(),Q.sort())&&S(O.sort(),G.sort()),ke=be.score&&parseInt(be.score.a)===Pe&&parseInt(be.score.b)===_e,Ve=!Ie||be.mvp===Ie;return he&&ke&&Ve});if(Ke!==-1){if(at.splice(Ke,1),console.log("Removed match from history at index:",Ke),typeof l=="function"){const be=at.map(nt=>nt.teams?nt:{teams:[nt.teamA||[],nt.teamB||[]],score:nt.score,mvp:nt.mvp||"",date:nt.date});l(be)}}else console.warn("Could not find matching match in history to remove");await tt(de,{...xe,leaderboard:ve,matchHistory:at}),console.log("Reversed match result in leaderboard and removed from match history")},Be=async D=>{var _e,Ie,Oe,Ge;if(!((_e=D.details)!=null&&_e.playerName)&&!((Ie=D.details)!=null&&Ie.name)){console.error("Cannot reverse rating: player name missing");return}if(!D.userId){console.error("Cannot reverse rating: user ID missing");return}const de=((Oe=D.details)==null?void 0:Oe.playerName)||((Ge=D.details)==null?void 0:Ge.name);D.userId;const ge=We(r,"leagues",t,"sets",e),xe=await rt(ge);if(!xe.exists()){console.error("Set data not found");return}const ve=xe.data(),Te=[...ve.players],Ne=Te.findIndex(De=>De.name.toLowerCase()===de.toLowerCase());if(Ne===-1){console.error("Player not found:",de);return}const Pe=Te[Ne];if(D.action==="player_rating_added")if(Pe.submissions.length===1&&Pe.submissions[0].submittedBy===D.userId)Te.splice(Ne,1);else{const De=Pe.submissions.filter(Ke=>Ke.submittedBy!==D.userId);let at=0;De.length>0&&(at=De.reduce((_t,bt)=>{const{name:be,submittedBy:nt,...O}=bt,G=Object.values(O).reduce((Q,he)=>Q+he,0)/7;return _t+G},0)/De.length),Te[Ne]={...Pe,submissions:De,rating:at}}else{const De=Pe.submissions.filter(Ke=>Ke.submittedBy!==D.userId);let at=0;De.length>0&&(at=De.reduce((_t,bt)=>{const{name:be,submittedBy:nt,...O}=bt,G=Object.values(O).reduce((Q,he)=>Q+he,0)/7;return _t+G},0)/De.length),Te[Ne]={...Pe,submissions:De,rating:at||5}}await tt(ge,{...ve,players:Te}),typeof i=="function"&&i(Te),console.log(`Rating submission for ${de} by user ${D.userId} was reversed`)},q=async D=>{if(!D)return;console.log("Deleting player:",D);const de=We(r,"leagues",t,"sets",e),ge=await rt(de);if(!ge.exists()){console.error("Set data not found");return}const xe=ge.data(),ve=xe.players.findIndex(Pe=>Pe&&Pe.name&&Pe.name.toLowerCase()===D.toLowerCase());if(ve===-1){console.log("Player not found:",D);return}xe.players[ve];const Te=xe.players.filter((Pe,_e)=>_e!==ve);let Ne={...xe.leaderboard};Ne[D]&&delete Ne[D],await tt(de,{...xe,players:Te,leaderboard:Ne}),typeof i=="function"&&i(Te),console.log(`Player ${D} was deleted as a result of log deletion`)},X=D=>{if(!D)return"Unknown date";const de=D.toDate?D.toDate():new Date(D);return de.toLocaleDateString()+" "+de.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},W=D=>{var ge,xe,ve,Te,Ne,Pe,_e,Ie,Oe,Ge,De,at;const de=Ke=>Ke&&(Ke.playerName||Ke.name||Ke.player)||"Unknown Player";switch(D.action){case"player_added":return`Added player: ${de(D.details)}`;case"player_updated":return`Updated player: ${de(D.details)}`;case"player_deleted":return`Deleted player: ${de(D.details)}`;case"player_rating_changed":case"player_rating_updated":case"player_rating_added":{const Ke=de(D.details),_t=(ge=D.details)!=null&&ge.overallRating?`(${D.details.overallRating})`:"";if((xe=D.details)!=null&&xe.changedValues){const bt=Object.keys(D.details.changedValues);if(bt.length===1){const be=bt[0],nt=D.details.changedValues[be];return`Updated ${be} rating for ${Ke} from ${nt.from} to ${nt.to} ${_t}`}else if(bt.length<=3)return`Updated ratings (${bt.join(", ")}) for ${Ke} ${_t}`}return`Updated rating for ${Ke} ${_t}`}case"match_result_saved":return`Saved match result: ${((ve=D.details)==null?void 0:ve.scoreA)||0} - ${((Te=D.details)==null?void 0:Te.scoreB)||0}`;case"match_completed":{const Ke=((Ne=D.details)==null?void 0:Ne.scoreA)||0,_t=((Pe=D.details)==null?void 0:Pe.scoreB)||0,bt=`${Ke} - ${_t}`,be=(_e=D.details)!=null&&_e.mvp?`MVP: ${D.details.mvp}`:"No MVP selected";return`Completed match: ${bt} (${be})`}case"rematch_created":return"Created rematch with the same teams";case"teams_generated":return`Generated ${((Ie=D.details)==null?void 0:Ie.teamCount)||0} teams (${((Oe=D.details)==null?void 0:Oe.teamSize)||"unknown"}v${((Ge=D.details)==null?void 0:Ge.teamSize)||"unknown"})`;case"leaderboard_reset":return"Reset leaderboard";case"log_deleted":return`Deleted log and reversed ${de(D.details)||((De=D.details)==null?void 0:De.deletedAction)||"entry"}`;case"schema_initialized":return"Log system initialized";case"user_joined_league":return`User ${D.userName} joined the league`;case"rematch_created":return"Created rematch with same teams";default:return((at=D.action)==null?void 0:at.replace(/_/g," "))||"Unknown action"}},ne=D=>{var Oe,Ge,De,at,Ke,_t,bt,be,nt;if(!["match_result_saved","match_completed"].includes(D.action))return null;const de=((Ge=(Oe=D.details)==null?void 0:Oe.teams)==null?void 0:Ge[0])||((De=D.details)==null?void 0:De.teamA)||[],ge=((Ke=(at=D.details)==null?void 0:at.teams)==null?void 0:Ke[1])||((_t=D.details)==null?void 0:_t.teamB)||[],xe=((bt=D.details)==null?void 0:bt.scoreA)||0,ve=((be=D.details)==null?void 0:be.scoreB)||0,Te=((nt=D.details)==null?void 0:nt.mvp)||"",Ne=(O,G)=>!O||O.length===0?`Team ${G}`:O.length===1?(typeof O[0]=="string"?O[0]:O[0].name)||`Team ${G}`:`Team ${G}`,Pe=Ne(de,"A"),_e=Ne(ge,"B"),Ie=de.length===1&&ge.length===1;return c.jsx("div",{className:"mt-2 pt-2 border-t border-gray-700",children:c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:`p-2 rounded ${xe>ve?"bg-green-900 bg-opacity-20":"bg-red-900 bg-opacity-20"}`,children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"text-sm font-medium text-gray-300 flex-1",children:Pe}),c.jsx("span",{className:"text-sm font-bold text-white ml-2",children:xe})]}),!Ie&&c.jsx("div",{className:"space-y-1",children:Array.isArray(de)?de.map((O,G)=>{const Q=typeof O=="string"?O:O.name,he=Te===Q;return c.jsx("div",{className:"text-xs flex items-center",children:c.jsxs("span",{className:`${he?"text-yellow-400 font-medium":"text-gray-300"}`,children:[Q,he&&c.jsx("span",{className:"ml-1",children:"👑"})]})},G)}):c.jsx("div",{className:"text-xs text-gray-400",children:"No players listed"})}),Ie&&Te===(typeof de[0]=="string"?de[0]:de[0].name)&&c.jsx("div",{className:"text-yellow-400 text-xs",children:"👑 MVP"})]}),c.jsxs("div",{className:`p-2 rounded ${ve>xe?"bg-green-900 bg-opacity-20":"bg-red-900 bg-opacity-20"}`,children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("span",{className:"text-sm font-medium text-gray-300 flex-1",children:_e}),c.jsx("span",{className:"text-sm font-bold text-white ml-2",children:ve})]}),!Ie&&c.jsx("div",{className:"space-y-1",children:Array.isArray(ge)?ge.map((O,G)=>{const Q=typeof O=="string"?O:O.name,he=Te===Q;return c.jsx("div",{className:"text-xs flex items-center",children:c.jsxs("span",{className:`${he?"text-yellow-400 font-medium":"text-gray-300"}`,children:[Q,he&&c.jsx("span",{className:"ml-1",children:"👑"})]})},G)}):c.jsx("div",{className:"text-xs text-gray-400",children:"No players listed"})}),Ie&&Te===(typeof ge[0]=="string"?ge[0]:ge[0].name)&&c.jsx("div",{className:"text-yellow-400 text-xs",children:"👑 MVP"})]})]})})},$=D=>{var ve,Te,Ne,Pe,_e;const de=((ve=D.details)==null?void 0:ve.ratingData)||((Te=D.details)==null?void 0:Te.ratings)||((Ne=D.details)==null?void 0:Ne.playerData);if(!de)return null;const ge=(Pe=D.details)==null?void 0:Pe.changedValues,xe=(_e=D.details)==null?void 0:_e.previousRating;return c.jsx("div",{className:"mt-2 pt-2 border-t border-gray-700",children:c.jsx("div",{className:"flex flex-wrap gap-2 text-xs mt-2",children:Object.entries(de).map(([Ie,Oe])=>{if(["name","player","playerName","submittedBy","active","rating","submissions"].includes(Ie))return null;const Ge=Ie.substring(0,3);let De=null;ge&&ge[Ie]?De=ge[Ie].from:xe&&xe[Ie]!==void 0&&(De=xe[Ie]);let at="text-blue-400";return De!==null&&Oe!==De&&(Oe>De?at="text-green-400":Oe<De&&(at="text-red-400")),c.jsxs("div",{className:"px-2 py-1 rounded-md bg-gray-800 flex items-center",children:[c.jsxs("span",{className:"capitalize mr-1",children:[Ge,":"]}),c.jsx("span",{className:at,children:Oe})]},Ie)})})})},Y=D=>{switch(D){case"player_added":return"👤+";case"player_updated":return"👤✏️";case"player_deleted":return"👤🗑️";case"player_rating_changed":return"👤⭐";case"match_result_saved":return"🏀✓";case"match_completed":return"🏆";case"rematch_created":return"🔄";case"leaderboard_reset":return"🏆🗑️";case"log_deleted":return"📜🗑️";case"schema_initialized":return"🔧";default:return"📝";case"user_joined_league":return"👋"}},J=D=>{switch(D){case"player_added":return"bg-green-900 bg-opacity-30 text-green-400";case"player_updated":case"player_rating_changed":return"bg-blue-900 bg-opacity-30 text-blue-400";case"player_deleted":return"bg-red-900 bg-opacity-30 text-red-400";case"match_result_saved":return"bg-yellow-900 bg-opacity-30 text-yellow-400";case"teams_generated":return"bg-indigo-900 bg-opacity-30 text-indigo-400";case"leaderboard_reset":return"bg-purple-900 bg-opacity-30 text-purple-400";case"log_deleted":return"bg-gray-800 text-gray-400";case"schema_initialized":return"bg-gray-800 text-gray-400";default:return"bg-gray-800 text-gray-400"}},oe=()=>{if(!m&&w){const D=P+1;L(D),C(D)}},K=()=>{C(1,!0)},Ue=()=>{const D=Math.min(P*V,u.length);return u.slice(0,D)};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:"Activity Log"}),c.jsx("div",{className:"flex space-x-3",children:c.jsxs("select",{className:"bg-gray-800 text-gray-200 border border-gray-700 rounded px-3 py-1.5 text-sm",value:y,onChange:D=>{N(D.target.value),L(1)},children:[c.jsx("option",{value:"all",children:"All Activities"}),c.jsx("option",{value:"players",children:"Players"}),c.jsx("option",{value:"matches",children:"Matches"}),c.jsx("option",{value:"admin",children:"Admin Actions"})]})})]}),m&&P===1?c.jsx("div",{className:"flex justify-center py-8",children:c.jsx("div",{className:"animate-pulse text-gray-400",children:"Loading logs..."})}):Ue().length===0?c.jsx("div",{className:"bg-gray-800 rounded p-6 text-center text-gray-400",children:y!=="all"?"No logs found for this filter.":"No logs found."}):c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",Math.min(Ue().length,P*V)," of ",Ue().length," logs",y!=="all"&&` (filtered: ${y})`]}),c.jsx("button",{onClick:K,className:"text-sm text-blue-400 hover:text-blue-300 transition-colors",disabled:m,children:"🔄 Refresh"})]}),Ue().map(D=>{var de,ge,xe,ve;return c.jsxs("div",{className:`rounded p-3 border border-gray-800 ${J(D.action)}`,children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("div",{className:"text-xl",children:Y(D.action)}),c.jsxs("div",{className:"flex-grow",children:[c.jsx("div",{className:"font-medium",children:W(D)}),c.jsx("div",{className:"text-xs text-gray-400",children:X(D.timestamp)}),D.userName&&n&&c.jsxs("div",{className:"text-xs mt-1 text-gray-300",children:["By: ",D.userName]}),["player_rating_changed","player_rating_updated","player_rating_added","player_added","player_updated"].includes(D.action)&&$(D),["match_result_saved","match_completed"].includes(D.action)&&ne(D)]})]}),n&&c.jsx("div",{className:"flex items-center space-x-2",children:R===D.id?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("button",{onClick:()=>{["player_rating_changed","player_rating_updated","player_rating_added","player_added","match_result_saved","match_completed"].includes(D.action)?(b(D),E(!0),j(null)):I(D.id)},className:"text-red-500 hover:text-red-400 text-xs font-bold",children:"Confirm"}),c.jsx("button",{onClick:()=>j(null),className:"text-gray-400 hover:text-gray-300 text-xs",children:"Cancel"})]}):c.jsx("button",{onClick:()=>j(D.id),className:"text-gray-500 hover:text-red-400",title:"Delete log entry",children:"✕"})})]}),k&&v&&c.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:c.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg max-w-md w-full",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:v.action==="player_added"?"Confirm Player Deletion":["match_result_saved","match_completed"].includes(v.action)?"Confirm Match Result Deletion":"Confirm Rating Reversal"}),c.jsx("p",{className:"text-gray-300 mb-4",children:v.action==="player_added"?`This will delete player ${((de=v.details)==null?void 0:de.playerName)||((ge=v.details)==null?void 0:ge.name)} completely from the league.`:["match_result_saved","match_completed"].includes(v.action)?"This will remove this match result and update the leaderboard accordingly.":`This will delete the rating submission for ${((xe=v.details)==null?void 0:xe.playerName)||((ve=v.details)==null?void 0:ve.name)} by ${v.userName}.`}),c.jsx("p",{className:"text-yellow-400 text-sm mb-4",children:v.action==="player_added"?"All player data and ratings will be permanently removed. This action cannot be undone.":["match_result_saved","match_completed"].includes(v.action)?"Player win/loss records and MVP counts will be adjusted. This action cannot be undone.":"This will recalculate the player's rating based on other submissions. This action cannot be undone."}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>E(!1),className:"px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600",children:"Cancel"}),c.jsx("button",{onClick:()=>{I(v.id),E(!1)},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:v.action==="player_added"?"Delete Player":["match_result_saved","match_completed"].includes(v.action)?"Delete Match Result":"Delete & Revert Rating"})]})]})}),D.details&&Object.keys(D.details).length>0&&!["player_rating_changed","player_rating_updated","player_rating_added"].includes(D.action)&&!["name","playerName","userId","scoreA","scoreB","teamCount"].some(Te=>Te in D.details)&&c.jsx("div",{className:"mt-2 pt-2 border-t border-gray-700 text-xs",children:c.jsxs("details",{children:[c.jsx("summary",{className:"cursor-pointer text-gray-400 hover:text-gray-300",children:"Details"}),c.jsx("pre",{className:"mt-2 p-2 bg-gray-900 rounded overflow-x-auto whitespace-pre-wrap",children:JSON.stringify(D.details,null,2)})]})})]},D.id)}),w&&c.jsx("div",{className:"flex justify-center mt-6",children:c.jsx("button",{onClick:oe,disabled:m,className:`px-6 py-2 rounded transition-colors ${m?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:m?"Loading...":"Load More"})}),!w&&u.length>0&&c.jsx("div",{className:"text-center text-gray-400 text-sm mt-6",children:"End of logs"})]})]})}const Bk=async(t,e)=>{if(!(!t||!e))try{const n=We(t,"leagues",e);if(!(await rt(n)).exists()){console.error("League does not exist");return}const s=We(t,"leagues",e,"sets","default");(await rt(s)).exists()||await tt(s,{players:[],teams:[],matchups:[],scores:[],mvpVotes:[],leaderboard:{},matchHistory:[]});const o=di(t,"leagues",e,"logs"),l=ur(o,ma("action","==","schema_initialized"),Nr(1));if((await dr(l)).empty){console.log("Creating schema initialization log");const d=We(di(t,"leagues",e,"logs"));await tt(d,{action:"schema_initialized",details:{message:"Log system initialized"},timestamp:new Date,undoable:!1,userName:"System",userId:"system"})}else console.log("Schema initialization log already exists");console.log("Schema migration completed successfully")}catch(n){console.error("Error in schema migration:",n)}};function $k({isOpen:t,onClose:e,players:n,onVote:r,currentBelts:s,userVotes:i={}}){const[o,l]=U.useState(null),[u,d]=U.useState(""),[m,g]=U.useState("positive");if(U.useEffect(()=>{t&&(l(null),d(""))},[t]),U.useEffect(()=>{o&&j(o)?d(i[o]||""):o&&d("")},[o,i]),!t)return null;const y=Object.entries(jr).filter(([k,E])=>E.isNegative===(m==="negative")).map(([k,E])=>({id:k,...E})),N=()=>{o&&u&&(r(o,u),l(null),d(""))},R=k=>(s==null?void 0:s[k])||null,j=k=>(i==null?void 0:i[k])!==void 0;return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:c.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg w-full max-w-md max-h-[90vh] overflow-y-auto",children:[c.jsx("h2",{className:"text-xl font-bold mb-4 text-white",children:"Vote for Championship Belts"}),c.jsxs("div",{className:"flex mb-4 border-b border-gray-700",children:[c.jsx("button",{className:`px-4 py-2 ${m==="positive"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400"}`,onClick:()=>g("positive"),children:"Positive Belts"}),c.jsx("button",{className:`px-4 py-2 ${m==="negative"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400"}`,onClick:()=>g("negative"),children:"Negative Belts"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select a Belt:"}),c.jsx("div",{className:"grid grid-cols-2 gap-2",children:y.map(k=>{const E=R(k.id),v=j(k.id),b=i==null?void 0:i[k.id];return c.jsxs("div",{onClick:()=>l(k.id),className:`
                                        p-3 rounded border cursor-pointer transition-colors
                                        ${o===k.id?"border-blue-500 bg-blue-900 bg-opacity-20":"border-gray-700 bg-gray-700"}
                                        hover:bg-gray-600
                                    `,children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-2xl mr-2",children:k.icon}),c.jsx("span",{className:"font-medium",children:k.name})]}),c.jsx("p",{className:"text-xs text-gray-400 mt-1",children:k.description}),E&&c.jsxs("div",{className:"mt-2 text-xs",children:[c.jsx("span",{className:"text-gray-400",children:"Current holder: "}),c.jsx("span",{className:"text-white",children:E.playerName}),c.jsxs("span",{className:"text-gray-500 ml-1",children:["(",E.votes," votes)"]})]}),v&&c.jsxs("div",{className:"mt-1 text-xs",children:[c.jsx("span",{className:"text-yellow-400",children:"Your vote: "}),c.jsx("span",{className:"text-white",children:b})]})]},k.id)})})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select a Player:"}),c.jsxs("select",{value:u,onChange:k=>d(k.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!o,children:[c.jsx("option",{value:"",children:"-- Select a player --"}),n.map(k=>c.jsx("option",{value:k.name,children:k.name},k.name))]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Close"}),c.jsx("button",{onClick:N,disabled:!o||!u,className:`px-4 py-2 text-white rounded ${!o||!u?"bg-gray-600 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:j(o)?"Change Vote":"Vote"})]})]})})}function zk({players:t=[],currentBelts:e={},userVotes:n={},onVote:r,user:s,beltVotes:i={}}){const[o,l]=U.useState(!1),[u,d]=U.useState(!1),[m,g]=U.useState(null),[y,N]=U.useState(!1),[R,j]=U.useState(null),[k,E]=U.useState(""),v=Object.entries(jr).filter(([p,w])=>!w.isNegative).map(([p,w])=>({id:p,...w})),b=Object.entries(jr).filter(([p,w])=>w.isNegative).map(([p,w])=>({id:p,...w})),P=(p,w)=>{r(p,w),l(!1)},L=p=>{if(!s){l(!0);return}E(n[p]||""),j(p),N(!0)},V=p=>{const w={};return Object.values(i).forEach(_=>{const S=_[p];S&&(w[S]=(w[S]||0)+1)}),Object.entries(w).map(([_,S])=>({playerName:_,count:S})).sort((_,S)=>S.count-_.count)},T=({belt:p})=>{const w=e[p.id],_=V(p.id),S=_.reduce((I,ce)=>I+ce.count,0),C=_[0];return c.jsxs("div",{className:`border ${p.isNegative?"border-red-800 bg-red-900 bg-opacity-10 hover:bg-opacity-20":"border-green-800 bg-green-900 bg-opacity-10 hover:bg-opacity-20"} 
            rounded-lg p-3 cursor-pointer transition-colors relative group`,onClick:()=>L(p.id),children:[c.jsx("button",{onClick:I=>{I.stopPropagation(),g(p.id),d(!0)},className:"absolute top-2 right-2 text-gray-400 hover:text-gray-200 opacity-0 group-hover:opacity-100 transition-opacity",title:"View details",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx("span",{className:"text-2xl mr-2",children:p.icon}),c.jsx("div",{children:c.jsx("h3",{className:"text-sm font-medium text-white",children:p.name})})]}),w?c.jsxs("div",{className:"bg-gray-800 bg-opacity-50 p-2 rounded",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"text-sm font-medium text-white block",children:w.playerName}),c.jsxs("span",{className:"text-xs bg-blue-900 bg-opacity-40 px-1 py-0.5 rounded text-blue-300 mt-1 inline-block",children:["👑 ",w.votes," votes"]})]}),n[p.id]===w.playerName&&c.jsx("div",{className:"text-xs text-yellow-400 mt-1 text-center",children:"Your vote"})]}):S>0?c.jsxs("div",{className:"bg-gray-800 bg-opacity-50 p-2 rounded",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"text-sm font-medium text-white block",children:C.playerName}),c.jsxs("span",{className:"text-xs bg-gray-700 px-1 py-0.5 rounded text-gray-300 mt-1 inline-block",children:[C.count," votes (needs ",5-C.count," more)"]})]}),n[p.id]===C.playerName&&c.jsx("div",{className:"text-xs text-yellow-400 mt-1 text-center",children:"Your vote"})]}):c.jsx("div",{className:"bg-gray-800 bg-opacity-50 p-2 rounded text-center text-gray-400 text-xs",children:"No votes yet"}),c.jsx("div",{className:"text-xs text-center text-gray-500 mt-1 opacity-0 group-hover:opacity-100 transition-opacity",children:"Click to vote"})]})};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:"Championship Belts"}),c.jsx(un,{onClick:()=>l(!0),className:"bg-blue-600 hover:bg-blue-700",disabled:!s,children:s?"Vote for Belts":"Sign in to Vote"})]}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:v.map(p=>c.jsx(T,{belt:p},p.id))}),c.jsx("div",{className:"border-t border-gray-600"}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:b.map(p=>c.jsx(T,{belt:p},p.id))}),c.jsx($k,{isOpen:o,onClose:()=>l(!1),players:t,onVote:P,currentBelts:e,userVotes:n}),y&&R&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:c.jsx("div",{className:"bg-gray-800 p-6 rounded-lg w-full max-w-md",children:(()=>{const p=jr[R],w=()=>{k&&(r(R,k),N(!1),E(""))};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-3xl mr-3",children:p.icon}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:p.name}),c.jsx("p",{className:`text-sm ${p.isNegative?"text-red-400":"text-green-400"}`,children:p.isNegative?"Negative Belt":"Positive Belt"})]})]}),c.jsx("button",{onClick:()=>{N(!1),E("")},className:"text-gray-400 hover:text-white text-xl font-bold",children:"✕"})]}),c.jsx("p",{className:"text-gray-300 mb-4",children:p.description}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select a Player:"}),c.jsxs("select",{value:k,onChange:_=>E(_.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"-- Select a player --"}),t.map(_=>c.jsx("option",{value:_.name,children:_.name},_.name))]})]}),n[R]&&c.jsxs("div",{className:"bg-blue-900 bg-opacity-20 p-3 rounded mb-4",children:[c.jsx("div",{className:"text-sm text-blue-400",children:"Your current vote:"}),c.jsx("div",{className:"text-white font-medium",children:n[R]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("button",{onClick:()=>{N(!1),g(R),d(!0),E("")},className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"View Details"}),c.jsx("button",{onClick:w,disabled:!k,className:`px-4 py-2 text-white rounded ${k?"bg-blue-600 hover:bg-blue-700":"bg-gray-600 cursor-not-allowed"}`,children:n[R]?"Change Vote":"Vote"})]})]})})()})}),u&&m&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:c.jsx("div",{className:"bg-gray-800 p-6 rounded-lg w-full max-w-md max-h-[90vh] overflow-y-auto",children:(()=>{const p=jr[m],w=e[m],_=V(m);return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-4xl mr-3",children:p.icon}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:p.name}),c.jsx("p",{className:`text-sm ${p.isNegative?"text-red-400":"text-green-400"}`,children:p.isNegative?"Negative Belt":"Positive Belt"})]})]}),c.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-white text-xl font-bold",children:"✕"})]}),c.jsx("p",{className:"text-gray-300 mb-6",children:p.description}),w&&c.jsx("div",{className:`p-4 rounded-lg mb-6 ${p.isNegative?"bg-red-900 bg-opacity-20":"bg-green-900 bg-opacity-20"}`,children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-lg font-bold text-white",children:"Current Holder"}),c.jsx("div",{className:"text-2xl font-bold text-white mt-2",children:w.playerName}),c.jsxs("div",{className:"text-sm text-gray-300 mt-1",children:[w.votes," votes"]})]})}),c.jsxs("div",{className:"mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Vote Breakdown"}),_.length>0?c.jsx("div",{className:"space-y-2",children:_.map(({playerName:S,count:C},I)=>c.jsxs("div",{className:"flex justify-between items-center bg-gray-700 p-2 rounded",children:[c.jsx("span",{className:"text-white",children:S}),c.jsxs("div",{className:"flex items-center",children:[c.jsxs("span",{className:"text-gray-300 mr-2",children:[C," votes"]}),I===0&&(w==null?void 0:w.playerName)===S&&c.jsx("span",{className:"text-yellow-400",children:"👑"})]})]},S))}):c.jsx("div",{className:"text-gray-400 text-center py-4",children:"No votes yet for this belt"})]}),n[m]&&c.jsxs("div",{className:"bg-blue-900 bg-opacity-20 p-3 rounded mb-4",children:[c.jsx("div",{className:"text-sm text-blue-400",children:"Your vote:"}),c.jsx("div",{className:"text-white font-medium",children:n[m]})]}),c.jsx("div",{className:"flex justify-center",children:c.jsx(un,{onClick:()=>{d(!1),l(!0)},className:"bg-blue-600 hover:bg-blue-700",disabled:!s,children:n[m]?"Change Vote":"Vote for This Belt"})})]})})()})})]})}const Q0=(t,e=24,n="gold")=>{const s={gamesPlayed:iw,wins:sw,mvps:ow,winStreaks:aw}[t];return s?c.jsx(s,{tier:n,size:e}):c.jsx("span",{className:"text-lg",children:"🏅"})};function Wk({players:t=[],leaderboard:e={},matchHistory:n=[],currentBelts:r={},userVotes:s={},onVote:i,user:o,beltVotes:l={}}){const[u,d]=U.useState("belts"),[m,g]=U.useState(null),N=(()=>{const k={};return Object.keys(Xi).forEach(E=>{k[E]={bronze:0,silver:0,gold:0,amethyst:0}}),t.forEach(E=>{const v=Gc(E.name,e,n);Object.entries(v).forEach(([b,P])=>{k[b]&&k[b][P.tierId]!==void 0&&k[b][P.tierId]++})}),k})(),j=(()=>{const k={};return Object.keys(Xi).forEach(E=>{const v=t.map(P=>{const L=Gc(P.name,e,n);return{playerName:P.name,badge:L[E]||null}}).filter(P=>P.badge!==null),b={amethyst:4,gold:3,silver:2,bronze:1};v.sort((P,L)=>{const V=(b[L.badge.tierId]||0)-(b[P.badge.tierId]||0);return V!==0?V:L.badge.currentValue-P.badge.currentValue}),k[E]=v.slice(0,5)}),k})();return c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex justify-between items-center",children:c.jsx("h2",{className:"text-xl font-bold text-white",children:"Awards"})}),c.jsxs("div",{className:"flex border-b border-gray-700",children:[c.jsx("button",{onClick:()=>d("belts"),className:`px-4 py-2 text-sm font-medium ${u==="belts"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"}`,children:"Belts"}),c.jsx("button",{onClick:()=>d("badges"),className:`px-4 py-2 text-sm font-medium ${u==="badges"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"}`,children:"Badges"})]}),u==="belts"&&c.jsx(zk,{players:t,currentBelts:r,userVotes:s,onVote:i,user:o,beltVotes:l}),u==="badges"&&c.jsx("div",{className:"space-y-6",children:c.jsx("div",{className:"space-y-4",children:Object.entries(Xi).map(([k,E])=>c.jsxs("div",{className:"bg-gray-800 p-3 rounded-lg",children:[c.jsxs("div",{className:"text-center mb-3",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:E.name}),c.jsx("p",{className:"text-xs text-gray-400",children:E.description})]}),c.jsx("div",{className:"grid grid-cols-4 gap-3",children:Object.entries(E.tiers).map(([v,b])=>(N[k][v],j[k].find(P=>P.badge.tierId===v),c.jsx("div",{className:"text-center cursor-pointer transition-all duration-300 hover:scale-105 p-1",onClick:()=>g(m===`${k}-${v}`?null:`${k}-${v}`),children:c.jsx("div",{className:"flex justify-center",children:Q0(k,56,v)})},v)))}),Object.entries(E.tiers).map(([v,b])=>{const P=m===`${k}-${v}`,L=j[k].filter(T=>T.badge.tierId===v),V=N[k][v];return P?c.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-700 bg-gray-700 rounded-lg p-3",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"mr-2",children:Q0(k,24,v)}),c.jsxs("div",{children:[c.jsx("h4",{className:`text-base font-bold ${b.color}`,children:b.name}),c.jsxs("p",{className:"text-xs text-gray-400",children:[b.threshold,"+ ",E.name.toLowerCase()," required"]})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-base font-bold text-white",children:V}),c.jsx("div",{className:"text-xs text-gray-400",children:V===1?"player":"players"})]})]}),c.jsxs("div",{children:[c.jsx("h5",{className:"text-xs font-medium text-white mb-2",children:"Badge Holders:"}),L.length>0?c.jsx("div",{className:"space-y-2",children:L.map((T,p)=>c.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-600 rounded text-sm",children:[c.jsxs("div",{className:"flex items-center",children:[p===0&&c.jsx("span",{className:"text-yellow-400 mr-1 text-xs",children:"👑"}),c.jsx("span",{className:"text-white",children:T.playerName})]}),c.jsx("div",{className:"text-gray-300 text-xs",children:T.badge.currentValue})]},T.playerName))}):c.jsx("div",{className:"text-center py-3 text-gray-400 text-xs",children:"No players have earned this badge yet"})]})]},`expanded-${v}`):null})]},k))})})]})}function Fl(t){return{Vet:"gamesPlayed",Winner:"wins",MVP:"mvps","Win Streak":"winStreaks"}[t]||"gamesPlayed"}function Hk({isOpen:t,onClose:e,player:n,leaderboard:r={},matchHistory:s=[],playerOVRs:i={}}){const[o,l]=U.useState("overview");if(!t||!n)return null;const u=Nm(n.name,r,s),d=Gc(n.name,r,s),m=bC(n.name,r,s),g=r[n.name]||{_l:0},y=i[n.name]||5,N=u.gamesPlayed>0?(u.wins/u.gamesPlayed*100).toFixed(1):"0.0";return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:c.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-700",children:[c.jsx("div",{className:"flex items-center",children:c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:n.name}),c.jsxs("div",{className:"flex items-center mt-1",children:[c.jsxs("span",{className:"text-blue-400 text-lg font-medium",children:[y.toFixed(1)," OVR"]}),c.jsxs("div",{className:"ml-4 text-sm text-gray-300",children:[u.gamesPlayed," games • ",N,"% win rate"]})]})]})}),c.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white text-xl font-bold",children:"✕"})]}),c.jsxs("div",{className:"flex border-b border-gray-700 bg-gray-800",children:[c.jsx("button",{onClick:()=>l("overview"),className:`px-6 py-3 text-sm font-medium ${o==="overview"?"text-blue-400 border-b-2 border-blue-400 bg-gray-750":"text-gray-400 hover:text-gray-300"}`,children:"Overview"}),c.jsx("button",{onClick:()=>l("awards"),className:`px-6 py-3 text-sm font-medium ${o==="awards"?"text-blue-400 border-b-2 border-blue-400 bg-gray-750":"text-gray-400 hover:text-gray-300"}`,children:"Awards & Badges"})]}),c.jsxs("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"60vh"},children:[o==="overview"&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-white",children:u.gamesPlayed}),c.jsx("div",{className:"text-sm text-gray-400",children:"Games Played"})]}),c.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-green-400",children:u.wins}),c.jsx("div",{className:"text-sm text-gray-400",children:"Wins"})]}),c.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-red-400",children:g._l}),c.jsx("div",{className:"text-sm text-gray-400",children:"Losses"})]}),c.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:u.mvps}),c.jsx("div",{className:"text-sm text-gray-400",children:"MVPs"})]})]}),c.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Player Abilities"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["scoring","defense","rebounding","playmaking","stamina","physicality","xfactor"].map(R=>c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("span",{className:"text-gray-300 capitalize",children:[R,":"]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"w-20 h-2 bg-gray-600 rounded-full mr-2",children:c.jsx("div",{className:"h-2 bg-blue-500 rounded-full",style:{width:`${(n[R]||5)/10*100}%`}})}),c.jsx("span",{className:"text-white font-medium w-6 text-right",children:n[R]||5})]})]},R))})]}),Object.keys(d).length>0&&c.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Recent Achievements"}),c.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.values(d).slice(0,4).map((R,j)=>(Fl(R.categoryName),c.jsxs("div",{className:"flex items-center bg-gray-600 p-3 rounded",children:[c.jsx(Bh,{badge:R,categoryId:Fl(R.categoryName),size:"normal",showTooltip:!1}),c.jsxs("div",{className:"ml-4",children:[c.jsx("div",{className:`text-white font-medium ${R.color}`,children:R.name}),c.jsx("div",{className:"text-xs text-gray-400",children:R.categoryName})]})]},j)))})]})]}),o==="awards"&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-white mb-4",children:["Earned Badges (",Object.keys(d).length,")"]}),Object.keys(d).length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(d).map(([R,j])=>(Fl(j.categoryName),c.jsx("div",{className:"bg-gray-700 p-4 rounded-lg",children:c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx(Bh,{badge:j,categoryId:Fl(j.categoryName),size:"normal",showTooltip:!1}),c.jsxs("div",{className:"ml-4",children:[c.jsx("div",{className:`text-white font-medium ${j.color}`,children:j.name}),c.jsxs("div",{className:"text-sm text-gray-400",children:[j.currentValue," ",j.categoryName.toLowerCase()]})]})]})},R)))}):c.jsx("div",{className:"text-center py-8 text-gray-400",children:"No badges earned yet. Keep playing to unlock achievements!"})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Progress Towards Next Badges"}),c.jsx("div",{className:"space-y-4",children:Object.entries(m).map(([R,j])=>j.nextTier?c.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-xl mr-2",children:Xi[R].icon}),c.jsxs("div",{children:[c.jsxs("div",{className:"text-white font-medium",children:[j.nextTier.name," ",j.categoryName]}),c.jsxs("div",{className:"text-sm text-gray-400",children:[j.currentValue," / ",j.nextTier.threshold]})]})]}),c.jsx("span",{className:`text-lg ${j.nextTier.color}`,children:j.nextTier.icon})]}),c.jsx("div",{className:"w-full bg-gray-600 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${j.progressPercent}%`}})}),c.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[j.nextTier.threshold-j.currentValue," more needed"]})]},R):null)})]})]})]})]})})}const Sn=()=>{},Sd=()=>{},et=pm(),qk=`
  .scrollbar-hide {
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none;  /* Chrome, Safari and Opera */
  }
`;function Gk(){const[t,e]=U.useState("players"),[n,r]=U.useState([]),[s,i]=U.useState({name:"",scoring:5,defense:5,rebounding:5,playmaking:5,stamina:5,physicality:5,xfactor:5}),[o,l]=U.useState(!1),[u,d]=U.useState(null),[m,g]=U.useState(!1),[y,N]=U.useState(!1),[R,j]=U.useState(null),[k,E]=U.useState(3),[v,b]=U.useState([]),[P,L]=U.useState([]),[V,T]=U.useState([]),[p,w]=U.useState([]),[_,S]=U.useState({}),[C,I]=U.useState("default"),[ce,Be]=U.useState(null),[q,X]=U.useState(""),[W,ne]=U.useState([]),[$,Y]=U.useState(null);U.useRef(null);const[J,oe]=U.useState(null),K={scoring:.25,defense:.2,rebounding:.15,playmaking:.15,stamina:.1,physicality:.1,xfactor:.05},[Ue,D]=U.useState(!1),[de,ge]=U.useState([]),[xe,ve]=U.useState(!1),[Te,Ne]=U.useState(!1),[Pe,_e]=U.useState(!1),[Ie,Oe]=U.useState(""),Ge=()=>{const A=new kr;$A(Hh,A).catch(B=>{console.error("Login failed:",B)})},[De,at]=U.useState(!1),[Ke,_t]=U.useState(!1),[bt,be]=U.useState([]),[nt,O]=U.useState({}),[G,Q]=U.useState({}),[he,ke]=U.useState("rankings"),[Ve,Ce]=U.useState(!1),[Qe,an]=U.useState(null),mn=(A,B)=>{if(!de||de.length===0)return!1;const H=A.map(te=>te.name).sort(),F=B.map(te=>te.name).sort();return de.some(te=>{let se=[],ie=[];if(Array.isArray(te.teams)&&te.teams.length>=2)se=te.teams[0].map(ue=>ue.name).sort(),ie=te.teams[1].map(ue=>ue.name).sort();else if(te.teamA&&te.teamB)se=te.teamA.map(ue=>ue.name).sort(),ie=te.teamB.map(ue=>ue.name).sort();else return!1;return ln(H,se)&&ln(F,ie)||ln(H,ie)&&ln(F,se)})},ln=(A,B)=>{if(A.length!==B.length)return!1;for(let H=0;H<A.length;H++)if(A[H]!==B[H])return!1;return!0},Kr=A=>A.scoring*K.scoring+A.defense*K.defense+A.rebounding*K.rebounding+A.playmaking*K.playmaking+A.stamina*K.stamina+A.physicality*K.physicality+A.xfactor*K.xfactor,_i=(A,B)=>{if(!de||de.length===0)return[];const H=A.map(te=>te.name).sort(),F=B.map(te=>te.name).sort();return de.filter(te=>{let se=[],ie=[];if(Array.isArray(te.teams)&&te.teams.length>=2)se=te.teams[0].map(le=>le.name).sort(),ie=te.teams[1].map(le=>le.name).sort();else if(te.teamA&&te.teamB)se=te.teamA.map(le=>le.name).sort(),ie=te.teamB.map(le=>le.name).sort();else return!1;return ln(H,se)&&ln(F,ie)||ln(H,ie)&&ln(F,se)}).map(te=>!te.teams&&te.teamA&&te.teamB?{teams:[te.teamA,te.teamB],score:te.score,mvp:te.mvp||"",date:te.date}:te)},Qr=()=>{d(null),g(!1)},Us=A=>!A||A.length===0?0:A.reduce((H,F)=>H+Kr(F),0)/A.length,Bs=async()=>{if(!$){console.error("No currentLeagueId set");return}if(p.some(B=>B&&(B.a||B.b)&&!B.processed)&&xe){d("generate-teams"),g(!0);return}await Hn()},Hn=async()=>{if(!$){console.error("No currentLeagueId set");return}try{Sn("Players:",n),Sn("Team size:",k);const A=_C(n,k,Kr);Sn("Balance teams result:",A);const B=A.teams,H=A.matchups;Sn("Generated teams:",B),Sn("Generated matchups:",H),b(B),L(H),l(!1),ve(!0);const F=Array(H.length).fill(""),te=Array(H.length).fill({a:"",b:""});T(F),w(te);const se=We(et,"leagues",$,"sets",C),ie=await rt(se);if(ie.exists()){const le=ie.data(),ue=jn({...le,teams:B,matchups:H,mvpVotes:F,scores:te,leaderboard:le.leaderboard||{}});await tt(se,ue)}}catch(A){console.error("Error in generateBalancedTeams:",A),alert("An error occurred while generating teams. Check the console for details.")}await Qn(et,$,"teams_generated",{teamCount:v.length,matchupCount:P.length,teamSize:k},ce,!1)},Yr=async()=>{if(!$||!P||P.length===0)return;const A=We(et,"leagues",$,"sets",C),B=await rt(A);let H={};B.exists()&&B.data().leaderboard&&(H=B.data().leaderboard);const F={};P.forEach(([se,ie],le)=>{if(!p[le]||p[le].processed)return;const ue=p[le],ye=V[le]||"";if(!(ue!=null&&ue.a)||!(ue!=null&&ue.b))return;const Ae=se.map(Xe=>Xe.name).filter(Xe=>Xe&&Xe.trim()!==""),Se=ie.map(Xe=>Xe.name).filter(Xe=>Xe&&Xe.trim()!==""),we=parseInt(ue==null?void 0:ue.a),xt=parseInt(ue==null?void 0:ue.b);if(!isNaN(we)&&!isNaN(xt)){const Xe=we>xt?Ae:Se,dt=we>xt?Se:Ae;[...Ae,...Se].forEach($t=>{$t&&$t.trim()!==""&&!F[$t]&&(F[$t]={_w:0,_l:0,MVPs:0})}),Xe.forEach($t=>{$t&&$t.trim()!==""&&(F[$t]._w+=1)}),dt.forEach($t=>{$t&&$t.trim()!==""&&(F[$t]._l+=1)})}ye&&ye.trim()!==""&&(F[ye]||(F[ye]={_w:0,_l:0,MVPs:0}),F[ye].MVPs+=1),p[le].processed=!0});const te={...H};if(Object.keys(F).forEach(se=>{te[se]||(te[se]={_w:0,_l:0,MVPs:0}),te[se]._w+=F[se]._w,te[se]._l+=F[se]._l,te[se].MVPs+=F[se].MVPs}),S(te),B.exists()){const se=B.data();await tt(A,{...se,leaderboard:te,scores:p})}},jn=A=>(A.matchups&&(A.matchups=A.matchups.map((B,H)=>!B||!B[0]?{id:H,teamA:[],teamB:[]}:{id:H,teamA:B[0].map(F=>({name:F.name||"",active:F.active!==void 0?F.active:!0,scoring:F.scoring||0,defense:F.defense||0,rebounding:F.rebounding||0,playmaking:F.playmaking||0,stamina:F.stamina||0,physicality:F.physicality||0,xfactor:F.xfactor||0})),teamB:B[1]?B[1].map(F=>({name:F.name||"",active:F.active!==void 0?F.active:!0,scoring:F.scoring||0,defense:F.defense||0,rebounding:F.rebounding||0,playmaking:F.playmaking||0,stamina:F.stamina||0,physicality:F.physicality||0,xfactor:F.xfactor||0})):[]})),A.teams&&(Sn("Teams data:",A.teams),A.teams=A.teams.map((B,H)=>!B||!Array.isArray(B)?{id:H,players:[]}:{id:H,players:B.map(F=>F?{name:F.name||"",active:F.active!==void 0?F.active:!0,scoring:F.scoring||0,defense:F.defense||0,rebounding:F.rebounding||0,playmaking:F.playmaking||0,stamina:F.stamina||0,physicality:F.physicality||0,xfactor:F.xfactor||0}:{})})),A.matchHistory&&(A.matchHistory=A.matchHistory.map((B,H)=>Array.isArray(B.teams)?{id:H,teamA:B.teams[0].map(F=>({name:F.name||"",active:F.active!==void 0?F.active:!0,scoring:F.scoring||0,defense:F.defense||0,rebounding:F.rebounding||0,playmaking:F.playmaking||0,stamina:F.stamina||0,physicality:F.physicality||0,xfactor:F.xfactor||0})),teamB:B.teams[1]?B.teams[1].map(F=>({name:F.name||"",active:F.active!==void 0?F.active:!0,scoring:F.scoring||0,defense:F.defense||0,rebounding:F.rebounding||0,playmaking:F.playmaking||0,stamina:F.stamina||0,physicality:F.physicality||0,xfactor:F.xfactor||0})):[],score:B.score,mvp:B.mvp||"",date:B.date}:B)),A),Dn=async A=>{const B=n.map(H=>{const F=A.find(te=>te.name===H.name);return F?{...H,active:F.active}:H});if(r(B),$){const H=We(et,"leagues",$,"sets",C),F=await rt(H);if(F.exists()){const te=F.data(),se=te.players.map(ie=>{const le=A.find(ue=>ue.name===ie.name);return le?{...ie,active:le.active}:ie});await tt(H,{...te,players:se})}}},Pt=async(A,B)=>{const H=n.map(F=>F.name===A?{...F,active:B}:F);if(r(H),$){const F=We(et,"leagues",$,"sets",C),te=await rt(F);if(te.exists()){const se=te.data(),ie=se.players.map(le=>le.name===A?{...le,active:B}:le);await tt(F,{...se,players:ie})}}},Vn=A=>{if(A.matchups){const B=A.matchups.map(H=>[H.teamA||[],H.teamB||[]]);A.matchups=B}if(A.teams){const B=A.teams.map(H=>H.players||[]);A.teams=B}return A.matchHistory&&(A.matchHistory=A.matchHistory.map(B=>({teams:[B.teamA||[],B.teamB||[]],score:B.score,mvp:B.mvp||"",date:B.date}))),A},Er=async A=>{if(!$)return;const B=We(et,"leagues",$,"sets",C),H=await rt(B);if(H.exists()){const F=H.data(),te=F.players.find(ie=>ie.name.toLowerCase()===A.toLowerCase()),se=F.players.filter(ie=>ie.name.toLowerCase()!==A.toLowerCase());await tt(B,{...F,players:se}),await Qn(et,$,"player_deleted",{name:A,playerData:te},ce,!0),r(se),X("🗑️ Player deleted!"),setTimeout(()=>X(""),3e3)}},Mn=()=>{const A=p.map((H,F)=>H&&H.a&&H.b?F:null).filter(H=>H!==null),B=A.map(H=>({teams:P[H],score:p[H],mvp:V[H]||"",date:new Date().toISOString()}));if(be(B),at(!0),A.length>0){const H=We(et,"leagues",$,"sets",C);rt(H).then(F=>{if(F.exists()){const te=F.data(),se=A.map(Se=>({teamA:P[Se][0].map(we=>({name:we.name,active:we.active!==void 0?we.active:!0,scoring:we.scoring||0,defense:we.defense||0,rebounding:we.rebounding||0,playmaking:we.playmaking||0,stamina:we.stamina||0,physicality:we.physicality||0,xfactor:we.xfactor||0})),teamB:P[Se][1].map(we=>({name:we.name,active:we.active!==void 0?we.active:!0,scoring:we.scoring||0,defense:we.defense||0,rebounding:we.rebounding||0,playmaking:we.playmaking||0,stamina:we.stamina||0,physicality:we.physicality||0,xfactor:we.xfactor||0})),score:p[Se],mvp:V[Se]||"",date:new Date().toISOString(),teamSize:k}));for(const Se of se)Qn(et,$,"match_completed",{teamA:Se.teamA.map(we=>we.name),teamB:Se.teamB.map(we=>we.name),scoreA:Se.score.a,scoreB:Se.score.b,mvp:Se.mvp||"",teamSize:Se.teamSize||k,date:Se.date},ce,!1).catch(we=>Sd());const le=[...te.matchHistory||[],...se],ue=P.filter((Se,we)=>!A.includes(we)),ye=p.filter((Se,we)=>!A.includes(we)),Ae=V.filter((Se,we)=>!A.includes(we));L(ue),w(ye),T(Ae),ge(le),ue.length===0&&(b([]),ve(!1)),tt(H,{...te,matchHistory:le}).then(()=>tt(H,{...te,matchHistory:le,matchups:[],scores:[],mvpVotes:[]})).then(()=>{if(ue.length>0){const Se=jn({...te,matchHistory:le,matchups:ue,scores:ye,mvpVotes:Ae});return tt(H,Se)}})}})}else X("No completed matches to archive"),setTimeout(()=>X(""),3e3);D(!1)},Tr=A=>{const B=n.find(Xe=>Xe.name===A)||{},H=_[A]||{_w:0,_l:0,MVPs:0},F=(B.scoring||5)*.25+(B.defense||5)*.2+(B.rebounding||5)*.15+(B.playmaking||5)*.15+(B.stamina||5)*.1+(B.physicality||5)*.1+(B.xfactor||5)*.05,te=H._w||0,se=H._l||0,ie=te+se,le=ie>0?te/ie:.5,ue=H.MVPs||0,ye=ie>0?ue/ie:0,Ae=(le-.5)*.6,Se=Math.min(ye*.8,.3),xt=F+Ae+Se+0;return parseFloat(Math.min(Math.max(xt,1),10).toFixed(1))},yt=U.useMemo(()=>{const A={};return n.forEach(B=>{A[B.name]=Tr(B.name)}),A},[n,_,K]);U.useCallback(A=>A.scoring*K.scoring+A.defense*K.defense+A.rebounding*K.rebounding+A.playmaking*K.playmaking+A.stamina*K.stamina+A.physicality*K.physicality+A.xfactor*K.xfactor,[K]);const In=()=>{at(!1)},Ln=async A=>{if(!$||!P||P.length===0||A>=P.length||p[A].processed)return;const B=We(et,"leagues",$,"sets",C),H=await rt(B);let F={};H.exists()&&H.data().leaderboard&&(F=H.data().leaderboard);const[te,se]=P[A],ie=p[A],le=V[A]||"";if(!(ie!=null&&ie.a)||!(ie!=null&&ie.b))return;const ue=te.map(we=>we.name).filter(we=>we&&we.trim()!==""),ye=se.map(we=>we.name).filter(we=>we&&we.trim()!==""),Ae=parseInt(ie==null?void 0:ie.a),Se=parseInt(ie==null?void 0:ie.b);if(!isNaN(Ae)&&!isNaN(Se)){const we=Ae>Se?ue:ye,xt=Ae>Se?ye:ue,Xe={...F};if([...ue,...ye].forEach(dt=>{dt&&dt.trim()!==""&&!Xe[dt]&&(Xe[dt]={_w:0,_l:0,MVPs:0})}),we.forEach(dt=>{dt&&dt.trim()!==""&&(Xe[dt]._w=(Xe[dt]._w||0)+1)}),xt.forEach(dt=>{dt&&dt.trim()!==""&&(Xe[dt]._l=(Xe[dt]._l||0)+1)}),le&&le.trim()!==""&&Xe[le]&&(Xe[le].MVPs=(Xe[le].MVPs||0)+1),S(Xe),H.exists()){const dt=H.data();await tt(B,{...dt,leaderboard:Xe})}}},Xr=async()=>{var te,se;const A=[P[P.length-1]],B=[{a:"",b:""}],H=[""];L([...P,...A]),w([...p,...B]),T([...V,...H]),D(!1);const F=We(et,"leagues",$,"sets",C);rt(F).then(ie=>{if(ie.exists()){const le=ie.data(),ue=jn({...le,matchups:[...P,...A],scores:[...p,...B],mvpVotes:[...V,...H]});tt(F,ue)}}),await Qn(et,$,"rematch_created",{teamA:A[0][0].map(ie=>ie.name),teamB:A[0][1].map(ie=>ie.name),originalScoreA:(te=p[p.length-1])==null?void 0:te.a,originalScoreB:(se=p[p.length-1])==null?void 0:se.b,date:new Date().toISOString()},ce,!1),D(!1),X("🔄 Rematch created! Play again with the same teams."),setTimeout(()=>X(""),3e3)},xi=async()=>{var H,F;if(!ce){X("⚠️ Please sign in to submit a rating."),setTimeout(()=>X(""),3e3);return}if(!$){X("⚠️ No league selected."),setTimeout(()=>X(""),3e3);return}const A=n.find(te=>te.name===s.name);let B=null;if(A){const te=A.scoring||5,se=A.defense||5,ie=A.rebounding||5,le=A.playmaking||5,ue=A.stamina||5,ye=A.physicality||5,Ae=A.xfactor||5;B=(te*K.scoring+se*K.defense+ie*K.rebounding+le*K.playmaking+ue*K.stamina+ye*K.physicality+Ae*K.xfactor).toFixed(2)}try{const te=We(et,"leagues",$,"sets",C),se=await rt(te),ie=se.exists()?se.data():{players:[]},le=[...ie.players],ue=le.findIndex(Fe=>Fe.name.toLowerCase()===s.name.toLowerCase()),ye={...s,submittedBy:ce.email};let Ae=!1,Se="player_rating_changed",we=null,xt=null;if(ue>-1){const Fe=le[ue];xt=(H=Fe.submissions)==null?void 0:H.find(lt=>lt.submittedBy===ce.email),xt&&(we={scoring:xt.scoring,defense:xt.defense,rebounding:xt.rebounding,playmaking:xt.playmaking,stamina:xt.stamina,physicality:xt.physicality,xfactor:xt.xfactor});const ft=(Fe.submissions||[]).filter(lt=>lt.submittedBy!==ce.email),pn=ft.length<(((F=Fe.submissions)==null?void 0:F.length)||0);ft.push(ye);const it=ft.reduce((lt,Zr)=>{const{name:jo,submittedBy:Mu,...ct}=Zr,Ti=Object.values(ct).reduce(($s,zs)=>$s+zs,0)/7;return lt+Ti},0)/ft.length;le[ue]={...Fe,submissions:ft,rating:it,scoring:ye.scoring,defense:ye.defense,rebounding:ye.rebounding,playmaking:ye.playmaking,stamina:ye.stamina,physicality:ye.physicality,xfactor:ye.xfactor},Se=pn?"player_rating_updated":"player_rating_added"}else le.push({name:s.name,active:!0,submissions:[ye],rating:(ye.scoring+ye.defense+ye.rebounding+ye.playmaking+ye.stamina+ye.physicality+ye.xfactor)/7,scoring:ye.scoring,defense:ye.defense,rebounding:ye.rebounding,playmaking:ye.playmaking,stamina:ye.stamina,physicality:ye.physicality,xfactor:ye.xfactor}),Ae=!0,Se="player_rating_added";await tt(te,{...ie,players:le});const Xe=le.find(Fe=>Fe.name===s.name);let dt=null;Xe&&Xe.submissions&&(dt=(Xe.submissions.reduce((ft,pn)=>{const{name:St,submittedBy:it,...lt}=pn,Zr=(lt.scoring||5)*K.scoring+(lt.defense||5)*K.defense+(lt.rebounding||5)*K.rebounding+(lt.playmaking||5)*K.playmaking+(lt.stamina||5)*K.stamina+(lt.physicality||5)*K.physicality+(lt.xfactor||5)*K.xfactor;return ft+Zr},0)/Xe.submissions.length).toFixed(2));const $t=Ae?"✅ Rating submitted!":"✏️ Rating updated!";B&&dt&&!isNaN(parseFloat(dt))?X(`${$t} ${B} → ${dt}`):X($t),setTimeout(()=>X(""),4e3),r(le.map(Fe=>{if(!Fe)return{name:"Unknown",active:!0,submissions:[],scoring:5,defense:5,rebounding:5,playmaking:5,stamina:5,physicality:5,xfactor:5};if(Fe.submissions&&Array.isArray(Fe.submissions)&&Fe.submissions.length>0){const ft={name:Fe.name||"Unknown",active:Fe.active!==void 0?Fe.active:!0,scoring:0,defense:0,rebounding:0,playmaking:0,stamina:0,physicality:0,xfactor:0,submissions:Fe.submissions};Fe.submissions.forEach(St=>{St&&(ft.scoring+=St.scoring||0,ft.defense+=St.defense||0,ft.rebounding+=St.rebounding||0,ft.playmaking+=St.playmaking||0,ft.stamina+=St.stamina||0,ft.physicality+=St.physicality||0,ft.xfactor+=St.xfactor||0)});const pn=Fe.submissions.length;return Object.keys(ft).forEach(St=>{typeof ft[St]=="number"&&(ft[St]=parseFloat((ft[St]/pn).toFixed(2)))}),ft}return{...Fe,name:Fe.name||"Unknown",active:Fe.active!==void 0?Fe.active:!0,scoring:Fe.scoring||5,defense:Fe.defense||5,rebounding:Fe.rebounding||5,playmaking:Fe.playmaking||5,stamina:Fe.stamina||5,physicality:Fe.physicality||5,xfactor:Fe.xfactor||5,submissions:Fe.submissions||[]}})),setTimeout(()=>{try{Sn("Logging rating submission for player:",s.name);const Fe={scoring:s.scoring,defense:s.defense,rebounding:s.rebounding,playmaking:s.playmaking,stamina:s.stamina,physicality:s.physicality,xfactor:s.xfactor},ft=(Object.values(Fe).reduce((it,lt)=>it+lt,0)/Object.values(Fe).length).toFixed(1);let pn=null;if(!Ae&&ue>-1){const it=n.find(lt=>lt.name===s.name);it&&(pn={scoring:it.scoring||5,defense:it.defense||5,rebounding:it.rebounding||5,playmaking:it.playmaking||5,stamina:it.stamina||5,physicality:it.physicality||5,xfactor:it.xfactor||5})}const St={playerName:s.name,name:s.name,player:s.name,isNewSubmission:Ae,ratingData:Fe,overallRating:ft};pn&&(St.previousRating=pn,St.changedValues={},Object.keys(Fe).forEach(it=>{Fe[it]!==pn[it]&&(St.changedValues[it]={from:pn[it],to:Fe[it]})})),Sn("About to log activity with player name:",s.name),Sn("Log details:",St),Qn(et,$,Se,St,ce,!0).catch(it=>{Sd("Non-critical logging error:",it)})}catch(Fe){Sd("Failed to log activity (non-critical):",Fe)}},100)}catch(te){console.error("Error in handleRatingSubmit:",te),X("❌ Error saving rating: "+te.message),setTimeout(()=>X(""),3e3)}},wi=async()=>{if(!$)return;if(o){X("⚠️ Please save all match results before archiving!"),setTimeout(()=>X(""),3e3);return}const A=We(et,"leagues",$,"sets",C),B=await rt(A);if(B.exists()){const H=B.data(),F=P.map((ie,le)=>p[le]&&p[le].a&&p[le].b?{teamA:ie[0].map(ue=>({name:ue.name||"",active:ue.active!==void 0?ue.active:!0,scoring:ue.scoring||0,defense:ue.defense||0,rebounding:ue.rebounding||0,playmaking:ue.playmaking||0,stamina:ue.stamina||0,physicality:ue.physicality||0,xfactor:ue.xfactor||0})),teamB:ie[1]?ie[1].map(ue=>({name:ue.name||"",active:ue.active!==void 0?ue.active:!0,scoring:ue.scoring||0,defense:ue.defense||0,rebounding:ue.rebounding||0,playmaking:ue.playmaking||0,stamina:ue.stamina||0,physicality:ue.physicality||0,xfactor:ue.xfactor||0})):[],score:p[le],mvp:V[le]||"",date:new Date().toISOString(),teamSize:k}:null).filter(ie=>ie!==null),se=[...H.matchHistory||[],...F];await tt(A,{...H,matchHistory:se,matchups:[],scores:[],mvpVotes:[],teams:[]});for(const ie of F)await Qn(et,$,"match_completed",{teamA:ie.teamA.map(le=>le.name),teamB:ie.teamB.map(le=>le.name),scoreA:ie.score.a,scoreB:ie.score.b,mvp:ie.mvp||"",teamSize:ie.teamSize||k,date:ie.date},ce,!1);ge(se),L([]),w([]),T([]),b([]),l(!1),ve(!1),X("🏆 Matches have been archived successfully!"),setTimeout(()=>X(""),3e3)}},qn=async()=>{if($){if(confirm("Are you sure you want to reset the leaderboard? All match history will be lost.")){const A=We(et,"leagues",$,"sets",C),B=await rt(A);if(B.exists()){const F={...B.data(),mvpVotes:[],scores:[],matchups:[],teams:[],leaderboard:{},matchHistory:[]};await tt(A,F),T([]),w([]),L([]),b([]),S({}),alert("Leaderboard and match data have been reset.")}}await Qn(et,$,"leaderboard_reset",{},ce,!1)}},Vu=(A,B=!0)=>{A&&B&&(A.originalName=A.name),j(A),Ne(B),N(!0)},il=()=>{N(!1),j(null)},Jr=J&&(J.createdBy===(ce==null?void 0:ce.uid)||J.admins&&J.admins.includes(ce==null?void 0:ce.uid));U.useEffect(()=>{if(!$)return;(async()=>{const B=We(et,"leagues",$,"sets",C),H=await rt(B);if(H.exists()){const F=H.data();if(F.beltVotes){O(F.beltVotes);const te=k0(F.beltVotes);Q(te)}}if(H.exists()){const F=H.data();if(F.matchHistory&&F.matchHistory.length>0){Sn("Loaded match history:",F.matchHistory.length);const te=F.matchHistory.map(se=>se.teams?se:se.teamA||se.teamB?{teams:[se.teamA||[],se.teamB||[]],score:se.score,mvp:se.mvp||"",date:se.date}:se);ge(te)}}})()},[$,C]),U.useEffect(()=>{const A=localStorage.getItem("lastUsedLeagueId");A&&!$&&Y(A)},[]),U.useEffect(()=>{const A=document.createElement("style");return A.innerHTML=qk,document.head.appendChild(A),()=>{document.head.removeChild(A)}},[]),U.useEffect(()=>{if(!$)return;(async()=>{const B=We(et,"leagues",$,"sets",C),H=await rt(B);if(H.exists()){const F=H.data();F.matchHistory&&(Sn("Loaded match history:",F.matchHistory.length),ge(F.matchHistory))}})()},[$,C]),U.useEffect(()=>{if(!$)return;const A=async()=>{const B=We(et,"leagues",$,"sets",C),H=await rt(B);if(H.exists()){const F=H.data(),te=jn({...F,mvpVotes:V,scores:p,matchups:P,teams:v});await tt(B,te)}};P.length>0&&p.length>0&&A()},[$,p,V,P]),U.useEffect(()=>{const A=wA(Hh,B=>{Be(B)});return()=>A()},[]),U.useEffect(()=>{if(!$)return;(async()=>{try{const B=We(et,"leagues",$),H=await rt(B);H.exists()&&(oe({id:$,...H.data()}),await Bk(et,$))}catch(B){console.error("Error fetching league details:",B)}})()},[$]),U.useEffect(()=>{if(!Ke&&!u)if(P.length>0){const A=p.some(B=>!B.processed&&(!B.a||!B.b||B.a===""||B.b===""));l(A)}else l(!1)},[P,p,u,Ke]);const Ir=A=>{if(Ke){e(A),_t(!1);return}A==="rankings"&&ke("rankings"),e(A)},Ao=async()=>{if(u==="generate-teams")g(!1),d(null),l(!1),await Hn();else if(u){const A=u;g(!1),d(null),l(!1),_t(!0),setTimeout(()=>{Ir(A)},0)}else g(!1)};U.useEffect(()=>{if(!$)return;(async()=>{var F,te;const B=We(et,"leagues",$,"sets",C),H=await rt(B);if(H.exists()){const se=Vn(H.data());Sn("Raw leaderboard data from Firestore:",se.leaderboard);const ie=(se.players||[]).map(le=>{const ue=le.submissions||[],ye={name:le.name,active:le.active!==void 0?le.active:!0,scoring:0,defense:0,rebounding:0,playmaking:0,stamina:0,physicality:0,xfactor:0};ue.forEach(Se=>{ye.scoring+=Se.scoring,ye.defense+=Se.defense,ye.rebounding+=Se.rebounding,ye.playmaking+=Se.playmaking,ye.stamina+=Se.stamina,ye.physicality+=Se.physicality,ye.xfactor+=Se.xfactor});const Ae=ue.length||1;return Object.keys(ye).forEach(Se=>{typeof ye[Se]=="number"&&(ye[Se]=parseFloat((ye[Se]/Ae).toFixed(2)))}),ye.submissions=ue,ye});r(ie),T(se.mvpVotes||[]),w(se.scores||[]),se.leaderboard&&Object.keys(se.leaderboard).length>0?(Sn("Setting leaderboard with data:",se.leaderboard),S(se.leaderboard)):(((F=se.scores)==null?void 0:F.length)||0)>0&&(((te=se.matchups)==null?void 0:te.length)||0)>0&&setTimeout(()=>Yr(),100)}})()},[$,C]),U.useEffect(()=>{if(v&&v.length>0){const A=v.map((B,H)=>{const F=Us(B);return{teamIndex:H,strength:F,players:B}});ne(A.sort((B,H)=>H.strength-B.strength))}},[v]);const Ei=async A=>{if(!$)return;const B=We(et,"leagues",$,"sets",C),H=await rt(B);if(H.exists()){const F=H.data();await tt(B,{...F,leaderboard:A}),S(A),X("✅ Player stats updated!"),setTimeout(()=>X(""),3e3)}},ar=async(A,B="")=>{if(!ce){X("⚠️ Please sign in to submit a rating."),setTimeout(()=>X(""),3e3);return}if(!$){X("⚠️ No league selected."),setTimeout(()=>X(""),3e3);return}const H=We(et,"leagues",$,"sets",C),F=await rt(H),te=F.exists()?F.data():{players:[]},se=[...te.players],ie=B||A.name,le=se.findIndex(ye=>ye.name.toLowerCase()===ie.toLowerCase()),ue=le===-1;if(le>-1){const ye=se[le].submissions||[];se[le]={name:A.name,active:A.active!==void 0?A.active:!0,scoring:A.scoring,defense:A.defense,rebounding:A.rebounding,playmaking:A.playmaking,stamina:A.stamina,physicality:A.physicality,xfactor:A.xfactor,submissions:ye,rating:(A.scoring+A.defense+A.rebounding+A.playmaking+A.stamina+A.physicality+A.xfactor)/7};let Ae={...te.leaderboard};B&&B!==A.name&&Ae[B]&&(Ae[A.name]={...Ae[B]},delete Ae[B]),await tt(H,{...te,players:se,leaderboard:Ae}),r(se),S(Ae),await Qn(et,$,"player_updated",{playerName:A.name,originalName:B||A.name,playerData:{scoring:A.scoring,defense:A.defense,rebounding:A.rebounding,playmaking:A.playmaking,stamina:A.stamina,physicality:A.physicality,xfactor:A.xfactor}},ce,!0)}else{const ye={name:A.name,active:!0,submissions:[{submittedBy:ce.email,...A}],rating:(A.scoring+A.defense+A.rebounding+A.playmaking+A.stamina+A.physicality+A.xfactor)/7,scoring:A.scoring,defense:A.defense,rebounding:A.rebounding,playmaking:A.playmaking,stamina:A.stamina,physicality:A.physicality,xfactor:A.xfactor};se.push(ye),await tt(H,{...te,players:se}),r(se),await Qn(et,$,"player_added",{playerName:A.name,name:A.name,playerData:{scoring:A.scoring,defense:A.defense,rebounding:A.rebounding,playmaking:A.playmaking,stamina:A.stamina,physicality:A.physicality,xfactor:A.xfactor}},ce,!0)}X(ue?"✅ Player added!":"✅ Player updated!"),setTimeout(()=>X(""),3e3),il()},ol=A=>{Y(A),e("players")},al=()=>{localStorage.removeItem("lastUsedLeagueId"),Y(null),oe(null)},ko=async A=>{if(!$)return;if(A===void 0||!p[A]||!p[A].a||!p[A].b){X("⚠️ Please enter scores for both teams!"),setTimeout(()=>X(""),3e3);return}if(p[A].processed){X("⚠️ This match has already been saved!"),setTimeout(()=>X(""),3e3);return}const B=We(et,"leagues",$,"sets",C),H=await rt(B);if(H.exists()){const F=H.data(),te=[...p];te[A]={...te[A],processed:!0,teamSize:k},w(te),te.every(Ae=>!Ae.a||!Ae.b||Ae.processed)&&l(!1);const ie=jn({...F,mvpVotes:V,scores:te});await tt(B,ie),await Ln(A);const le=JSON.stringify(P[A].map(Ae=>Ae.map(Se=>Se.name).sort()));P.map((Ae,Se)=>({index:Se,teams:JSON.stringify(Ae.map(we=>we.map(xt=>xt.name).sort()))})).filter(Ae=>Ae.teams===le).every(Ae=>{var Se;return(Se=te[Ae.index])==null?void 0:Se.processed})&&D(!0),await Qn(et,$,"match_result_saved",{matchIndex:A,scoreA:p[A].a,scoreB:p[A].b,mvp:V[A]||"",teamSize:k,teamA:P[A][0].map(Ae=>Ae.name),teamB:P[A][1].map(Ae=>Ae.name),teamsFlat:{team0:P[A][0].map(Ae=>Ae.name),team1:P[A][1].map(Ae=>Ae.name)},date:new Date().toISOString()},ce,!0),X("✅ Match result saved!"),setTimeout(()=>X(""),3e3)}};if(U.useEffect(()=>{},[_]),!$)return c.jsxs("div",{className:"bg-gray-900 min-h-screen",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-900 border-b border-gray-800",children:[c.jsx("h1",{className:"text-2xl font-bold text-white",children:"WEEKEND BALL"}),ce?c.jsx(K0,{user:ce}):c.jsx(un,{onClick:Ge,className:"bg-blue-600",children:"Sign in with Google"})]}),c.jsx("div",{className:"p-6",children:c.jsx(Mk,{user:ce,onSelectLeague:ol})})]});const Po=async(A,B)=>{if(!ce||!$){X("You must be signed in to vote for belts"),setTimeout(()=>X(""),3e3);return}try{const H=We(et,"leagues",$,"sets",C),F=await rt(H);if(F.exists()){const te=F.data(),se=te.beltVotes||{},ie={...se,[ce.uid]:{...se[ce.uid]||{},[A]:B}},le=k0(ie,G);await tt(H,{...te,beltVotes:ie,beltHolders:le}),O(ie),Q(le),X(`Vote for ${jr[A].name} recorded!`),setTimeout(()=>X(""),3e3)}}catch(H){console.error("Error saving belt vote:",H),X("Error saving vote"),setTimeout(()=>X(""),3e3)}},Ro=A=>{an(A),Ce(!0)};return c.jsx(tw,{className:"pt-1",children:c.jsxs("div",{className:"mb-2",children:[c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"flex items-center justify-between py-1.5 mb-2 border-b border-gray-800",children:[c.jsx("div",{className:"flex items-center",children:c.jsxs("div",{className:"relative group",children:[c.jsx("span",{className:"text-lg font-semibold text-white bg-gradient-to-r from-blue-500 to-indigo-600 bg-clip-text text-transparent",children:J==null?void 0:J.name}),c.jsx("div",{className:"absolute -bottom-0.5 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-500 to-indigo-600 transition-all duration-300 group-hover:w-full"})]})}),c.jsx(K0,{user:ce,currentLeague:J,handleBackToLeagues:al})]}),Ue&&c.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:c.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-80 text-center",children:[c.jsx("h3",{className:"text-white text-lg mb-4",children:"Play Rematch?"}),c.jsx("p",{className:"text-gray-300 mb-6",children:"Would you like to play again with the same teams?"}),c.jsxs("div",{className:"flex justify-center space-x-4",children:[c.jsx("button",{onClick:Mn,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"No, New Teams"}),c.jsx("button",{onClick:Xr,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Yes, Rematch"})]})]})}),c.jsx(Lk,{isOpen:m,onClose:Qr,onConfirm:Ao,title:"Unsaved Match Results",message:"You have unsaved match results. Leaving this screen will discard your current matchups. Do you want to continue?",confirmText:"Leave Anyway",cancelText:"Stay Here",isDestructive:!0}),q&&c.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[9999] pointer-events-none",children:c.jsx("div",{className:"bg-gray-800 text-white px-6 py-3 rounded shadow-lg pointer-events-auto",children:q})})]}),c.jsxs("div",{className:"pb-20",children:[t==="players"&&c.jsx("div",{className:"mb-6",children:c.jsx(Fk,{children:c.jsx(AC,{players:n,teams:v,setTeams:b,matchups:P,setMatchups:L,mvpVotes:V,setMvpVotes:T,scores:p,setScores:w,teamSize:k,setTeamSize:E,generateBalancedTeams:Bs,handlePlayerActiveToggle:Pt,handleBatchPlayerActiveToggle:Dn,weightings:K,saveMatchResults:ko,archiveCompletedMatches:wi,hasGeneratedTeams:xe,setHasGeneratedTeams:ve,isRematch:mn,getPreviousResults:_i,hasPendingMatchups:o,playerOVRs:yt,calculatePlayerScore:Kr,currentBelts:G,leaderboard:_,matchHistory:de,onPlayerClick:Ro})})}),t==="rankings"&&c.jsx("div",{className:"space-y-4",children:he==="rankings"&&c.jsx(CC,{players:n,newRating:s,setNewRating:i,handleRatingSubmit:xi,handleDeletePlayer:Er,openEditModal:Vu,isAdmin:Jr,user:ce,toastMessage:q,setToastMessage:X,currentBelts:G,leaderboard:_,matchHistory:de,onPlayerClick:Ro})}),t==="leaderboard"&&c.jsx(kC,{leaderboard:_,resetLeaderboardData:qn,isAdmin:Jr,matchHistory:de,players:n,playerOVRs:yt,onUpdateLeaderboard:Ei}),t==="awards"&&c.jsx(Wk,{players:n,leaderboard:_,matchHistory:de,currentBelts:G,userVotes:ce?nt[ce.uid]||{}:{},onVote:Po,user:ce,beltVotes:nt}),t==="logs"&&c.jsx(Uk,{currentLeagueId:$,currentSet:C,isAdmin:Jr,db:et,user:ce,updatePlayers:r,setToastMessage:X,updateMatchHistory:ge})]}),y&&c.jsx(PC,{player:R,onSave:ar,onClose:il}),De&&c.jsx(Ok,{isOpen:De,onClose:In,matchResults:bt,teams:v}),Ve&&c.jsx(Hk,{isOpen:Ve,onClose:()=>Ce(!1),player:Qe,leaderboard:_,matchHistory:de,playerOVRs:yt}),c.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-900 border-t border-gray-800 z-10",children:c.jsxs("div",{className:"flex justify-between items-center px-4 py-3",children:[c.jsxs("div",{className:"flex flex-col items-center cursor-pointer",onClick:()=>Ir("players"),children:[c.jsx("div",{className:`text-${t==="players"?"blue-400":"gray-400"}`,children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M3 6.5V19c0 1 1 2 2 2h14c1 0 2-1 2-2V6.5"}),c.jsx("path",{d:"m7.9 4.8 2.5-1.6a4 4 0 0 1 3.2 0l2.5 1.6"}),c.jsx("path",{d:"m4.5 10.6 4.8-3"}),c.jsx("path",{d:"m14.7 7.6 4.8 3"}),c.jsx("path",{d:"M12 22v-8"}),c.jsx("path",{d:"M12 14c-1.1 0-2-.9-2-2v-1h4v1c0 1.1-.9 2-2 2z"})]})}),c.jsx("span",{className:`text-xs mt-1 text-${t==="players"?"blue-400":"gray-400"}`,children:"Teams"}),o&&c.jsx("span",{className:"absolute top-2 right-12 h-2 w-2 rounded-full bg-red-500"})]}),c.jsxs("div",{className:"flex flex-col items-center cursor-pointer",onClick:()=>Ir("rankings"),children:[c.jsx("div",{className:`text-${t==="rankings"?"blue-400":"gray-400"}`,children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),c.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),c.jsx("span",{className:`text-xs mt-1 text-${t==="rankings"?"blue-400":"gray-400"}`,children:"Players"})]}),c.jsxs("div",{className:"flex flex-col items-center cursor-pointer",onClick:()=>Ir("leaderboard"),children:[c.jsx("div",{className:`text-${t==="leaderboard"?"blue-400":"gray-400"}`,children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),c.jsx("polyline",{points:"14 2 14 8 20 8"}),c.jsx("path",{d:"M12 18v-6"}),c.jsx("path",{d:"M8 18v-1"}),c.jsx("path",{d:"M16 18v-3"})]})}),c.jsx("span",{className:`text-xs mt-1 text-${t==="leaderboard"?"blue-400":"gray-400"}`,children:"Stats"})]}),c.jsxs("div",{className:"flex flex-col items-center cursor-pointer",onClick:()=>Ir("awards"),children:[c.jsx("div",{className:`text-${t==="awards"?"blue-400":"gray-400"}`,children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-6",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172M9.497 14.25a7.454 7.454 0 0 0 .981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 0 0 7.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 0 0 2.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 0 1 2.916.52 6.003 6.003 0 0 1-5.395 4.972m0 0a6.726 6.726 0 0 1-2.749 1.35m0 0a6.772 6.772 0 0 1-3.044 0"})})}),c.jsx("span",{className:`text-xs mt-1 text-${t==="awards"?"blue-400":"gray-400"}`,children:"Awards"})]}),c.jsxs("div",{className:"flex flex-col items-center cursor-pointer",onClick:()=>Ir("logs"),children:[c.jsx("div",{className:`text-${t==="logs"?"blue-400":"gray-400"}`,children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),c.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),c.jsx("path",{d:"M9 12h6"}),c.jsx("path",{d:"M9 16h6"}),c.jsx("path",{d:"M9 8h6"})]})}),c.jsx("span",{className:`text-xs mt-1 text-${t==="logs"?"blue-400":"gray-400"}`,children:"Logs"})]})]})})]})})}Nd.createRoot(document.getElementById("root")).render(c.jsx(to.StrictMode,{children:c.jsx(Gk,{})}));
